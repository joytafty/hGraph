/*! 
 * HGraph.js (Canvas Version)
 * Author:
 *     Danny Hadley <danny@goinvo.com>
 * License:
 *     Copyright 2013, Involution Studios <http://goinvo.com>
 *
 *     Licensed under the Apache License, Version 2.0 (the "License");
 *	   you may not use this file except in compliance with the License.
 * 	   You may obtain a copy of the License at
 *      
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *     Unless required by applicable law or agreed to in writing, software
 *     distributed under the License is distributed on an "AS IS" BASIS,
 *     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *     See the License for the specific language governing permissions and
 *     limitations under the License.
*/
(function(v){var bE={},aH=aH||{REVISION:"58"},bJ={},bU=false,n={},t=[];bJ.scale={};function ac(cr){var cs=cr[0],e=cr[cr.length-1];return cs<e?[cs,e]:[e,cs]}function bI(e){return e.rangeExtent?e.rangeExtent():ac(e.range())}bJ.range=function(cw,cu,cv){if(arguments.length<3){cv=1;if(arguments.length<2){cu=cw;cw=0}}if((cu-cw)/cv===Infinity){throw new Error("infinite range")}var cr=[],e=bB(Math.abs(cv)),ct=-1,cs;cw*=e,cu*=e,cv*=e;if(cv<0){while((cs=cw+cv*++ct)>cu){cr.push(cs/e)}}else{while((cs=cw+cv*++ct)<cu){cr.push(cs/e)}}return cr};function bB(e){var cr=1;while(e*cr%1){cr*=10}return cr}bJ.rebind=function(cs,cr){var e=1,cu=arguments.length,ct;while(++e<cu){cs[ct=arguments[e]]=X(cs,cr,cr[ct])}return cs};function X(cr,e,cs){return function(){var ct=cs.apply(e,arguments);return ct===e?cr:ct}}function ar(){}ar.prototype.toString=function(){return this.rgb()+""};function b8(ct,cs){try{for(var cr in cs){Object.defineProperty(ct.prototype,cr,{value:cs[cr],enumerable:false})}}catch(cu){ct.prototype=cs}}bJ.map=function(e){var cs=new bg;for(var cr in e){cs.set(cr,e[cr])}return cs};function bg(){}b8(bg,{has:function(e){return b3+e in this},get:function(e){return this[b3+e]},set:function(e,cr){return this[b3+e]=cr},remove:function(e){e=b3+e;return e in this&&delete this[e]},keys:function(){var e=[];this.forEach(function(cr){e.push(cr)});return e},values:function(){var e=[];this.forEach(function(cr,cs){e.push(cs)});return e},entries:function(){var e=[];this.forEach(function(cr,cs){e.push({key:cr,value:cs})});return e},forEach:function(cr){for(var e in this){if(e.charCodeAt(0)===av){cr.call(this,e.substring(1),this[e])}}}});var b3="\0",av=b3.charCodeAt(0);bJ.hsl=function(cs,cr,e){return arguments.length===1?(cs instanceof bv?aL(cs.h,cs.s,cs.l):ae(""+cs,a3,aL)):aL(+cs,+cr,+e)};function aL(cs,cr,e){return new bv(cs,cr,e)}function bv(cs,cr,e){this.h=cs;this.s=cr;this.l=e}var cl=bv.prototype=new ar;cl.brighter=function(e){e=Math.pow(0.7,arguments.length?e:1);return aL(this.h,this.s,this.l/e)};cl.darker=function(e){e=Math.pow(0.7,arguments.length?e:1);return aL(this.h,this.s,e*this.l)};cl.rgb=function(){return b7(this.h,this.s,this.l)};function b7(cv,cu,e){var ct,cs;cv=isNaN(cv)?0:(cv%=360)<0?cv+360:cv;cu=isNaN(cu)?0:cu<0?0:cu>1?1:cu;e=e<0?0:e>1?1:e;cs=e<=0.5?e*(1+cu):e+cu-e*cu;ct=2*e-cs;function cr(cx){if(cx>360){cx-=360}else{if(cx<0){cx+=360}}if(cx<60){return ct+(cs-ct)*cx/60}if(cx<180){return cs}if(cx<240){return ct+(cs-ct)*(240-cx)/60}return ct}function cw(cx){return Math.round(cr(cx)*255)}return aw(cw(cv+120),cw(cv),cw(cv-120))}var a0=Math.PI,a7=0.000001,j=a7*a7,a4=a0/180,bq=180/a0;function bQ(e){return e>0?1:e<0?-1:0}function aI(e){return e>1?0:e<-1?a0:Math.acos(e)}function bF(e){return e>1?a0/2:e<-1?-a0/2:Math.asin(e)}function aC(e){return(Math.exp(e)-Math.exp(-e))/2}function aQ(e){return(Math.exp(e)+Math.exp(-e))/2}function E(e){return(e=Math.sin(e/2))*e}bJ.hcl=function(cr,cs,e){return arguments.length===1?(cr instanceof d?bw(cr.h,cr.c,cr.l):(cr instanceof G?aO(cr.l,cr.a,cr.b):aO((cr=cf((cr=bJ.rgb(cr)).r,cr.g,cr.b)).l,cr.a,cr.b))):bw(+cr,+cs,+e)};function bw(cr,cs,e){return new d(cr,cs,e)}function d(cr,cs,e){this.h=cr;this.c=cs;this.l=e}var bH=d.prototype=new ar;bH.brighter=function(e){return bw(this.h,this.c,Math.min(100,this.l+O*(arguments.length?e:1)))};bH.darker=function(e){return bw(this.h,this.c,Math.max(0,this.l-O*(arguments.length?e:1)))};bH.rgb=function(){return at(this.h,this.c,this.l).rgb()};function at(cr,cs,e){if(isNaN(cr)){cr=0}if(isNaN(cs)){cs=0}return b1(e,Math.cos(cr*=a4)*cs,Math.sin(cr)*cs)}bJ.lab=function(cs,cr,e){return arguments.length===1?(cs instanceof G?b1(cs.l,cs.a,cs.b):(cs instanceof d?at(cs.l,cs.c,cs.h):cf((cs=bJ.rgb(cs)).r,cs.g,cs.b))):b1(+cs,+cr,+e)};function b1(cs,cr,e){return new G(cs,cr,e)}function G(cs,cr,e){this.l=cs;this.a=cr;this.b=e}var O=18;var K=0.95047,J=1,I=1.08883;var M=G.prototype=new ar;M.brighter=function(e){return b1(Math.min(100,this.l+O*(arguments.length?e:1)),this.a,this.b)};M.darker=function(e){return b1(Math.max(0,this.l-O*(arguments.length?e:1)),this.a,this.b)};M.rgb=function(){return i(this.l,this.a,this.b)};function i(ct,cs,cr){var cv=(ct+16)/116,e=cv+cs/500,cu=cv-cr/200;e=aW(e)*K;cv=aW(cv)*J;cu=aW(cu)*I;return aw(z(3.2404542*e-1.5371385*cv-0.4985314*cu),z(-0.969266*e+1.8760108*cv+0.041556*cu),z(0.0556434*e-0.2040259*cv+1.0572252*cu))}function aO(cs,cr,e){return cs>0?bw(Math.atan2(e,cr)*bq,Math.sqrt(cr*cr+e*e),cs):bw(NaN,NaN,cs)}function aW(e){return e>0.206893034?e*e*e:(e-4/29)/7.787037}function bm(e){return e>0.008856?Math.pow(e,1/3):7.787037*e+4/29}function z(e){return Math.round(255*(e<=0.00304?12.92*e:1.055*Math.pow(e,1/2.4)-0.055))}bJ.rgb=function(cs,cr,e){return arguments.length===1?(cs instanceof bh?aw(cs.r,cs.g,cs.b):ae(""+cs,aw,b7)):aw(~~cs,~~cr,~~e)};function aw(cs,cr,e){return new bh(cs,cr,e)}function bh(cs,cr,e){this.r=cs;this.g=cr;this.b=e}var o=bh.prototype=new ar;o.brighter=function(cr){cr=Math.pow(0.7,arguments.length?cr:1);var cu=this.r,ct=this.g,e=this.b,cs=30;if(!cu&&!ct&&!e){return aw(cs,cs,cs)}if(cu&&cu<cs){cu=cs}if(ct&&ct<cs){ct=cs}if(e&&e<cs){e=cs}return aw(Math.min(255,Math.floor(cu/cr)),Math.min(255,Math.floor(ct/cr)),Math.min(255,Math.floor(e/cr)))};o.darker=function(e){e=Math.pow(0.7,arguments.length?e:1);return aw(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))};o.hsl=function(){return a3(this.r,this.g,this.b)};o.toString=function(){return"#"+bf(this.r)+bf(this.g)+bf(this.b)};function bf(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function ae(cv,ct,cw){var e=0,cs=0,cu=0,cy,cx,cr;cy=/([a-z]+)\((.*)\)/i.exec(cv);if(cy){cx=cy[2].split(",");switch(cy[1]){case"hsl":return cw(parseFloat(cx[0]),parseFloat(cx[1])/100,parseFloat(cx[2])/100);case"rgb":return ct(aA(cx[0]),aA(cx[1]),aA(cx[2]))}}if(cr=aT.get(cv)){return ct(cr.r,cr.g,cr.b)}if(cv!=null&&cv.charAt(0)==="#"){if(cv.length===4){e=cv.charAt(1);e+=e;cs=cv.charAt(2);cs+=cs;cu=cv.charAt(3);cu+=cu}else{if(cv.length===7){e=cv.substring(1,3);cs=cv.substring(3,5);cu=cv.substring(5,7)}}e=parseInt(e,16);cs=parseInt(cs,16);cu=parseInt(cu,16)}return ct(e,cs,cu)}function a3(e,cu,cw){var cs=Math.min(e/=255,cu/=255,cw/=255),cx=Math.max(e,cu,cw),cv=cx-cs,ct,cy,cr=(cx+cs)/2;if(cv){cy=cr<0.5?cv/(cx+cs):cv/(2-cx-cs);if(e==cx){ct=(cu-cw)/cv+(cu<cw?6:0)}else{if(cu==cx){ct=(cw-e)/cv+2}else{ct=(e-cu)/cv+4}}ct*=60}else{ct=NaN;cy=cr>0&&cr<1?0:ct}return aL(ct,cy,cr)}function cf(ct,cs,cr){ct=bX(ct);cs=bX(cs);cr=bX(cr);var e=bm((0.4124564*ct+0.3575761*cs+0.1804375*cr)/K),cv=bm((0.2126729*ct+0.7151522*cs+0.072175*cr)/J),cu=bm((0.0193339*ct+0.119192*cs+0.9503041*cr)/I);return b1(116*cv-16,500*(e-cv),200*(cv-cu))}function bX(e){return(e/=255)<=0.04045?e/12.92:Math.pow((e+0.055)/1.055,2.4)}function aA(cr){var e=parseFloat(cr);return cr.charAt(cr.length-1)==="%"?Math.round(e*2.55):e}var aT=bJ.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});aT.forEach(function(e,cr){aT.set(e,ae(cr,aw,b7))});bJ.interpolateRgb=g;function g(cr,e){cr=bJ.rgb(cr);e=bJ.rgb(e);var ct=cr.r,cs=cr.g,cw=cr.b,cv=e.r-ct,cu=e.g-cs,cx=e.b-cw;return function(cy){return"#"+bf(Math.round(ct+cv*cy))+bf(Math.round(cs+cu*cy))+bf(Math.round(cw+cx*cy))}}var bR=document,co=bR.documentElement,aM=window;var b2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};bJ.ns={prefix:b2,qualify:function(e){var cr=e.indexOf(":"),cs=e;if(cr>=0){cs=e.substring(0,cr);e=e.substring(cr+1)}return b2.hasOwnProperty(cs)?{space:b2[cs],local:e}:e}};bJ.transform=function(e){var cr=bR.createElementNS(bJ.ns.prefix.svg,"g");return(bJ.transform=function(cs){if(cs!=null){cr.setAttribute("transform",cs);var ct=cr.transform.baseVal.consolidate()}return new b9(ct?ct.matrix:ce)})(e)};function b9(e){var ct=[e.a,e.b],cr=[e.c,e.d],cv=aK(ct),cs=ab(ct,cr),cu=aK(bl(cr,ct,-cs))||0;if(ct[0]*cr[1]<cr[0]*ct[1]){ct[0]*=-1;ct[1]*=-1;cv*=-1;cs*=-1}this.rotate=(cv?Math.atan2(ct[1],ct[0]):Math.atan2(-cr[0],cr[1]))*bq;this.translate=[e.e,e.f];this.scale=[cv,cu];this.skew=cu?Math.atan2(cs,cu)*bq:0}b9.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function ab(cr,e){return cr[0]*e[0]+cr[1]*e[1]}function aK(e){var cr=Math.sqrt(ab(e,e));if(cr){e[0]/=cr;e[1]/=cr}return cr}function bl(cr,e,cs){cr[0]+=cs*e[0];cr[1]+=cs*e[1];return cr}var ce={a:1,b:0,c:0,d:1,e:0,f:0};bJ.interpolateNumber=ax;function ax(cr,e){e-=cr=+cr;return function(cs){return cr+e*cs}}bJ.interpolateTransform=au;function au(cD,cC){var cE=[],cr=[],cv,cu=bJ.transform(cD),ct=bJ.transform(cC),cz=cu.translate,cy=ct.translate,cs=cu.rotate,e=ct.rotate,cx=cu.skew,cw=ct.skew,cB=cu.scale,cA=ct.scale;if(cz[0]!=cy[0]||cz[1]!=cy[1]){cE.push("translate(",null,",",null,")");cr.push({i:1,x:ax(cz[0],cy[0])},{i:3,x:ax(cz[1],cy[1])})}else{if(cy[0]||cy[1]){cE.push("translate("+cy+")")}else{cE.push("")}}if(cs!=e){if(cs-e>180){e+=360}else{if(e-cs>180){cs+=360}}cr.push({i:cE.push(cE.pop()+"rotate(",null,")")-2,x:ax(cs,e)})}else{if(e){cE.push(cE.pop()+"rotate("+e+")")}}if(cx!=cw){cr.push({i:cE.push(cE.pop()+"skewX(",null,")")-2,x:ax(cx,cw)})}else{if(cw){cE.push(cE.pop()+"skewX("+cw+")")}}if(cB[0]!=cA[0]||cB[1]!=cA[1]){cv=cE.push(cE.pop()+"scale(",null,",",null,")");cr.push({i:cv-4,x:ax(cB[0],cA[0])},{i:cv-2,x:ax(cB[1],cA[1])})}else{if(cA[0]!=1||cA[1]!=1){cE.push(cE.pop()+"scale("+cA+")")}}cv=cr.length;return function(cG){var cF=-1,cH;while(++cF<cv){cE[(cH=cr[cF]).i]=cH.x(cG)}return cE.join("")}}bJ.interpolateObject=ca;function ca(cr,e){var ct={},cu={},cs;for(cs in cr){if(cs in e){ct[cs]=ai(cs)(cr[cs],e[cs])}else{cu[cs]=cr[cs]}}for(cs in e){if(!(cs in cr)){cu[cs]=e[cs]}}return function(cv){for(cs in ct){cu[cs]=ct[cs](cv)}return cu}}bJ.interpolateArray=aN;function aN(cu,cs){var cr=[],cx=[],ct=cu.length,e=cs.length,cw=Math.min(cu.length,cs.length),cv;for(cv=0;cv<cw;++cv){cr.push(bM(cu[cv],cs[cv]))}for(;cv<ct;++cv){cx[cv]=cu[cv]}for(;cv<e;++cv){cx[cv]=cs[cv]}return function(cy){for(cv=0;cv<cw;++cv){cx[cv]=cr[cv](cy)}return cx}}bJ.interpolateString=by;function by(cx,cw){var ct,cv,cu,cz=0,cy=0,cA=[],e=[],cs,cr;cx=cx+"",cw=cw+"";k.lastIndex=0;for(cv=0;ct=k.exec(cw);++cv){if(ct.index){cA.push(cw.substring(cz,cy=ct.index))}e.push({i:cA.length,x:ct[0]});cA.push(null);cz=k.lastIndex}if(cz<cw.length){cA.push(cw.substring(cz))}for(cv=0,cs=e.length;(ct=k.exec(cx))&&cv<cs;++cv){cr=e[cv];if(cr.x==ct[0]){if(cr.i){if(cA[cr.i+1]==null){cA[cr.i-1]+=cr.x;cA.splice(cr.i,1);for(cu=cv+1;cu<cs;++cu){e[cu].i--}}else{cA[cr.i-1]+=cr.x+cA[cr.i+1];cA.splice(cr.i,2);for(cu=cv+1;cu<cs;++cu){e[cu].i-=2}}}else{if(cA[cr.i+1]==null){cA[cr.i]=cr.x}else{cA[cr.i]=cr.x+cA[cr.i+1];cA.splice(cr.i+1,1);for(cu=cv+1;cu<cs;++cu){e[cu].i--}}}e.splice(cv,1);cs--;cv--}else{cr.x=ax(parseFloat(ct[0]),parseFloat(cr.x))}}while(cv<cs){cr=e.pop();if(cA[cr.i+1]==null){cA[cr.i]=cr.x}else{cA[cr.i]=cr.x+cA[cr.i+1];cA.splice(cr.i+1,1)}cs--}if(cA.length===1){return cA[0]==null?(cr=e[0].x,function(cB){return cr(cB)+""}):function(){return cw}}return function(cB){for(cv=0;cv<cs;++cv){cA[(cr=e[cv]).i]=cr.x(cB)}return cA.join("")}}var k=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;bJ.interpolate=bM;function bM(cr,e){var cs=bJ.interpolators.length,ct;while(--cs>=0&&!(ct=bJ.interpolators[cs](cr,e))){}return ct}function ai(e){return e=="transform"?au:bM}bJ.interpolators=[function(cr,e){var cs=typeof e;return(cs==="string"?(aT.has(e)||/^(#|rgb\(|hsl\()/.test(e)?g:by):e instanceof ar?g:cs==="object"?(Array.isArray(e)?aN:ca):ax)(cr,e)}];bJ.interpolateRound=aU;function aU(cr,e){e-=cr;return function(cs){return Math.round(cr+e*cs)}}function L(cr,e){e=e-(cr=+cr)?1/(e-cr):0;return function(cs){return(cs-cr)*e}}function ag(cr,e){e=e-(cr=+cr)?1/(e-cr):0;return function(cs){return Math.max(0,Math.min(1,(cs-cr)*e))}}function p(e){return e}var bc=".",bD=",",bi=[3,3];var bn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(a6);bJ.formatPrefix=function(cs,e){var cr=0;if(cs){if(cs<0){cs*=-1}if(e){cs=bJ.round(cs,bt(cs,e))}cr=1+Math.floor(1e-12+Math.log(cs)/Math.LN10);cr=Math.max(-24,Math.min(24,Math.floor((cr<=0?cr+1:cr-1)/3)*3))}return bn[8+cr/3]};function a6(cs,cr){var e=Math.pow(10,Math.abs(8-cr)*3);return{scale:cr>8?function(ct){return ct/e}:function(ct){return ct*e},symbol:cs}}bJ.round=function(e,cr){return cr?Math.round(e*(cr=Math.pow(10,cr)))/cr:Math.round(e)};bJ.format=function(cB){var cy=B.exec(cB),cD=cy[1]||" ",cz=cy[2]||">",cs=cy[3]||"",e=cy[4]||"",cu=cy[5],cr=+cy[6],cE=cy[7],cx=cy[8],cA=cy[9],ct=1,cC="",cw=false;if(cx){cx=+cx.substring(1)}if(cu||cD==="0"&&cz==="="){cu=cD="0";cz="=";if(cE){cr-=Math.floor((cr-1)/4)}}switch(cA){case"n":cE=true;cA="g";break;case"%":ct=100;cC="%";cA="f";break;case"p":ct=100;cC="%";cA="r";break;case"b":case"o":case"x":case"X":if(e){e="0"+cA.toLowerCase()}case"c":case"d":cw=true;cx=0;break;case"s":ct=-1;cA="r";break}if(e==="#"){e=""}if(cA=="r"&&!cx){cA="g"}if(cx!=null){if(cA=="g"){cx=Math.max(1,Math.min(21,cx))}else{if(cA=="e"||cA=="f"){cx=Math.max(0,Math.min(20,cx))}}}cA=aJ.get(cA)||bV;var cv=cu&&cE;return function(cI){if(cw&&(cI%1)){return""}var cF=cI<0||cI===0&&1/cI<0?(cI=-cI,"-"):cs;if(ct<0){var cH=bJ.formatPrefix(cI,cx);cI=cH.scale(cI);cC=cH.symbol}else{cI*=ct}cI=cA(cI,cx);if(!cu&&cE){cI=bL(cI)}var cG=e.length+cI.length+(cv?0:cF.length),cJ=cG<cr?new Array(cG=cr-cG+1).join(cD):"";if(cv){cI=bL(cJ+cI)}if(bc){cI.replace(".",bc)}cF+=e;return(cz==="<"?cF+cI+cJ:cz===">"?cJ+cF+cI:cz==="^"?cJ.substring(0,cG>>=1)+cF+cI+cJ.substring(cG):cF+(cv?cI:cJ+cI))+cC}};var B=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var aJ=bJ.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,cr){return e.toPrecision(cr)},e:function(e,cr){return e.toExponential(cr)},f:function(e,cr){return e.toFixed(cr)},r:function(e,cr){return(e=bJ.round(e,bt(e,cr))).toFixed(Math.max(0,Math.min(20,bt(e*(1+1e-15),cr))))}});function bt(e,cr){return cr-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function bV(e){return e+""}var bL=p;if(bi){var F=bi.length;bL=function(cv){var cs=cv.lastIndexOf("."),cu=cs>=0?"."+cv.substring(cs+1):(cs=cv.length,""),cr=[],e=0,ct=bi[0];while(cs>0&&ct>0){cr.push(cv.substring(cs-=ct,cs+ct));ct=bi[e=(e+1)%F]}return cr.reverse().join(bD||"")+cu}}function ci(cu,e,cv,cs){var cr=cv(cu[0],cu[1]),ct=cs(e[0],e[1]);return function(cw){return ct(cr(cw))}}function bP(cw,cu){var cv=0,ct=cw.length-1,cs=cw[cv],cr=cw[ct],e;if(cr<cs){e=cv,cv=ct,ct=e;e=cs,cs=cr,cr=e}cw[cv]=cu.floor(cs);cw[ct]=cu.ceil(cr);return cw}function a9(e){return e?{floor:function(cr){return Math.floor(cr/e)*e},ceil:function(cr){return Math.ceil(cr/e)*e}}:ao}var ao={floor:p,ceil:p};bJ.bisector=function(e){return{left:function(cs,cr,cv,cu){if(arguments.length<3){cv=0}if(arguments.length<4){cu=cs.length}while(cv<cu){var ct=cv+cu>>>1;if(e.call(cs,cs[ct],ct)<cr){cv=ct+1}else{cu=ct}}return cv},right:function(cs,cr,cv,cu){if(arguments.length<3){cv=0}if(arguments.length<4){cu=cs.length}while(cv<cu){var ct=cv+cu>>>1;if(cr<e.call(cs,cs[ct],ct)){cu=ct}else{cv=ct+1}}return cv}}};var u=bJ.bisector(function(e){return e});bJ.bisectLeft=u.left;bJ.bisect=bJ.bisectRight=u.right;function r(cw,cr,cx,cu){var ct=[],cv=[],cs=0,e=Math.min(cw.length,cr.length)-1;if(cw[e]<cw[0]){cw=cw.slice().reverse();cr=cr.slice().reverse()}while(++cs<=e){ct.push(cx(cw[cs-1],cw[cs]));cv.push(cu(cr[cs-1],cr[cs]))}return function(cy){var cz=bJ.bisect(cw,cy,1,e)-1;return cv[cz](ct[cz](cy))}}bJ.scale.linear=function(){return al([0,1],[0,1],bM,false)};function al(cv,ct,cu,cx){var cs,cr;function e(){var cy=Math.min(cv.length,ct.length)>2?r:ci,cz=cx?ag:L;cs=cy(cv,ct,cz,cu);cr=cy(ct,cv,cz,bM);return cw}function cw(cy){return cs(cy)}cw.invert=function(cy){return cr(cy)};cw.domain=function(cy){if(!arguments.length){return cv}cv=cy.map(Number);return e()};cw.range=function(cy){if(!arguments.length){return ct}ct=cy;return e()};cw.rangeRound=function(cy){return cw.range(cy).interpolate(aU)};cw.clamp=function(cy){if(!arguments.length){return cx}cx=cy;return e()};cw.interpolate=function(cy){if(!arguments.length){return cu}cu=cy;return e()};cw.ticks=function(cy){return H(cv,cy)};cw.tickFormat=function(cy,cz){return a(cv,cy,cz)};cw.nice=function(cy){aj(cv,cy);return e()};cw.copy=function(){return al(cv,ct,cu,cx)};return e()}function bN(cr,e){return bJ.rebind(cr,e,"range","rangeRound","interpolate","clamp")}function aj(cr,e){return bP(cr,a9(e?S(cr,e)[2]:bs(cr)))}function bs(cs){var cr=ac(cs),e=cr[1]-cr[0];return Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1)}function S(cv,e){var cs=ac(cv),cr=cs[1]-cs[0],cu=Math.pow(10,Math.floor(Math.log(cr/e)/Math.LN10)),ct=e/cr*cu;if(ct<=0.15){cu*=10}else{if(ct<=0.35){cu*=5}else{if(ct<=0.75){cu*=2}}}cs[0]=Math.ceil(cs[0]/cu)*cu;cs[1]=Math.floor(cs[1]/cu)*cu+cu*0.5;cs[2]=cu;return cs}function H(cr,e){return bJ.range.apply(bJ,S(cr,e))}function a(cs,e,ct){var cr=-Math.floor(Math.log(S(cs,e)[2])/Math.LN10+0.01);return bJ.format(ct?ct.replace(B,function(cD,cC,cB,cA,cz,cy,cx,cw,cv,cu){return[cC,cB,cA,cz,cy,cx,cw,cv||"."+(cr-(cu==="%")*2),cu].join("")}):",."+cr+"f")}bJ.scale.log=function(){return bZ(bJ.scale.linear().domain([0,Math.LN10]),10,cc,a5,[1,10])};function bZ(e,cu,cr,cs,ct){function cv(cw){return e(cr(cw))}cv.invert=function(cw){return cs(e.invert(cw))};cv.domain=function(cw){if(!arguments.length){return ct}if(cw[0]<0){cr=cd,cs=a8}else{cr=cc,cs=a5}e.domain((ct=cw.map(Number)).map(cr));return cv};cv.base=function(cw){if(!arguments.length){return cu}cu=+cw;return cv};cv.nice=function(){function cx(cy){return Math.pow(cu,Math.floor(Math.log(cy)/Math.log(cu)))}function cw(cy){return Math.pow(cu,Math.ceil(Math.log(cy)/Math.log(cu)))}e.domain(bP(ct,cr===cc?{floor:cx,ceil:cw}:{floor:function(cy){return -cw(-cy)},ceil:function(cy){return -cx(-cy)}}).map(cr));return cv};cv.ticks=function(){var cE=ac(e.domain()),cB=[];if(cE.every(isFinite)){var cA=Math.log(cu),cz=Math.floor(cE[0]/cA),cy=Math.ceil(cE[1]/cA),cD=cs(cE[0]),cC=cs(cE[1]),cw=cu%1?2:cu;if(cr===cd){cB.push(-Math.pow(cu,-cz));for(;cz++<cy;){for(var cx=cw-1;cx>0;cx--){cB.push(-Math.pow(cu,-cz)*cx)}}}else{for(;cz<cy;cz++){for(var cx=1;cx<cw;cx++){cB.push(Math.pow(cu,cz)*cx)}}cB.push(Math.pow(cu,cz))}for(cz=0;cB[cz]<cD;cz++){}for(cy=cB.length;cB[cy-1]>cC;cy--){}cB=cB.slice(cz,cy)}return cB};cv.tickFormat=function(cB,cA){if(!arguments.length){return ch}if(arguments.length<2){cA=ch}else{if(typeof cA!=="function"){cA=bJ.format(cA)}}var cw=Math.log(cu),cx=Math.max(0.1,cB/cv.ticks().length),cy=cr===cd?(cz=-1e-12,Math.floor):(cz=1e-12,Math.ceil),cz;return function(cC){return cC/cs(cw*cy(cr(cC)/cw+cz))<=cx?cA(cC):""}};cv.copy=function(){return bZ(e.copy(),cu,cr,cs,ct)};return bN(cv,e)}var ch=bJ.format(".0e");function cc(e){return Math.log(e<0?0:e)}function a5(e){return Math.exp(e)}function cd(e){return -Math.log(e>0?0:-e)}function a8(e){return -Math.exp(-e)}bJ.scale.pow=function(){return bG(bJ.scale.linear(),1,[0,1])};function bG(e,ct,cs){var cr=C(ct),cu=C(1/ct);function cv(cw){return e(cr(cw))}cv.invert=function(cw){return cu(e.invert(cw))};cv.domain=function(cw){if(!arguments.length){return cs}e.domain((cs=cw.map(Number)).map(cr));return cv};cv.ticks=function(cw){return H(cs,cw)};cv.tickFormat=function(cw,cx){return a(cs,cw,cx)};cv.nice=function(cw){return cv.domain(aj(cs,cw))};cv.exponent=function(cw){if(!arguments.length){return ct}cr=C(ct=cw);cu=C(1/ct);e.domain(cs.map(cr));return cv};cv.copy=function(){return bG(e.copy(),ct,cs)};return bN(cv,e)}function C(cr){return function(e){return e<0?-Math.pow(-e,cr):Math.pow(e,cr)}}bJ.scale.sqrt=function(){return bJ.scale.pow().exponent(0.5)};bJ.scale.ordinal=function(){return m([],{t:"range",a:[[]]})};function m(cv,cs){var cu,cr,ct;function cw(cx){return cr[((cu.get(cx)||cu.set(cx,cv.push(cx)))-1)%cr.length]}function e(cy,cx){return bJ.range(cv.length).map(function(cz){return cy+cx*cz})}cw.domain=function(cx){if(!arguments.length){return cv}cv=[];cu=new bg;var cz=-1,cA=cx.length,cy;while(++cz<cA){if(!cu.has(cy=cx[cz])){cu.set(cy,cv.push(cy))}}return cw[cs.t].apply(cw,cs.a)};cw.range=function(cx){if(!arguments.length){return cr}cr=cx;ct=0;cs={t:"range",a:arguments};return cw};cw.rangePoints=function(cx,cA){if(arguments.length<2){cA=0}var cB=cx[0],cy=cx[1],cz=(cy-cB)/(Math.max(1,cv.length-1)+cA);cr=e(cv.length<2?(cB+cy)/2:cB+cz*cA/2,cz);ct=0;cs={t:"rangePoints",a:arguments};return cw};cw.rangeBands=function(cy,cC,cx){if(arguments.length<2){cC=0}if(arguments.length<3){cx=cC}var cz=cy[1]<cy[0],cD=cy[cz-0],cA=cy[1-cz],cB=(cA-cD)/(cv.length-cC+2*cx);cr=e(cD+cB*cx,cB);if(cz){cr.reverse()}ct=cB*(1-cC);cs={t:"rangeBands",a:arguments};return cw};cw.rangeRoundBands=function(cy,cD,cx){if(arguments.length<2){cD=0}if(arguments.length<3){cx=cD}var cA=cy[1]<cy[0],cE=cy[cA-0],cB=cy[1-cA],cC=Math.floor((cB-cE)/(cv.length-cD+2*cx)),cz=cB-cE-(cv.length-cD)*cC;cr=e(cE+Math.round(cz/2),cC);if(cA){cr.reverse()}ct=Math.round(cC*(1-cD));cs={t:"rangeRoundBands",a:arguments};return cw};cw.rangeBand=function(){return ct};cw.rangeExtent=function(){return ac(cs.a[0])};cw.copy=function(){return m(cv,cs)};return cw.domain(cv)}bJ.scale.category10=function(){return bJ.scale.ordinal().range(am)};bJ.scale.category20=function(){return bJ.scale.ordinal().range(U)};bJ.scale.category20b=function(){return bJ.scale.ordinal().range(a1)};bJ.scale.category20c=function(){return bJ.scale.ordinal().range(aZ)};var am=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];var U=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];var a1=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"];var aZ=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];bJ.ascending=function(cr,e){return cr<e?-1:cr>e?1:cr>=e?0:NaN};bJ.quantile=function(cs,cw){var ct=(cs.length-1)*cw+1,cu=Math.floor(ct),cr=+cs[cu-1],cv=ct-cu;return cv?cr+cv*(cs[cu]-cr):cr};bJ.scale.quantile=function(){return aD([],[])};function aD(cs,cr){var ct;function e(){var cv=0,cw=cr.length;ct=[];while(++cv<cw){ct[cv-1]=bJ.quantile(cs,cv/cw)}return cu}function cu(cv){if(isNaN(cv=+cv)){return NaN}return cr[bJ.bisect(ct,cv)]}cu.domain=function(cv){if(!arguments.length){return cs}cs=cv.filter(function(cw){return !isNaN(cw)}).sort(bJ.ascending);return e()};cu.range=function(cv){if(!arguments.length){return cr}cr=cv;return e()};cu.quantiles=function(){return ct};cu.copy=function(){return aD(cs,cr)};return e()}bJ.scale.quantize=function(){return W(0,1,[0,1])};function W(cu,cs,cr){var cv,ct;function cw(cx){return cr[Math.max(0,Math.min(ct,Math.floor(cv*(cx-cu))))]}function e(){cv=cr.length/(cs-cu);ct=cr.length-1;return cw}cw.domain=function(cx){if(!arguments.length){return[cu,cs]}cu=+cx[0];cs=+cx[cx.length-1];return e()};cw.range=function(cx){if(!arguments.length){return cr}cr=cx;return e()};cw.copy=function(){return W(cu,cs,cr)};cw.invertExtent=function(cx){cx=cr.indexOf(cx);cx=cx<0?NaN:cx/cv+cu;return[cx,cx+1/cv]};return e()}bJ.scale.threshold=function(){return q([0.5],[0,1])};function q(cr,e){function cs(ct){return e[bJ.bisect(cr,ct)]}cs.domain=function(ct){if(!arguments.length){return cr}cr=ct;return cs};cs.range=function(ct){if(!arguments.length){return e}e=ct;return cs};cs.invertExtent=function(ct){ct=e.indexOf(ct);return[cr[ct-1],cr[ct]]};cs.copy=function(){return q(cr,e)};return cs}bJ.scale.identity=function(){return bj([0,1])};function bj(cr){function e(cs){return +cs}e.invert=e;e.domain=e.range=function(cs){if(!arguments.length){return cr}cr=cs.map(e);return e};e.ticks=function(cs){return H(cr,cs)};e.tickFormat=function(cs,ct){return a(cr,cs,ct)};e.copy=function(){return bj(cr)};return e}var bd=ap;function cb(cr){var e=-1,ct=cr.length,cs=[];while(++e<ct){cs.push(cr[e])}return cs}function ap(e){return Array.prototype.slice.call(e)}try{bd(co.childNodes)[0].nodeType}catch(bC){bd=cb}var aX=[].__proto__?function(cr,e){cr.__proto__=e}:function(cs,e){for(var cr in e){cs[cr]=e[cr]}};function R(cs,cr){if(cr in cs){return cr}cr=cr.charAt(0).toUpperCase()+cr.substring(1);for(var ct=0,cu=b6.length;ct<cu;++ct){var e=b6[ct]+cr;if(e in cs){return e}}}var b6=["webkit","ms","moz","Moz","o","O"];function f(e){aX(e,an);return e}var bb=function(e,cr){return cr.querySelector(e)},bk=function(e,cr){return cr.querySelectorAll(e)},cm=co[R(co,"matchesSelector")],ck=function(cr,e){return cm.call(cr,e)};if(typeof Sizzle==="function"){bb=function(e,cr){return Sizzle(e,cr)[0]||null};bk=function(e,cr){return Sizzle.uniqueSort(Sizzle(e,cr))};ck=Sizzle.matchesSelector}bJ.selection=function(){return ba};var an=bJ.selection.prototype=[];an.select=function(cv){var cs=[],cz,e,cy,ct;if(typeof cv!=="function"){cv=aF(cv)}for(var cw=-1,cu=this.length;++cw<cu;){cs.push(cz=[]);cz.parentNode=(cy=this[cw]).parentNode;for(var cx=-1,cr=cy.length;++cx<cr;){if(ct=cy[cx]){cz.push(e=cv.call(ct,ct.__data__,cx));if(e&&"__data__" in ct){e.__data__=ct.__data__}}else{cz.push(null)}}}return f(cs)};function aF(e){return function(){return bb(e,this)}}an.selectAll=function(cu){var cr=[],cy,cs;if(typeof cu!=="function"){cu=w(cu)}for(var cv=-1,ct=this.length;++cv<ct;){for(var cx=this[cv],cw=-1,e=cx.length;++cw<e;){if(cs=cx[cw]){cr.push(cy=bd(cu.call(cs,cs.__data__,cw)));cy.parentNode=cs}}}return f(cr)};function w(e){return function(){return bk(e,this)}}an.attr=function(e,cs){if(arguments.length<2){if(typeof e==="string"){var cr=this.node();e=bJ.ns.qualify(e);return e.local?cr.getAttributeNS(e.space,e.local):cr.getAttribute(e)}for(cs in e){this.each(az(cs,e[cs]))}return this}return this.each(az(e,cs))};function az(cs,cw){cs=bJ.ns.qualify(cs);function cr(){this.removeAttribute(cs)}function cx(){this.removeAttributeNS(cs.space,cs.local)}function cv(){this.setAttribute(cs,cw)}function cu(){this.setAttributeNS(cs.space,cs.local,cw)}function e(){var cy=cw.apply(this,arguments);if(cy==null){this.removeAttribute(cs)}else{this.setAttribute(cs,cy)}}function ct(){var cy=cw.apply(this,arguments);if(cy==null){this.removeAttributeNS(cs.space,cs.local)}else{this.setAttributeNS(cs.space,cs.local,cy)}}return cw==null?(cs.local?cx:cr):(typeof cw==="function"?(cs.local?ct:e):(cs.local?cu:cv))}function bS(e){return e.trim().replace(/\s+/g," ")}bJ.requote=function(e){return e.replace(aV,"\\$&")};var aV=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;an.classed=function(e,ct){if(arguments.length<2){if(typeof e==="string"){var cs=this.node(),cu=(e=e.trim().split(/^|\s+/g)).length,cr=-1;if(ct=cs.classList){while(++cr<cu){if(!ct.contains(e[cr])){return false}}}else{ct=cs.getAttribute("class");while(++cr<cu){if(!bK(e[cr]).test(ct)){return false}}}return true}for(ct in e){this.each(aq(ct,e[ct]))}return this}return this.each(aq(e,ct))};function bK(e){return new RegExp("(?:^|\\s+)"+bJ.requote(e)+"(?:\\s+|$)","g")}function aq(cr,ct){cr=cr.trim().split(/\s+/).map(cq);var cu=cr.length;function e(){var cv=-1;while(++cv<cu){cr[cv](this,ct)}}function cs(){var cw=-1,cv=ct.apply(this,arguments);while(++cw<cu){cr[cw](this,cv)}}return typeof ct==="function"?cs:e}function cq(e){var cr=bK(e);return function(cs,ct){if(cu=cs.classList){return ct?cu.add(e):cu.remove(e)}var cu=cs.getAttribute("class")||"";if(ct){cr.lastIndex=0;if(!cr.test(cu)){cs.setAttribute("class",bS(cu+" "+e))}}else{cs.setAttribute("class",bS(cu.replace(cr," ")))}}}an.style=function(e,cs,cr){var ct=arguments.length;if(ct<3){if(typeof e!=="string"){if(ct<2){cs=""}for(cr in e){this.each(cn(cr,e[cr],cs))}return this}if(ct<2){return aM.getComputedStyle(this.node(),null).getPropertyValue(e)}cr=""}return this.each(cn(e,cs,cr))};function cn(cs,cv,ct){function cr(){this.style.removeProperty(cs)}function cu(){this.style.setProperty(cs,cv,ct)}function e(){var cw=cv.apply(this,arguments);if(cw==null){this.style.removeProperty(cs)}else{this.style.setProperty(cs,cw,ct)}}return cv==null?cr:(typeof cv==="function"?e:cu)}an.property=function(e,cr){if(arguments.length<2){if(typeof e==="string"){return this.node()[e]}for(cr in e){this.each(b5(cr,e[cr]))}return this}return this.each(b5(e,cr))};function b5(cr,ct){function e(){delete this[cr]}function cs(){this[cr]=ct}function cu(){var cv=ct.apply(this,arguments);if(cv==null){delete this[cr]}else{this[cr]=cv}}return ct==null?e:(typeof ct==="function"?cu:cs)}an.text=function(e){return arguments.length?this.each(typeof e==="function"?function(){var cr=e.apply(this,arguments);this.textContent=cr==null?"":cr}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};an.html=function(e){return arguments.length?this.each(typeof e==="function"?function(){var cr=e.apply(this,arguments);this.innerHTML=cr==null?"":cr}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};an.append=function(cr){cr=bJ.ns.qualify(cr);function e(){return this.appendChild(bR.createElementNS(this.namespaceURI,cr))}function cs(){return this.appendChild(bR.createElementNS(cr.space,cr.local))}return this.select(cr.local?cs:e)};an.insert=function(e,cs){e=bJ.ns.qualify(e);if(typeof cs!=="function"){cs=aF(cs)}function cr(cv,cu){return this.insertBefore(bR.createElementNS(this.namespaceURI,e),cs.call(this,cv,cu))}function ct(cv,cu){return this.insertBefore(bR.createElementNS(e.space,e.local),cs.call(this,cv,cu))}return this.select(e.local?ct:cr)};an.remove=function(){return this.each(function(){var e=this.parentNode;if(e){e.removeChild(this)}})};an.data=function(cx,cz){var cu=-1,cr=this.length,cy,cs;if(!arguments.length){cx=new Array(cr=(cy=this[0]).length);while(++cu<cr){if(cs=cy[cu]){cx[cu]=cs.__data__}}return cx}function cv(cJ,cE){var cG,cB=cJ.length,cD=cE.length,cI=Math.min(cB,cD),cN=new Array(cD),cK=new Array(cD),cH=new Array(cB),cC,cA;if(cz){var cO=new bg,cL=new bg,cM=[],cF;for(cG=-1;++cG<cB;){cF=cz.call(cC=cJ[cG],cC.__data__,cG);if(cO.has(cF)){cH[cG]=cC}else{cO.set(cF,cC)}cM.push(cF)}for(cG=-1;++cG<cD;){cF=cz.call(cE,cA=cE[cG],cG);if(cC=cO.get(cF)){cN[cG]=cC;cC.__data__=cA}else{if(!cL.has(cF)){cK[cG]=s(cA)}}cL.set(cF,cA);cO.remove(cF)}for(cG=-1;++cG<cB;){if(cO.has(cM[cG])){cH[cG]=cJ[cG]}}}else{for(cG=-1;++cG<cI;){cC=cJ[cG];cA=cE[cG];if(cC){cC.__data__=cA;cN[cG]=cC}else{cK[cG]=s(cA)}}for(;cG<cD;++cG){cK[cG]=s(cE[cG])}for(;cG<cB;++cG){cH[cG]=cJ[cG]}}cK.update=cN;cK.parentNode=cN.parentNode=cH.parentNode=cJ.parentNode;cw.push(cK);ct.push(cN);e.push(cH)}var cw=bu([]),ct=f([]),e=f([]);if(typeof cx==="function"){while(++cu<cr){cv(cy=this[cu],cx.call(cy,cy.parentNode.__data__,cu))}}else{while(++cu<cr){cv(cy=this[cu],cx)}}ct.enter=function(){return cw};ct.exit=function(){return e};return ct};function s(e){return{__data__:e}}an.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};an.filter=function(e){var cs=[],cy,cx,ct;if(typeof e!=="function"){e=bO(e)}for(var cv=0,cu=this.length;cv<cu;cv++){cs.push(cy=[]);cy.parentNode=(cx=this[cv]).parentNode;for(var cw=0,cr=cx.length;cw<cr;cw++){if((ct=cx[cw])&&e.call(ct,ct.__data__,cw)){cy.push(ct)}}}return f(cs)};function bO(e){return function(){return ck(this,e)}}an.order=function(){for(var cr=-1,e=this.length;++cr<e;){for(var cv=this[cr],cs=cv.length-1,ct=cv[cs],cu;--cs>=0;){if(cu=cv[cs]){if(ct&&ct!==cu.nextSibling){ct.parentNode.insertBefore(cu,ct)}ct=cu}}}return this};an.sort=function(cr){cr=h.apply(this,arguments);for(var cs=-1,e=this.length;++cs<e;){this[cs].sort(cr)}return this.order()};function h(e){if(!arguments.length){e=bJ.ascending}return function(cs,cr){return(!cs-!cr)||e(cs.__data__,cr.__data__)}}function A(){}bJ.dispatch=function(){var e=new Q,cr=-1,cs=arguments.length;while(++cr<cs){e[arguments[cr]]=cg(e)}return e};function Q(){}Q.prototype.on=function(cs,ct){var cr=cs.indexOf("."),e="";if(cr>=0){e=cs.substring(cr+1);cs=cs.substring(0,cr)}if(cs){return arguments.length<2?this[cs].on(e):this[cs].on(e,ct)}if(arguments.length===2){if(ct==null){for(cs in this){if(this.hasOwnProperty(cs)){this[cs].on(e,null)}}}return this}};function cg(e){var cs=[],cr=new bg;function ct(){var cw=cs,cv=-1,cx=cw.length,cu;while(++cv<cx){if(cu=cw[cv].on){cu.apply(this,arguments)}}return e}ct.on=function(cv,cx){var cu=cr.get(cv),cw;if(arguments.length<2){return cu&&cu.on}if(cu){cu.on=null;cs=cs.slice(0,cw=cs.indexOf(cu)).concat(cs.slice(cw+1));cr.remove(cv)}if(cx){cs.push(cr.set(cv,{on:cx}))}return e};return ct}bJ.event=null;function b(){bJ.event.stopPropagation();bJ.event.preventDefault()}function ad(){var cs=bJ.event,cr;while(cr=cs.sourceEvent){cs=cr}return cs}function y(cr,e){function cs(){cr.on(e,null)}cr.on(e,function(){b();cs()},true);setTimeout(cs,0)}function bA(cs){var e=new Q,cr=0,ct=arguments.length;while(++cr<ct){e[arguments[cr]]=cg(e)}e.of=function(cv,cu){return function(cw){try{var cx=cw.sourceEvent=bJ.event;cw.target=cs;bJ.event=cw;e[cw.type].apply(cv,cu)}finally{bJ.event=cx}}};return e}an.on=function(cr,cs,e){var ct=arguments.length;if(ct<3){if(typeof cr!=="string"){if(ct<2){cs=false}for(e in cr){this.each(bp(e,cr[e],cs))}return this}if(ct<2){return(ct=this.node()["__on"+cr])&&ct._}e=false}return this.each(bp(cr,cs,e))};function bp(cy,ct,cz){var e="__on"+cy,cv=cy.indexOf("."),cr=be;if(cv>0){cy=cy.substring(0,cv)}var cs=aP.get(cy);if(cs){cy=cs,cr=bW}function cu(){var cA=this[e];if(cA){this.removeEventListener(cy,cA,cA.$);delete this[e]}}function cx(){var cA=cr(ct,bd(arguments));cu.call(this);this.addEventListener(cy,this[e]=cA,cA.$=cz);cA._=ct}function cw(){var cD=new RegExp("^__on([^.]+)"+bJ.requote(cy)+"$"),cC;for(var cB in this){if(cC=cB.match(cD)){var cA=this[cB];this.removeEventListener(cC[1],cA,cA.$);delete this[cB]}}}return cv?ct?cx:cu:ct?A:cw}var aP=bJ.map({mouseenter:"mouseover",mouseleave:"mouseout"});aP.forEach(function(e){if("on"+e in bR){aP.remove(e)}});function be(cr,e){return function(cs){var ct=bJ.event;bJ.event=cs;e[0]=this.__data__;try{cr.apply(this,e)}finally{bJ.event=ct}}}function bW(cs,e){var cr=be(cs,e);return function(cv){var cu=this,ct=cv.relatedTarget;if(!ct||(ct!==cu&&!(ct.compareDocumentPosition(cu)&8))){cr.call(cu,cv)}}}an.each=function(e){return ak(this,function(ct,cs,cr){e.call(ct,ct.__data__,cs,cr)})};function ak(cr,cx){for(var cs=0,e=cr.length;cs<e;cs++){for(var cv=cr[cs],ct=0,cw=cv.length,cu;ct<cw;ct++){if(cu=cv[ct]){cx(cu,ct,cs)}}}return cr}an.call=function(cr){var e=bd(arguments);cr.apply(e[0]=this,e);return this};an.empty=function(){return !this.node()};an.node=function(){for(var cr=0,e=this.length;cr<e;cr++){for(var cu=this[cr],cs=0,cv=cu.length;cs<cv;cs++){var ct=cu[cs];if(ct){return ct}}}return null};an.size=function(){var e=0;this.each(function(){++e});return e};function bu(e){aX(e,bo);return e}var bo=[];bJ.selection.enter=bu;bJ.selection.enter.prototype=bo;bo.append=an.append;bo.insert=an.insert;bo.empty=an.empty;bo.node=an.node;bo.call=an.call;bo.size=an.size;bo.select=function(cv){var cs=[],cA,e,cy,cz,cu;for(var cw=-1,ct=this.length;++cw<ct;){cy=(cz=this[cw]).update;cs.push(cA=[]);cA.parentNode=cz.parentNode;for(var cx=-1,cr=cz.length;++cx<cr;){if(cu=cz[cx]){cA.push(cy[cx]=e=cv.call(cz.parentNode,cu.__data__,cx));e.__data__=cu.__data__}else{cA.push(null)}}}return f(cs)};an.transition=function(){var e=d3_transitionInheritId||++d3_transitionId,cs=[],cz,ct,cx=Object.create(d3_transitionInherit);cx.time=Date.now();for(var cv=-1,cu=this.length;++cv<cu;){cs.push(cz=[]);for(var cy=this[cv],cw=-1,cr=cy.length;++cw<cr;){if(ct=cy[cw]){d3_transitionNode(ct,cw,e,cx)}cz.push(ct)}}return d3_transition(cs,e)};bJ.select=function(e){var cr=[typeof e==="string"?bb(e,bR):e];cr.parentNode=co;return f([cr])};bJ.selectAll=function(e){var cr=bd(typeof e==="string"?bk(e,bR):e);cr.parentNode=co;return f([cr])};var ba=bJ.select(co);var aH=aH||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};aH.extend=function(cv,cu){if(Object.keys){var ct=Object.keys(cu);for(var cs=0,cr=ct.length;cs<cr;cs++){var cw=ct[cs];Object.defineProperty(cv,cw,Object.getOwnPropertyDescriptor(cu,cw))}}else{var e={}.hasOwnProperty;for(var cw in cu){if(e.call(cu,cw)){cv[cw]=cu[cw]}}}return cv};(function(){var cr=0;var cs=["ms","moz","webkit","o"];for(var e=0;e<cs.length&&!window.requestAnimationFrame;++e){window.requestAnimationFrame=window[cs[e]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[cs[e]+"CancelAnimationFrame"]||window[cs[e]+"CancelRequestAnimationFrame"]}if(window.requestAnimationFrame===undefined){window.requestAnimationFrame=function(cw){var ct=Date.now(),cu=Math.max(0,16-(ct-cr));var cv=window.setTimeout(function(){cw(ct+cu)},cu);cr=ct+cu;return cv}}window.cancelAnimationFrame=window.cancelAnimationFrame||function(ct){window.clearTimeout(ct)}}());aH.CullFaceNone=0;aH.CullFaceBack=1;aH.CullFaceFront=2;aH.CullFaceFrontBack=3;aH.FrontFaceDirectionCW=0;aH.FrontFaceDirectionCCW=1;aH.BasicShadowMap=0;aH.PCFShadowMap=1;aH.PCFSoftShadowMap=2;aH.FrontSide=0;aH.BackSide=1;aH.DoubleSide=2;aH.NoShading=0;aH.FlatShading=1;aH.SmoothShading=2;aH.NoColors=0;aH.FaceColors=1;aH.VertexColors=2;aH.NoBlending=0;aH.NormalBlending=1;aH.AdditiveBlending=2;aH.SubtractiveBlending=3;aH.MultiplyBlending=4;aH.CustomBlending=5;aH.AddEquation=100;aH.SubtractEquation=101;aH.ReverseSubtractEquation=102;aH.ZeroFactor=200;aH.OneFactor=201;aH.SrcColorFactor=202;aH.OneMinusSrcColorFactor=203;aH.SrcAlphaFactor=204;aH.OneMinusSrcAlphaFactor=205;aH.DstAlphaFactor=206;aH.OneMinusDstAlphaFactor=207;aH.DstColorFactor=208;aH.OneMinusDstColorFactor=209;aH.SrcAlphaSaturateFactor=210;aH.MultiplyOperation=0;aH.MixOperation=1;aH.AddOperation=2;aH.UVMapping=function(){};aH.CubeReflectionMapping=function(){};aH.CubeRefractionMapping=function(){};aH.SphericalReflectionMapping=function(){};aH.SphericalRefractionMapping=function(){};aH.RepeatWrapping=1000;aH.ClampToEdgeWrapping=1001;aH.MirroredRepeatWrapping=1002;aH.NearestFilter=1003;aH.NearestMipMapNearestFilter=1004;aH.NearestMipMapLinearFilter=1005;aH.LinearFilter=1006;aH.LinearMipMapNearestFilter=1007;aH.LinearMipMapLinearFilter=1008;aH.UnsignedByteType=1009;aH.ByteType=1010;aH.ShortType=1011;aH.UnsignedShortType=1012;aH.IntType=1013;aH.UnsignedIntType=1014;aH.FloatType=1015;aH.UnsignedShort4444Type=1016;aH.UnsignedShort5551Type=1017;aH.UnsignedShort565Type=1018;aH.AlphaFormat=1019;aH.RGBFormat=1020;aH.RGBAFormat=1021;aH.LuminanceFormat=1022;aH.LuminanceAlphaFormat=1023;aH.RGB_S3TC_DXT1_Format=2001;aH.RGBA_S3TC_DXT1_Format=2002;aH.RGBA_S3TC_DXT3_Format=2003;aH.RGBA_S3TC_DXT5_Format=2004;aH.Color=function(e){if(e!==undefined){this.set(e)}return this};aH.Color.prototype={constructor:aH.Color,r:1,g:1,b:1,set:function(e){if(e instanceof aH.Color){this.copy(e)}else{if(typeof e==="number"){this.setHex(e)}else{if(typeof e==="string"){this.setStyle(e)}}}return this},setHex:function(e){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(e&255)/255;return this},setRGB:function(cs,cr,e){this.r=cs;this.g=cr;this.b=e;return this},setHSL:function(ct,cs,cr){if(cs===0){this.r=this.g=this.b=cr}else{var e=function(cy,cx,cw){if(cw<0){cw+=1}if(cw>1){cw-=1}if(cw<1/6){return cy+(cx-cy)*6*cw}if(cw<1/2){return cx}if(cw<2/3){return cy+(cx-cy)*6*(2/3-cw)}return cy};var cv=cr<=0.5?cr*(1+cs):cr+cs-(cr*cs);var cu=(2*cr)-cv;this.r=e(cu,cv,ct+1/3);this.g=e(cu,cv,ct);this.b=e(cu,cv,ct-1/3)}return this},setStyle:function(cr){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(cr)){var e=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(cr);this.r=Math.min(255,parseInt(e[1],10))/255;this.g=Math.min(255,parseInt(e[2],10))/255;this.b=Math.min(255,parseInt(e[3],10))/255;return this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(cr)){var e=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(cr);this.r=Math.min(100,parseInt(e[1],10))/100;this.g=Math.min(100,parseInt(e[2],10))/100;this.b=Math.min(100,parseInt(e[3],10))/100;return this}if(/^\#([0-9a-f]{6})$/i.test(cr)){var e=/^\#([0-9a-f]{6})$/i.exec(cr);this.setHex(parseInt(e[1],16));return this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(cr)){var e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(cr);this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16));return this}if(/^(\w+)$/i.test(cr)){this.setHex(aH.ColorKeywords[cr]);return this}},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e){this.r=e.r*e.r;this.g=e.g*e.g;this.b=e.b*e.b;return this},copyLinearToGamma:function(e){this.r=Math.sqrt(e.r);this.g=Math.sqrt(e.g);this.b=Math.sqrt(e.b);return this},convertGammaToLinear:function(){var cs=this.r,cr=this.g,e=this.b;this.r=cs*cs;this.g=cr*cr;this.b=e*e;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return(this.r*255)<<16^(this.g*255)<<8^(this.b*255)<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var e={h:0,s:0,l:0};return function(){var cr=this.r,cu=this.g,cw=this.b;var cx=Math.max(cr,cu,cw);var cs=Math.min(cr,cu,cw);var cv,ct;var cz=(cs+cx)/2;if(cs===cx){cv=0;ct=0}else{var cy=cx-cs;ct=cz<=0.5?cy/(cx+cs):cy/(2-cx-cs);switch(cx){case cr:cv=(cu-cw)/cy+(cu<cw?6:0);break;case cu:cv=(cw-cr)/cy+2;break;case cw:cv=(cr-cu)/cy+4;break}cv/=6}e.h=cv;e.s=ct;e.l=cz;return e}}(),getStyle:function(){return"rgb("+((this.r*255)|0)+","+((this.g*255)|0)+","+((this.b*255)|0)+")"},offsetHSL:function(ct,cs,e){var cr=this.getHSL();cr.h+=ct;cr.s+=cs;cr.l+=e;this.setHSL(cr.h,cr.s,cr.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(cr,e){this.r=cr.r+e.r;this.g=cr.g+e.g;this.b=cr.b+e.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;this.g*=e;this.b*=e;return this},lerp:function(e,cr){this.r+=(e.r-this.r)*cr;this.g+=(e.g-this.g)*cr;this.b+=(e.b-this.b)*cr;return this},equals:function(e){return(e.r===this.r)&&(e.g===this.g)&&(e.b===this.b)},clone:function(){return new aH.Color().setRGB(this.r,this.g,this.b)}};aH.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};aH.Quaternion=function(e,ct,cs,cr){this.x=e||0;this.y=ct||0;this.z=cs||0;this.w=(cr!==undefined)?cr:1};aH.Quaternion.prototype={constructor:aH.Quaternion,set:function(e,ct,cs,cr){this.x=e;this.y=ct;this.z=cs;this.w=cr;return this},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w;return this},setFromEuler:function(cs,e){var cx=Math.cos(cs.x/2);var cw=Math.cos(cs.y/2);var cu=Math.cos(cs.z/2);var cv=Math.sin(cs.x/2);var ct=Math.sin(cs.y/2);var cr=Math.sin(cs.z/2);if(e===undefined||e==="XYZ"){this.x=cv*cw*cu+cx*ct*cr;this.y=cx*ct*cu-cv*cw*cr;this.z=cx*cw*cr+cv*ct*cu;this.w=cx*cw*cu-cv*ct*cr}else{if(e==="YXZ"){this.x=cv*cw*cu+cx*ct*cr;this.y=cx*ct*cu-cv*cw*cr;this.z=cx*cw*cr-cv*ct*cu;this.w=cx*cw*cu+cv*ct*cr}else{if(e==="ZXY"){this.x=cv*cw*cu-cx*ct*cr;this.y=cx*ct*cu+cv*cw*cr;this.z=cx*cw*cr+cv*ct*cu;this.w=cx*cw*cu-cv*ct*cr}else{if(e==="ZYX"){this.x=cv*cw*cu-cx*ct*cr;this.y=cx*ct*cu+cv*cw*cr;this.z=cx*cw*cr-cv*ct*cu;this.w=cx*cw*cu+cv*ct*cr}else{if(e==="YZX"){this.x=cv*cw*cu+cx*ct*cr;this.y=cx*ct*cu+cv*cw*cr;this.z=cx*cw*cr-cv*ct*cu;this.w=cx*cw*cu-cv*ct*cr}else{if(e==="XZY"){this.x=cv*cw*cu-cx*ct*cr;this.y=cx*ct*cu-cv*cw*cr;this.z=cx*cw*cr+cv*ct*cu;this.w=cx*cw*cu+cv*ct*cr}}}}}}return this},setFromAxisAngle:function(cs,ct){var e=ct/2,cr=Math.sin(e);this.x=cs.x*cr;this.y=cs.y*cr;this.z=cs.z*cr;this.w=Math.cos(e);return this},setFromRotationMatrix:function(cu){var ct=cu.elements,cy=ct[0],cx=ct[4],cw=ct[8],cs=ct[1],cr=ct[5],e=ct[9],cB=ct[2],cA=ct[6],cz=ct[10],cv=cy+cr+cz,cC;if(cv>0){cC=0.5/Math.sqrt(cv+1);this.w=0.25/cC;this.x=(cA-e)*cC;this.y=(cw-cB)*cC;this.z=(cs-cx)*cC}else{if(cy>cr&&cy>cz){cC=2*Math.sqrt(1+cy-cr-cz);this.w=(cA-e)/cC;this.x=0.25*cC;this.y=(cx+cs)/cC;this.z=(cw+cB)/cC}else{if(cr>cz){cC=2*Math.sqrt(1+cr-cy-cz);this.w=(cw-cB)/cC;this.x=(cx+cs)/cC;this.y=0.25*cC;this.z=(e+cA)/cC}else{cC=2*Math.sqrt(1+cz-cy-cr);this.w=(cs-cx)/cC;this.x=(cw+cB)/cC;this.y=(e+cA)/cC;this.z=0.25*cC}}}return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var e=this.length();if(e===0){this.x=0;this.y=0;this.z=0;this.w=1}else{e=1/e;this.x=this.x*e;this.y=this.y*e;this.z=this.z*e;this.w=this.w*e}return this},multiply:function(e,cr){if(cr!==undefined){console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(e,cr)}return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(cz,cy){var cw=cz.x,cv=cz.y,cu=cz.z,cx=cz.w;var cs=cy.x,cr=cy.y,e=cy.z,ct=cy.w;this.x=cw*ct+cx*cs+cv*e-cu*cr;this.y=cv*ct+cx*cr+cu*cs-cw*e;this.z=cu*ct+cx*e+cw*cr-cv*cs;this.w=cx*ct-cw*cs-cv*cr-cu*e;return this},multiplyVector3:function(e){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)},slerp:function(cs,cA){var cy=this.x,cx=this.y,cw=this.z,cz=this.w;var cr=cz*cs.w+cy*cs.x+cx*cs.y+cw*cs.z;if(cr<0){this.w=-cs.w;this.x=-cs.x;this.y=-cs.y;this.z=-cs.z;cr=-cr}else{this.copy(cs)}if(cr>=1){this.w=cz;this.x=cy;this.y=cx;this.z=cw;return this}var ct=Math.acos(cr);var e=Math.sqrt(1-cr*cr);if(Math.abs(e)<0.001){this.w=0.5*(cz+this.w);this.x=0.5*(cy+this.x);this.y=0.5*(cx+this.y);this.z=0.5*(cw+this.z);return this}var cv=Math.sin((1-cA)*ct)/e,cu=Math.sin(cA*ct)/e;this.w=(cz*cv+this.w*cu);this.x=(cy*cv+this.x*cu);this.y=(cx*cv+this.y*cu);this.z=(cw*cv+this.z*cu);return this},equals:function(e){return((e.x===this.x)&&(e.y===this.y)&&(e.z===this.z)&&(e.w===this.w))},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];this.w=e[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new aH.Quaternion(this.x,this.y,this.z,this.w)}};aH.Quaternion.slerp=function(ct,cs,cr,e){return cr.copy(ct).slerp(cs,e)};aH.Vector2=function(e,cr){this.x=e||0;this.y=cr||0};aH.Vector2.prototype={constructor:aH.Vector2,set:function(e,cr){this.x=e;this.y=cr;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,cr){switch(e){case 0:this.x=cr;break;case 1:this.y=cr;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(cr,e)}this.x+=cr.x;this.y+=cr.y;return this},addVectors:function(cr,e){this.x=cr.x+e.x;this.y=cr.y+e.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},sub:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(cr,e)}this.x-=cr.x;this.y-=cr.y;return this},subVectors:function(cr,e){this.x=cr.x-e.x;this.y=cr.y-e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){if(e!==0){this.x/=e;this.y/=e}else{this.set(0,0)}return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}return this},clamp:function(cr,e){if(this.x<cr.x){this.x=cr.x}else{if(this.x>e.x){this.x=e.x}}if(this.y<cr.y){this.y=cr.y}else{if(this.y>e.y){this.y=e.y}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(cs){var cr=this.x-cs.x,e=this.y-cs.y;return cr*cr+e*e},setLength:function(e){var cr=this.length();if(cr!==0&&e!==cr){this.multiplyScalar(e/cr)}return this},lerp:function(e,cr){this.x+=(e.x-this.x)*cr;this.y+=(e.y-this.y)*cr;return this},equals:function(e){return((e.x===this.x)&&(e.y===this.y))},fromArray:function(e){this.x=e[0];this.y=e[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new aH.Vector2(this.x,this.y)}};aH.Vector3=function(e,cs,cr){this.x=e||0;this.y=cs||0;this.z=cr||0};aH.Vector3.prototype={constructor:aH.Vector3,set:function(e,cs,cr){this.x=e;this.y=cs;this.z=cr;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,cr){switch(e){case 0:this.x=cr;break;case 1:this.y=cr;break;case 2:this.z=cr;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(cr,e)}this.x+=cr.x;this.y+=cr.y;this.z+=cr.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(cr,e){this.x=cr.x+e.x;this.y=cr.y+e.y;this.z=cr.z+e.z;return this},sub:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(cr,e)}this.x-=cr.x;this.y-=cr.y;this.z-=cr.z;return this},subVectors:function(cr,e){this.x=cr.x-e.x;this.y=cr.y-e.y;this.z=cr.z-e.z;return this},multiply:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(cr,e)}this.x*=cr.x;this.y*=cr.y;this.z*=cr.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(cr,e){this.x=cr.x*e.x;this.y=cr.y*e.y;this.z=cr.z*e.z;return this},applyMatrix3:function(cs){var cr=this.x;var cv=this.y;var cu=this.z;var ct=cs.elements;this.x=ct[0]*cr+ct[3]*cv+ct[6]*cu;this.y=ct[1]*cr+ct[4]*cv+ct[7]*cu;this.z=ct[2]*cr+ct[5]*cv+ct[8]*cu;return this},applyMatrix4:function(cs){var cr=this.x,cv=this.y,cu=this.z;var ct=cs.elements;this.x=ct[0]*cr+ct[4]*cv+ct[8]*cu+ct[12];this.y=ct[1]*cr+ct[5]*cv+ct[9]*cu+ct[13];this.z=ct[2]*cr+ct[6]*cv+ct[10]*cu+ct[14];return this},applyProjection:function(cs){var cr=this.x,cw=this.y,cv=this.z;var ct=cs.elements;var cu=1/(ct[3]*cr+ct[7]*cw+ct[11]*cv+ct[15]);this.x=(ct[0]*cr+ct[4]*cw+ct[8]*cv+ct[12])*cu;this.y=(ct[1]*cr+ct[5]*cw+ct[9]*cv+ct[13])*cu;this.z=(ct[2]*cr+ct[6]*cw+ct[10]*cv+ct[14])*cu;return this},applyQuaternion:function(e){var cB=this.x;var cA=this.y;var cz=this.z;var cx=e.x;var cw=e.y;var cv=e.z;var cy=e.w;var ct=cy*cB+cw*cz-cv*cA;var cs=cy*cA+cv*cB-cx*cz;var cr=cy*cz+cx*cA-cw*cB;var cu=-cx*cB-cw*cA-cv*cz;this.x=ct*cy+cu*-cx+cs*-cv-cr*-cw;this.y=cs*cy+cu*-cw+cr*-cx-ct*-cv;this.z=cr*cy+cu*-cv+ct*-cw-cs*-cx;return this},transformDirection:function(cs){var cr=this.x,cv=this.y,cu=this.z;var ct=cs.elements;this.x=ct[0]*cr+ct[4]*cv+ct[8]*cu;this.y=ct[1]*cr+ct[5]*cv+ct[9]*cu;this.z=ct[2]*cr+ct[6]*cv+ct[10]*cu;this.normalize();return this},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){if(e!==0){this.x/=e;this.y/=e;this.z/=e}else{this.x=0;this.y=0;this.z=0}return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}if(this.z>e.z){this.z=e.z}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}if(this.z<e.z){this.z=e.z}return this},clamp:function(cr,e){if(this.x<cr.x){this.x=cr.x}else{if(this.x>e.x){this.x=e.x}}if(this.y<cr.y){this.y=cr.y}else{if(this.y>e.y){this.y=e.y}}if(this.z<cr.z){this.z=cr.z}else{if(this.z>e.z){this.z=e.z}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var cr=this.length();if(cr!==0&&e!==cr){this.multiplyScalar(e/cr)}return this},lerp:function(e,cr){this.x+=(e.x-this.x)*cr;this.y+=(e.y-this.y)*cr;this.z+=(e.z-this.z)*cr;return this},cross:function(cs,cr){if(cr!==undefined){console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(cs,cr)}var e=this.x,cu=this.y,ct=this.z;this.x=cu*cs.z-ct*cs.y;this.y=ct*cs.x-e*cs.z;this.z=e*cs.y-cu*cs.x;return this},crossVectors:function(cr,e){this.x=cr.y*e.z-cr.z*e.y;this.y=cr.z*e.x-cr.x*e.z;this.z=cr.x*e.y-cr.y*e.x;return this},angleTo:function(e){var cr=this.dot(e)/(this.length()*e.length());return Math.acos(aH.Math.clamp(cr,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(ct){var cs=this.x-ct.x;var cr=this.y-ct.y;var e=this.z-ct.z;return cs*cs+cr*cr+e*e},setEulerFromRotationMatrix:function(cu,cv){function cy(cD){return Math.min(Math.max(cD,-1),1)}var ct=cu.elements;var cz=ct[0],cx=ct[4],cw=ct[8];var cs=ct[1],cr=ct[5],e=ct[9];var cC=ct[2],cB=ct[6],cA=ct[10];if(cv===undefined||cv==="XYZ"){this.y=Math.asin(cy(cw));if(Math.abs(cw)<0.99999){this.x=Math.atan2(-e,cA);this.z=Math.atan2(-cx,cz)}else{this.x=Math.atan2(cB,cr);this.z=0}}else{if(cv==="YXZ"){this.x=Math.asin(-cy(e));if(Math.abs(e)<0.99999){this.y=Math.atan2(cw,cA);this.z=Math.atan2(cs,cr)}else{this.y=Math.atan2(-cC,cz);this.z=0}}else{if(cv==="ZXY"){this.x=Math.asin(cy(cB));if(Math.abs(cB)<0.99999){this.y=Math.atan2(-cC,cA);this.z=Math.atan2(-cx,cr)}else{this.y=0;this.z=Math.atan2(cs,cz)}}else{if(cv==="ZYX"){this.y=Math.asin(-cy(cC));if(Math.abs(cC)<0.99999){this.x=Math.atan2(cB,cA);this.z=Math.atan2(cs,cz)}else{this.x=0;this.z=Math.atan2(-cx,cr)}}else{if(cv==="YZX"){this.z=Math.asin(cy(cs));if(Math.abs(cs)<0.99999){this.x=Math.atan2(-e,cr);this.y=Math.atan2(-cC,cz)}else{this.x=0;this.y=Math.atan2(cw,cA)}}else{if(cv==="XZY"){this.z=Math.asin(-cy(cx));if(Math.abs(cx)<0.99999){this.x=Math.atan2(cB,cr);this.y=Math.atan2(cw,cz)}else{this.x=Math.atan2(-e,cA);this.y=0}}}}}}}return this},setEulerFromQuaternion:function(ct,e){function cw(cx){return Math.min(Math.max(cx,-1),1)}var cu=ct.x*ct.x;var cs=ct.y*ct.y;var cr=ct.z*ct.z;var cv=ct.w*ct.w;if(e===undefined||e==="XYZ"){this.x=Math.atan2(2*(ct.x*ct.w-ct.y*ct.z),(cv-cu-cs+cr));this.y=Math.asin(cw(2*(ct.x*ct.z+ct.y*ct.w)));this.z=Math.atan2(2*(ct.z*ct.w-ct.x*ct.y),(cv+cu-cs-cr))}else{if(e==="YXZ"){this.x=Math.asin(cw(2*(ct.x*ct.w-ct.y*ct.z)));this.y=Math.atan2(2*(ct.x*ct.z+ct.y*ct.w),(cv-cu-cs+cr));this.z=Math.atan2(2*(ct.x*ct.y+ct.z*ct.w),(cv-cu+cs-cr))}else{if(e==="ZXY"){this.x=Math.asin(cw(2*(ct.x*ct.w+ct.y*ct.z)));this.y=Math.atan2(2*(ct.y*ct.w-ct.z*ct.x),(cv-cu-cs+cr));this.z=Math.atan2(2*(ct.z*ct.w-ct.x*ct.y),(cv-cu+cs-cr))}else{if(e==="ZYX"){this.x=Math.atan2(2*(ct.x*ct.w+ct.z*ct.y),(cv-cu-cs+cr));this.y=Math.asin(cw(2*(ct.y*ct.w-ct.x*ct.z)));this.z=Math.atan2(2*(ct.x*ct.y+ct.z*ct.w),(cv+cu-cs-cr))}else{if(e==="YZX"){this.x=Math.atan2(2*(ct.x*ct.w-ct.z*ct.y),(cv-cu+cs-cr));this.y=Math.atan2(2*(ct.y*ct.w-ct.x*ct.z),(cv+cu-cs-cr));this.z=Math.asin(cw(2*(ct.x*ct.y+ct.z*ct.w)))}else{if(e==="XZY"){this.x=Math.atan2(2*(ct.x*ct.w+ct.y*ct.z),(cv-cu+cs-cr));this.y=Math.atan2(2*(ct.x*ct.z+ct.y*ct.w),(cv+cu-cs-cr));this.z=Math.asin(cw(2*(ct.z*ct.w-ct.x*ct.y)))}}}}}}return this},getPositionFromMatrix:function(e){this.x=e.elements[12];this.y=e.elements[13];this.z=e.elements[14];return this},getScaleFromMatrix:function(e){var ct=this.set(e.elements[0],e.elements[1],e.elements[2]).length();var cs=this.set(e.elements[4],e.elements[5],e.elements[6]).length();var cr=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=ct;this.y=cs;this.z=cr;return this},getColumnFromMatrix:function(cr,e){var ct=cr*4;var cs=e.elements;this.x=cs[ct];this.y=cs[ct+1];this.z=cs[ct+2];return this},equals:function(e){return((e.x===this.x)&&(e.y===this.y)&&(e.z===this.z))},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new aH.Vector3(this.x,this.y,this.z)}};aH.extend(aH.Vector3.prototype,{applyEuler:function(){var e=new aH.Quaternion();return function(cr,ct){var cs=e.setFromEuler(cr,ct);this.applyQuaternion(cs);return this}}(),applyAxisAngle:function(){var e=new aH.Quaternion();return function(cr,ct){var cs=e.setFromAxisAngle(cr,ct);this.applyQuaternion(cs);return this}}(),projectOnVector:function(){var e=new aH.Vector3();return function(cr){e.copy(cr).normalize();var cs=this.dot(e);return this.copy(e).multiplyScalar(cs)}}(),projectOnPlane:function(){var e=new aH.Vector3();return function(cr){e.copy(this).projectOnVector(cr);return this.sub(e)}}(),reflect:function(){var e=new aH.Vector3();return function(cr){e.copy(this).projectOnVector(cr).multiplyScalar(2);return this.subVectors(e,this)}}()});aH.Vector4=function(e,ct,cs,cr){this.x=e||0;this.y=ct||0;this.z=cs||0;this.w=(cr!==undefined)?cr:1};aH.Vector4.prototype={constructor:aH.Vector4,set:function(e,ct,cs,cr){this.x=e;this.y=ct;this.z=cs;this.w=cr;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,cr){switch(e){case 0:this.x=cr;break;case 1:this.y=cr;break;case 2:this.z=cr;break;case 3:this.w=cr;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=(e.w!==undefined)?e.w:1;return this},add:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(cr,e)}this.x+=cr.x;this.y+=cr.y;this.z+=cr.z;this.w+=cr.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(cr,e){this.x=cr.x+e.x;this.y=cr.y+e.y;this.z=cr.z+e.z;this.w=cr.w+e.w;return this},sub:function(cr,e){if(e!==undefined){console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(cr,e)}this.x-=cr.x;this.y-=cr.y;this.z-=cr.z;this.w-=cr.w;return this},subVectors:function(cr,e){this.x=cr.x-e.x;this.y=cr.y-e.y;this.z=cr.z-e.z;this.w=cr.w-e.w;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this},applyMatrix4:function(cs){var cr=this.x;var cw=this.y;var cv=this.z;var ct=this.w;var cu=cs.elements;this.x=cu[0]*cr+cu[4]*cw+cu[8]*cv+cu[12]*ct;this.y=cu[1]*cr+cu[5]*cw+cu[9]*cv+cu[13]*ct;this.z=cu[2]*cr+cu[6]*cw+cu[10]*cv+cu[14]*ct;this.w=cu[3]*cr+cu[7]*cw+cu[11]*cv+cu[15]*ct;return this},divideScalar:function(e){if(e!==0){this.x/=e;this.y/=e;this.z/=e;this.w/=e}else{this.x=0;this.y=0;this.z=0;this.w=1}return this},setAxisAngleFromQuaternion:function(cr){this.w=2*Math.acos(cr.w);var e=Math.sqrt(1-cr.w*cr.w);if(e<0.0001){this.x=1;this.y=0;this.z=0}else{this.x=cr.x/e;this.y=cr.y/e;this.z=cr.z/e}return this},setAxisAngleFromRotationMatrix:function(cH){var cI,cz,cy,cx,cN=0.01,cA=0.1,cw=cH.elements,cM=cw[0],cK=cw[4],cJ=cw[8],cu=cw[1],cs=cw[5],e=cw[9],cG=cw[2],cE=cw[6],cC=cw[10];if((Math.abs(cK-cu)<cN)&&(Math.abs(cJ-cG)<cN)&&(Math.abs(e-cE)<cN)){if((Math.abs(cK+cu)<cA)&&(Math.abs(cJ+cG)<cA)&&(Math.abs(e+cE)<cA)&&(Math.abs(cM+cs+cC-3)<cA)){this.set(1,0,0,0);return this}cI=Math.PI;var cv=(cM+1)/2;var cF=(cs+1)/2;var cL=(cC+1)/2;var ct=(cK+cu)/4;var cr=(cJ+cG)/4;var cD=(e+cE)/4;if((cv>cF)&&(cv>cL)){if(cv<cN){cz=0;cy=0.707106781;cx=0.707106781}else{cz=Math.sqrt(cv);cy=ct/cz;cx=cr/cz}}else{if(cF>cL){if(cF<cN){cz=0.707106781;cy=0;cx=0.707106781}else{cy=Math.sqrt(cF);cz=ct/cy;cx=cD/cy}}else{if(cL<cN){cz=0.707106781;cy=0.707106781;cx=0}else{cx=Math.sqrt(cL);cz=cr/cx;cy=cD/cx}}}this.set(cz,cy,cx,cI);return this}var cB=Math.sqrt((cE-e)*(cE-e)+(cJ-cG)*(cJ-cG)+(cu-cK)*(cu-cK));if(Math.abs(cB)<0.001){cB=1}this.x=(cE-e)/cB;this.y=(cJ-cG)/cB;this.z=(cu-cK)/cB;this.w=Math.acos((cM+cs+cC-1)/2);return this},min:function(e){if(this.x>e.x){this.x=e.x}if(this.y>e.y){this.y=e.y}if(this.z>e.z){this.z=e.z}if(this.w>e.w){this.w=e.w}return this},max:function(e){if(this.x<e.x){this.x=e.x}if(this.y<e.y){this.y=e.y}if(this.z<e.z){this.z=e.z}if(this.w<e.w){this.w=e.w}return this},clamp:function(cr,e){if(this.x<cr.x){this.x=cr.x}else{if(this.x>e.x){this.x=e.x}}if(this.y<cr.y){this.y=cr.y}else{if(this.y>e.y){this.y=e.y}}if(this.z<cr.z){this.z=cr.z}else{if(this.z>e.z){this.z=e.z}}if(this.w<cr.w){this.w=cr.w}else{if(this.w>e.w){this.w=e.w}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var cr=this.length();if(cr!==0&&e!==cr){this.multiplyScalar(e/cr)}return this},lerp:function(e,cr){this.x+=(e.x-this.x)*cr;this.y+=(e.y-this.y)*cr;this.z+=(e.z-this.z)*cr;this.w+=(e.w-this.w)*cr;return this},equals:function(e){return((e.x===this.x)&&(e.y===this.y)&&(e.z===this.z)&&(e.w===this.w))},fromArray:function(e){this.x=e[0];this.y=e[1];this.z=e[2];this.w=e[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new aH.Vector4(this.x,this.y,this.z,this.w)}};aH.Line3=function(cr,e){this.start=(cr!==undefined)?cr:new aH.Vector3();this.end=(e!==undefined)?e:new aH.Vector3()};aH.Line3.prototype={constructor:aH.Line3,set:function(cr,e){this.start.copy(cr);this.end.copy(e);return this},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},center:function(cr){var e=cr||new aH.Vector3();return e.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(cr){var e=cr||new aH.Vector3();return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(cs,cr){var e=cr||new aH.Vector3();return this.delta(e).multiplyScalar(cs).add(this.start)},closestPointToPointParameter:function(){var cr=new aH.Vector3();var e=new aH.Vector3();return function(cs,cw){cr.subVectors(cs,this.start);e.subVectors(this.end,this.start);var cv=e.dot(e);var cu=e.dot(cr);var ct=cu/cv;if(cw){ct=aH.Math.clamp(ct,0,1)}return ct}}(),closestPointToPoint:function(cr,cu,ct){var cs=this.closestPointToPointParameter(cr,cu);var e=ct||new aH.Vector3();return this.delta(e).multiplyScalar(cs).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return new aH.Line3().copy(this)}};aH.Box2=function(cr,e){this.min=(cr!==undefined)?cr:new aH.Vector2(Infinity,Infinity);this.max=(e!==undefined)?e:new aH.Vector2(-Infinity,-Infinity)};aH.Box2.prototype={constructor:aH.Box2,set:function(cr,e){this.min.copy(cr);this.max.copy(e);return this},setFromPoints:function(ct){if(ct.length>0){var e=ct[0];this.min.copy(e);this.max.copy(e);for(var cs=1,cr=ct.length;cs<cr;cs++){e=ct[cs];if(e.x<this.min.x){this.min.x=e.x}else{if(e.x>this.max.x){this.max.x=e.x}}if(e.y<this.min.y){this.min.y=e.y}else{if(e.y>this.max.y){this.max.y=e.y}}}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var e=new aH.Vector2();return function(cr,ct){var cs=e.copy(ct).multiplyScalar(0.5);this.min.copy(cr).sub(cs);this.max.copy(cr).add(cs);return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return(this.max.x<this.min.x)||(this.max.y<this.min.y)},center:function(cr){var e=cr||new aH.Vector2();return e.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(cr){var e=cr||new aH.Vector2();return e.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y){return false}return true},containsBox:function(e){if((this.min.x<=e.min.x)&&(e.max.x<=this.max.x)&&(this.min.y<=e.min.y)&&(e.max.y<=this.max.y)){return true}return false},getParameter:function(e){return new aH.Vector2((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y){return false}return true},clampPoint:function(cr,cs){var e=cs||new aH.Vector2();return e.copy(cr).clamp(this.min,this.max)},distanceToPoint:function(){var e=new aH.Vector2();return function(cr){var cs=e.copy(cr).clamp(this.min,this.max);return cs.sub(cr).length()}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return new aH.Box2().copy(this)}};aH.Box3=function(cr,e){this.min=(cr!==undefined)?cr:new aH.Vector3(Infinity,Infinity,Infinity);this.max=(e!==undefined)?e:new aH.Vector3(-Infinity,-Infinity,-Infinity)};aH.Box3.prototype={constructor:aH.Box3,set:function(cr,e){this.min.copy(cr);this.max.copy(e);return this},setFromPoints:function(ct){if(ct.length>0){var e=ct[0];this.min.copy(e);this.max.copy(e);for(var cs=1,cr=ct.length;cs<cr;cs++){e=ct[cs];if(e.x<this.min.x){this.min.x=e.x}else{if(e.x>this.max.x){this.max.x=e.x}}if(e.y<this.min.y){this.min.y=e.y}else{if(e.y>this.max.y){this.max.y=e.y}}if(e.z<this.min.z){this.min.z=e.z}else{if(e.z>this.max.z){this.max.z=e.z}}}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var e=new aH.Vector3();return function(cr,ct){var cs=e.copy(ct).multiplyScalar(0.5);this.min.copy(cr).sub(cs);this.max.copy(cr).add(cs);return this}}(),copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return(this.max.x<this.min.x)||(this.max.y<this.min.y)||(this.max.z<this.min.z)},center:function(cr){var e=cr||new aH.Vector3();return e.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(cr){var e=cr||new aH.Vector3();return e.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){if(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z){return false}return true},containsBox:function(e){if((this.min.x<=e.min.x)&&(e.max.x<=this.max.x)&&(this.min.y<=e.min.y)&&(e.max.y<=this.max.y)&&(this.min.z<=e.min.z)&&(e.max.z<=this.max.z)){return true}return false},getParameter:function(e){return new aH.Vector3((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){if(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z){return false}return true},clampPoint:function(cr,cs){var e=cs||new aH.Vector3();return e.copy(cr).clamp(this.min,this.max)},distanceToPoint:function(){var e=new aH.Vector3();return function(cr){var cs=e.copy(cr).clamp(this.min,this.max);return cs.sub(cr).length()}}(),getBoundingSphere:function(){var e=new aH.Vector3();return function(cs){var cr=cs||new aH.Sphere();cr.center=this.center();cr.radius=this.size(e).length()*0.5;return cr}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3()];return function(cr){e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(cr);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(cr);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(cr);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(cr);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(cr);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(cr);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(cr);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(cr);this.makeEmpty();this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return new aH.Box3().copy(this)}};aH.Matrix3=function(cw,cv,cu,ct,cs,cr,e,cy,cx){this.elements=new Float32Array(9);this.set((cw!==undefined)?cw:1,cv||0,cu||0,ct||0,(cs!==undefined)?cs:1,cr||0,e||0,cy||0,(cx!==undefined)?cx:1)};aH.Matrix3.prototype={constructor:aH.Matrix3,set:function(cx,cw,cv,cu,ct,cs,e,cz,cy){var cr=this.elements;cr[0]=cx;cr[3]=cw;cr[6]=cv;cr[1]=cu;cr[4]=ct;cr[7]=cs;cr[2]=e;cr[5]=cz;cr[8]=cy;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(e){var cr=e.elements;this.set(cr[0],cr[3],cr[6],cr[1],cr[4],cr[7],cr[2],cr[5],cr[8]);return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new aH.Vector3();return function(cr){for(var ct=0,cs=cr.length;ct<cs;ct+=3){e.x=cr[ct];e.y=cr[ct+1];e.z=cr[ct+2];e.applyMatrix3(this);cr[ct]=e.x;cr[ct+1]=e.y;cr[ct+2]=e.z}return cr}}(),multiplyScalar:function(e){var cr=this.elements;cr[0]*=e;cr[3]*=e;cr[6]*=e;cr[1]*=e;cr[4]*=e;cr[7]*=e;cr[2]*=e;cr[5]*=e;cr[8]*=e;return this},determinant:function(){var cr=this.elements;var cA=cr[0],cz=cr[1],cy=cr[2],cx=cr[3],cw=cr[4],cv=cr[5],cu=cr[6],ct=cr[7],cs=cr[8];return cA*cw*cs-cA*cv*ct-cz*cx*cs+cz*cv*cu+cy*cx*ct-cy*cw*cu},getInverse:function(cr,e){var ct=cr.elements;var cv=this.elements;cv[0]=ct[10]*ct[5]-ct[6]*ct[9];cv[1]=-ct[10]*ct[1]+ct[2]*ct[9];cv[2]=ct[6]*ct[1]-ct[2]*ct[5];cv[3]=-ct[10]*ct[4]+ct[6]*ct[8];cv[4]=ct[10]*ct[0]-ct[2]*ct[8];cv[5]=-ct[6]*ct[0]+ct[2]*ct[4];cv[6]=ct[9]*ct[4]-ct[5]*ct[8];cv[7]=-ct[9]*ct[0]+ct[1]*ct[8];cv[8]=ct[5]*ct[0]-ct[1]*ct[4];var cs=ct[0]*cv[0]+ct[1]*cv[3]+ct[2]*cv[6];if(cs===0){var cu="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e||false){throw new Error(cu)}else{console.warn(cu)}this.identity();return this}this.multiplyScalar(1/cs);return this},transpose:function(){var cr,e=this.elements;cr=e[1];e[1]=e[3];e[3]=cr;cr=e[2];e[2]=e[6];e[6]=cr;cr=e[5];e[5]=e[7];e[7]=cr;return this},getNormalMatrix:function(e){this.getInverse(e).transpose();return this},transposeIntoArray:function(cr){var e=this.elements;cr[0]=e[0];cr[1]=e[3];cr[2]=e[6];cr[3]=e[1];cr[4]=e[4];cr[5]=e[7];cr[6]=e[2];cr[7]=e[5];cr[8]=e[8];return this},clone:function(){var e=this.elements;return new aH.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}};aH.Matrix4=function(cD,cC,cA,cy,cv,cu,ct,cs,e,cG,cF,cE,cB,cz,cx,cw){var cr=this.elements=new Float32Array(16);cr[0]=(cD!==undefined)?cD:1;cr[4]=cC||0;cr[8]=cA||0;cr[12]=cy||0;cr[1]=cv||0;cr[5]=(cu!==undefined)?cu:1;cr[9]=ct||0;cr[13]=cs||0;cr[2]=e||0;cr[6]=cG||0;cr[10]=(cF!==undefined)?cF:1;cr[14]=cE||0;cr[3]=cB||0;cr[7]=cz||0;cr[11]=cx||0;cr[15]=(cw!==undefined)?cw:1};aH.Matrix4.prototype={constructor:aH.Matrix4,set:function(cD,cC,cA,cy,cv,cu,ct,cs,e,cG,cF,cE,cB,cz,cx,cw){var cr=this.elements;cr[0]=cD;cr[4]=cC;cr[8]=cA;cr[12]=cy;cr[1]=cv;cr[5]=cu;cr[9]=ct;cr[13]=cs;cr[2]=e;cr[6]=cG;cr[10]=cF;cr[14]=cE;cr[3]=cB;cr[7]=cz;cr[11]=cx;cr[15]=cw;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(e){var cr=e.elements;this.set(cr[0],cr[4],cr[8],cr[12],cr[1],cr[5],cr[9],cr[13],cr[2],cr[6],cr[10],cr[14],cr[3],cr[7],cr[11],cr[15]);return this},extractPosition:function(e){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},copyPosition:function(e){var cs=this.elements;var cr=e.elements;cs[12]=cr[12];cs[13]=cr[13];cs[14]=cr[14];return this},extractRotation:function(){var e=new aH.Vector3();return function(cr){var cw=this.elements;var cv=cr.elements;var cu=1/e.set(cv[0],cv[1],cv[2]).length();var ct=1/e.set(cv[4],cv[5],cv[6]).length();var cs=1/e.set(cv[8],cv[9],cv[10]).length();cw[0]=cv[0]*cu;cw[1]=cv[1]*cu;cw[2]=cv[2]*cu;cw[4]=cv[4]*ct;cw[5]=cv[5]*ct;cw[6]=cv[6]*ct;cw[8]=cv[8]*cs;cw[9]=cv[9]*cs;cw[10]=cv[10]*cs;return this}}(),setRotationFromEuler:function(cr,e){console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code.");return this.makeRotationFromEuler(cr,e)},makeRotationFromEuler:function(cz,cC){var cv=this.elements;var cy=cz.x,cx=cz.y,cw=cz.z;var cO=Math.cos(cy),cN=Math.sin(cy);var cL=Math.cos(cx),cI=Math.sin(cx);var cF=Math.cos(cw),cD=Math.sin(cw);if(cC===undefined||cC==="XYZ"){var cH=cO*cF,cE=cO*cD,cs=cN*cF,cr=cN*cD;cv[0]=cL*cF;cv[4]=-cL*cD;cv[8]=cI;cv[1]=cE+cs*cI;cv[5]=cH-cr*cI;cv[9]=-cN*cL;cv[2]=cr-cH*cI;cv[6]=cs+cE*cI;cv[10]=cO*cL}else{if(cC==="YXZ"){var cB=cL*cF,cA=cL*cD,cK=cI*cF,cG=cI*cD;cv[0]=cB+cG*cN;cv[4]=cK*cN-cA;cv[8]=cO*cI;cv[1]=cO*cD;cv[5]=cO*cF;cv[9]=-cN;cv[2]=cA*cN-cK;cv[6]=cG+cB*cN;cv[10]=cO*cL}else{if(cC==="ZXY"){var cB=cL*cF,cA=cL*cD,cK=cI*cF,cG=cI*cD;cv[0]=cB-cG*cN;cv[4]=-cO*cD;cv[8]=cK+cA*cN;cv[1]=cA+cK*cN;cv[5]=cO*cF;cv[9]=cG-cB*cN;cv[2]=-cO*cI;cv[6]=cN;cv[10]=cO*cL}else{if(cC==="ZYX"){var cH=cO*cF,cE=cO*cD,cs=cN*cF,cr=cN*cD;cv[0]=cL*cF;cv[4]=cs*cI-cE;cv[8]=cH*cI+cr;cv[1]=cL*cD;cv[5]=cr*cI+cH;cv[9]=cE*cI-cs;cv[2]=-cI;cv[6]=cN*cL;cv[10]=cO*cL}else{if(cC==="YZX"){var cM=cO*cL,cJ=cO*cI,cu=cN*cL,ct=cN*cI;cv[0]=cL*cF;cv[4]=ct-cM*cD;cv[8]=cu*cD+cJ;cv[1]=cD;cv[5]=cO*cF;cv[9]=-cN*cF;cv[2]=-cI*cF;cv[6]=cJ*cD+cu;cv[10]=cM-ct*cD}else{if(cC==="XZY"){var cM=cO*cL,cJ=cO*cI,cu=cN*cL,ct=cN*cI;cv[0]=cL*cF;cv[4]=-cD;cv[8]=cI*cF;cv[1]=cM*cD+ct;cv[5]=cO*cF;cv[9]=cJ*cD-cu;cv[2]=cu*cD-cJ;cv[6]=cN*cF;cv[10]=ct*cD+cM}}}}}}cv[3]=0;cv[7]=0;cv[11]=0;cv[12]=0;cv[13]=0;cv[14]=0;cv[15]=1;return this},setRotationFromQuaternion:function(e){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(cB){var cu=this.elements;var cx=cB.x,cw=cB.y,cv=cB.z,cy=cB.w;var cD=cx+cx,e=cw+cw,cz=cv+cv;var ct=cx*cD,cs=cx*e,cr=cx*cz;var cC=cw*e,cA=cw*cz,cG=cv*cz;var cH=cy*cD,cF=cy*e,cE=cy*cz;cu[0]=1-(cC+cG);cu[4]=cs-cE;cu[8]=cr+cF;cu[1]=cs+cE;cu[5]=1-(ct+cG);cu[9]=cA-cH;cu[2]=cr-cF;cu[6]=cA+cH;cu[10]=1-(ct+cC);cu[3]=0;cu[7]=0;cu[11]=0;cu[12]=0;cu[13]=0;cu[14]=0;cu[15]=1;return this},lookAt:function(){var e=new aH.Vector3();var cs=new aH.Vector3();var cr=new aH.Vector3();return function(cu,cv,ct){var cw=this.elements;cr.subVectors(cu,cv).normalize();if(cr.length()===0){cr.z=1}e.crossVectors(ct,cr).normalize();if(e.length()===0){cr.x+=0.0001;e.crossVectors(ct,cr).normalize()}cs.crossVectors(cr,e);cw[0]=e.x;cw[4]=cs.x;cw[8]=cr.x;cw[1]=e.y;cw[5]=cs.y;cw[9]=cr.y;cw[2]=e.z;cw[6]=cs.z;cw[10]=cr.z;return this}}(),multiply:function(e,cr){if(cr!==undefined){console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(e,cr)}return this.multiplyMatrices(this,e)},multiplyMatrices:function(c0,cZ){var cG=c0.elements;var cY=cZ.elements;var e=this.elements;var cD=cG[0],cB=cG[4],cA=cG[8],cz=cG[12];var cX=cG[1],cW=cG[5],cV=cG[9],cU=cG[13];var cP=cG[2],cO=cG[6],cN=cG[10],cM=cG[14];var cH=cG[3],cF=cG[7],cE=cG[11],cC=cG[15];var cw=cY[0],cu=cY[4],cs=cY[8],cr=cY[12];var cT=cY[1],cS=cY[5],cR=cY[9],cQ=cY[13];var cL=cY[2],cK=cY[6],cJ=cY[10],cI=cY[14];var cy=cY[3],cx=cY[7],cv=cY[11],ct=cY[15];e[0]=cD*cw+cB*cT+cA*cL+cz*cy;e[4]=cD*cu+cB*cS+cA*cK+cz*cx;e[8]=cD*cs+cB*cR+cA*cJ+cz*cv;e[12]=cD*cr+cB*cQ+cA*cI+cz*ct;e[1]=cX*cw+cW*cT+cV*cL+cU*cy;e[5]=cX*cu+cW*cS+cV*cK+cU*cx;e[9]=cX*cs+cW*cR+cV*cJ+cU*cv;e[13]=cX*cr+cW*cQ+cV*cI+cU*ct;e[2]=cP*cw+cO*cT+cN*cL+cM*cy;e[6]=cP*cu+cO*cS+cN*cK+cM*cx;e[10]=cP*cs+cO*cR+cN*cJ+cM*cv;e[14]=cP*cr+cO*cQ+cN*cI+cM*ct;e[3]=cH*cw+cF*cT+cE*cL+cC*cy;e[7]=cH*cu+cF*cS+cE*cK+cC*cx;e[11]=cH*cs+cF*cR+cE*cJ+cC*cv;e[15]=cH*cr+cF*cQ+cE*cI+cC*ct;return this},multiplyToArray:function(cr,e,cs){var ct=this.elements;this.multiplyMatrices(cr,e);cs[0]=ct[0];cs[1]=ct[1];cs[2]=ct[2];cs[3]=ct[3];cs[4]=ct[4];cs[5]=ct[5];cs[6]=ct[6];cs[7]=ct[7];cs[8]=ct[8];cs[9]=ct[9];cs[10]=ct[10];cs[11]=ct[11];cs[12]=ct[12];cs[13]=ct[13];cs[14]=ct[14];cs[15]=ct[15];return this},multiplyScalar:function(e){var cr=this.elements;cr[0]*=e;cr[4]*=e;cr[8]*=e;cr[12]*=e;cr[1]*=e;cr[5]*=e;cr[9]*=e;cr[13]*=e;cr[2]*=e;cr[6]*=e;cr[10]*=e;cr[14]*=e;cr[3]*=e;cr[7]*=e;cr[11]*=e;cr[15]*=e;return this},multiplyVector3:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return e.applyProjection(this)},multiplyVector4:function(e){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new aH.Vector3();return function(cr){for(var ct=0,cs=cr.length;ct<cs;ct+=3){e.x=cr[ct];e.y=cr[ct+1];e.z=cr[ct+2];e.applyProjection(this);cr[ct]=e.x;cr[ct+1]=e.y;cr[ct+2]=e.z}return cr}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},determinant:function(){var cs=this.elements;var cD=cs[0],cC=cs[4],cA=cs[8],cy=cs[12];var cv=cs[1],cu=cs[5],ct=cs[9],cr=cs[13];var e=cs[2],cG=cs[6],cF=cs[10],cE=cs[14];var cB=cs[3],cz=cs[7],cx=cs[11],cw=cs[15];return(cB*(+cy*ct*cG-cA*cr*cG-cy*cu*cF+cC*cr*cF+cA*cu*cE-cC*ct*cE)+cz*(+cD*ct*cE-cD*cr*cF+cy*cv*cF-cA*cv*cE+cA*cr*e-cy*ct*e)+cx*(+cD*cr*cG-cD*cu*cE-cy*cv*cG+cC*cv*cE+cy*cu*e-cC*cr*e)+cw*(-cA*cu*e-cD*ct*cG+cD*cu*cF+cA*cv*cG-cC*cv*cF+cC*ct*e))},transpose:function(){var cr=this.elements;var e;e=cr[1];cr[1]=cr[4];cr[4]=e;e=cr[2];cr[2]=cr[8];cr[8]=e;e=cr[6];cr[6]=cr[9];cr[9]=e;e=cr[3];cr[3]=cr[12];cr[12]=e;e=cr[7];cr[7]=cr[13];cr[13]=e;e=cr[11];cr[11]=cr[14];cr[14]=e;return this},flattenToArray:function(cr){var e=this.elements;cr[0]=e[0];cr[1]=e[1];cr[2]=e[2];cr[3]=e[3];cr[4]=e[4];cr[5]=e[5];cr[6]=e[6];cr[7]=e[7];cr[8]=e[8];cr[9]=e[9];cr[10]=e[10];cr[11]=e[11];cr[12]=e[12];cr[13]=e[13];cr[14]=e[14];cr[15]=e[15];return cr},flattenToArrayOffset:function(cs,cr){var e=this.elements;cs[cr]=e[0];cs[cr+1]=e[1];cs[cr+2]=e[2];cs[cr+3]=e[3];cs[cr+4]=e[4];cs[cr+5]=e[5];cs[cr+6]=e[6];cs[cr+7]=e[7];cs[cr+8]=e[8];cs[cr+9]=e[9];cs[cr+10]=e[10];cs[cr+11]=e[11];cs[cr+12]=e[12];cs[cr+13]=e[13];cs[cr+14]=e[14];cs[cr+15]=e[15];return cs},getPosition:function(){var e=new aH.Vector3();return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var cr=this.elements;return e.set(cr[12],cr[13],cr[14])}}(),setPosition:function(e){var cr=this.elements;cr[12]=e.x;cr[13]=e.y;cr[14]=e.z;return this},getInverse:function(cG,cx){var cw=this.elements;var cL=cG.elements;var cE=cL[0],cC=cL[4],cA=cL[8],cy=cL[12];var cK=cL[1],cJ=cL[5],cI=cL[9],cH=cL[13];var ct=cL[2],cs=cL[6],cr=cL[10],e=cL[14];var cF=cL[3],cD=cL[7],cB=cL[11],cz=cL[15];cw[0]=cI*e*cD-cH*cr*cD+cH*cs*cB-cJ*e*cB-cI*cs*cz+cJ*cr*cz;cw[4]=cy*cr*cD-cA*e*cD-cy*cs*cB+cC*e*cB+cA*cs*cz-cC*cr*cz;cw[8]=cA*cH*cD-cy*cI*cD+cy*cJ*cB-cC*cH*cB-cA*cJ*cz+cC*cI*cz;cw[12]=cy*cI*cs-cA*cH*cs-cy*cJ*cr+cC*cH*cr+cA*cJ*e-cC*cI*e;cw[1]=cH*cr*cF-cI*e*cF-cH*ct*cB+cK*e*cB+cI*ct*cz-cK*cr*cz;cw[5]=cA*e*cF-cy*cr*cF+cy*ct*cB-cE*e*cB-cA*ct*cz+cE*cr*cz;cw[9]=cy*cI*cF-cA*cH*cF-cy*cK*cB+cE*cH*cB+cA*cK*cz-cE*cI*cz;cw[13]=cA*cH*ct-cy*cI*ct+cy*cK*cr-cE*cH*cr-cA*cK*e+cE*cI*e;cw[2]=cJ*e*cF-cH*cs*cF+cH*ct*cD-cK*e*cD-cJ*ct*cz+cK*cs*cz;cw[6]=cy*cs*cF-cC*e*cF-cy*ct*cD+cE*e*cD+cC*ct*cz-cE*cs*cz;cw[10]=cC*cH*cF-cy*cJ*cF+cy*cK*cD-cE*cH*cD-cC*cK*cz+cE*cJ*cz;cw[14]=cy*cJ*ct-cC*cH*ct-cy*cK*cs+cE*cH*cs+cC*cK*e-cE*cJ*e;cw[3]=cI*cs*cF-cJ*cr*cF-cI*ct*cD+cK*cr*cD+cJ*ct*cB-cK*cs*cB;cw[7]=cC*cr*cF-cA*cs*cF+cA*ct*cD-cE*cr*cD-cC*ct*cB+cE*cs*cB;cw[11]=cA*cJ*cF-cC*cI*cF-cA*cK*cD+cE*cI*cD+cC*cK*cB-cE*cJ*cB;cw[15]=cC*cI*ct-cA*cJ*ct+cA*cK*cs-cE*cI*cs-cC*cK*cr+cE*cJ*cr;var cu=cL[0]*cw[0]+cL[1]*cw[4]+cL[2]*cw[8]+cL[3]*cw[12];if(cu==0){var cv="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(cx||false){throw new Error(cv)}else{console.warn(cv)}this.identity();return this}this.multiplyScalar(1/cu);return this},translate:function(e){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(e){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(e){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(e){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(e,cr){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(cr){var ct=this.elements;var e=cr.x,cu=cr.y,cs=cr.z;ct[0]*=e;ct[4]*=cu;ct[8]*=cs;ct[1]*=e;ct[5]*=cu;ct[9]*=cs;ct[2]*=e;ct[6]*=cu;ct[10]*=cs;ct[3]*=e;ct[7]*=cu;ct[11]*=cs;return this},getMaxScaleOnAxis:function(){var cs=this.elements;var ct=cs[0]*cs[0]+cs[1]*cs[1]+cs[2]*cs[2];var cr=cs[4]*cs[4]+cs[5]*cs[5]+cs[6]*cs[6];var e=cs[8]*cs[8]+cs[9]*cs[9]+cs[10]*cs[10];return Math.sqrt(Math.max(ct,Math.max(cr,e)))},makeTranslation:function(e,cs,cr){this.set(1,0,0,e,0,1,0,cs,0,0,1,cr,0,0,0,1);return this},makeRotationX:function(e){var cs=Math.cos(e),cr=Math.sin(e);this.set(1,0,0,0,0,cs,-cr,0,0,cr,cs,0,0,0,0,1);return this},makeRotationY:function(e){var cs=Math.cos(e),cr=Math.sin(e);this.set(cs,0,cr,0,0,1,0,0,-cr,0,cs,0,0,0,0,1);return this},makeRotationZ:function(e){var cs=Math.cos(e),cr=Math.sin(e);this.set(cs,-cr,0,0,cr,cs,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,cr){var cu=Math.cos(cr);var cz=Math.sin(cr);var cy=1-cu;var cx=e.x,cw=e.y,cv=e.z;var ct=cy*cx,cs=cy*cw;this.set(ct*cx+cu,ct*cw-cz*cv,ct*cv+cz*cw,0,ct*cw+cz*cv,cs*cw+cu,cs*cv-cz*cx,0,ct*cv-cz*cw,cs*cv+cz*cx,cy*cv*cv+cu,0,0,0,0,1);return this},makeScale:function(e,cs,cr){this.set(e,0,0,0,0,cs,0,0,0,0,cr,0,0,0,0,1);return this},compose:function(e,cr,cs){console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code.");return this.makeFromPositionQuaternionScale(e,cr,cs)},makeFromPositionQuaternionScale:function(e,cr,cs){this.makeRotationFromQuaternion(cr);this.scale(cs);this.setPosition(e);return this},makeFromPositionEulerScale:function(e,cr,ct,cs){this.makeRotationFromEuler(cr,ct);this.scale(cs);this.setPosition(e);return this},makeFrustum:function(cs,cC,e,cz,cu,ct){var cr=this.elements;var cB=2*cu/(cC-cs);var cy=2*cu/(cz-e);var cA=(cC+cs)/(cC-cs);var cx=(cz+e)/(cz-e);var cw=-(ct+cu)/(ct-cu);var cv=-2*ct*cu/(ct-cu);cr[0]=cB;cr[4]=0;cr[8]=cA;cr[12]=0;cr[1]=0;cr[5]=cy;cr[9]=cx;cr[13]=0;cr[2]=0;cr[6]=0;cr[10]=cw;cr[14]=cv;cr[3]=0;cr[7]=0;cr[11]=-1;cr[15]=0;return this},makePerspective:function(cu,cs,cw,cr){var e=cw*Math.tan(aH.Math.degToRad(cu*0.5));var cv=-e;var cx=cv*cs;var ct=e*cs;return this.makeFrustum(cx,ct,cv,e,cw,cr)},makeOrthographic:function(ct,cC,cz,e,cw,cv){var cs=this.elements;var cB=cC-ct;var cu=cz-e;var cr=cv-cw;var cA=(cC+ct)/cB;var cy=(cz+e)/cu;var cx=(cv+cw)/cr;cs[0]=2/cB;cs[4]=0;cs[8]=0;cs[12]=-cA;cs[1]=0;cs[5]=2/cu;cs[9]=0;cs[13]=-cy;cs[2]=0;cs[6]=0;cs[10]=-2/cr;cs[14]=-cx;cs[3]=0;cs[7]=0;cs[11]=0;cs[15]=1;return this},clone:function(){var e=this.elements;return new aH.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}};aH.extend(aH.Matrix4.prototype,{decompose:function(){var e=new aH.Vector3();var ct=new aH.Vector3();var cs=new aH.Vector3();var cr=new aH.Matrix4();return function(cu,cv,cx){var cw=this.elements;e.set(cw[0],cw[1],cw[2]);ct.set(cw[4],cw[5],cw[6]);cs.set(cw[8],cw[9],cw[10]);cu=(cu instanceof aH.Vector3)?cu:new aH.Vector3();cv=(cv instanceof aH.Quaternion)?cv:new aH.Quaternion();cx=(cx instanceof aH.Vector3)?cx:new aH.Vector3();cx.x=e.length();cx.y=ct.length();cx.z=cs.length();cu.x=cw[12];cu.y=cw[13];cu.z=cw[14];cr.copy(this);cr.elements[0]/=cx.x;cr.elements[1]/=cx.x;cr.elements[2]/=cx.x;cr.elements[4]/=cx.y;cr.elements[5]/=cx.y;cr.elements[6]/=cx.y;cr.elements[8]/=cx.z;cr.elements[9]/=cx.z;cr.elements[10]/=cx.z;cv.setFromRotationMatrix(cr);return[cu,cv,cx]}}()});aH.Ray=function(e,cr){this.origin=(e!==undefined)?e:new aH.Vector3();this.direction=(cr!==undefined)?cr:new aH.Vector3()};aH.Ray.prototype={constructor:aH.Ray,set:function(e,cr){this.origin.copy(e);this.direction.copy(cr);return this},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(cs,cr){var e=cr||new aH.Vector3();return e.copy(this.direction).multiplyScalar(cs).add(this.origin)},recast:function(){var e=new aH.Vector3();return function(cr){this.origin.copy(this.at(cr,e));return this}}(),closestPointToPoint:function(cr,cs){var e=cs||new aH.Vector3();e.subVectors(cr,this.origin);var ct=e.dot(this.direction);return e.copy(this.direction).multiplyScalar(ct).add(this.origin)},distanceToPoint:function(){var e=new aH.Vector3();return function(cr){var cs=e.subVectors(cr,this.origin).dot(this.direction);e.copy(this.direction).multiplyScalar(cs).add(this.origin);return e.distanceTo(cr)}}(),isIntersectionSphere:function(e){return(this.distanceToPoint(e.center)<=e.radius)},isIntersectionPlane:function(e){var cr=e.normal.dot(this.direction);if(cr!=0){return true}if(e.distanceToPoint(this.origin)==0){return true}return false},distanceToPlane:function(e){var cs=e.normal.dot(this.direction);if(cs==0){if(e.distanceToPoint(this.origin)==0){return 0}return undefined}var cr=-(this.origin.dot(e.normal)+e.constant)/cs;return cr},intersectPlane:function(e,cs){var cr=this.distanceToPlane(e);if(cr===undefined){return undefined}return this.at(cr,cs)},applyMatrix4:function(e){this.direction.add(this.origin).applyMatrix4(e);this.origin.applyMatrix4(e);this.direction.sub(this.origin);return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return new aH.Ray().copy(this)}};aH.Sphere=function(cr,e){this.center=(cr!==undefined)?cr:new aH.Vector3();this.radius=(e!==undefined)?e:0};aH.Sphere.prototype={constructor:aH.Sphere,set:function(cr,e){this.center.copy(cr);this.radius=e;return this},setFromCenterAndPoints:function(e,cv){var cr=0;for(var cu=0,cs=cv.length;cu<cs;cu++){var ct=e.distanceToSquared(cv[cu]);cr=Math.max(cr,ct)}this.center=e;this.radius=Math.sqrt(cr);return this},copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return(this.radius<=0)},containsPoint:function(e){return(e.distanceToSquared(this.center)<=(this.radius*this.radius))},distanceToPoint:function(e){return(e.distanceTo(this.center)-this.radius)},intersectsSphere:function(e){var cr=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=(cr*cr)},clampPoint:function(cr,ct){var cs=this.center.distanceToSquared(cr);var e=ct||new aH.Vector3();e.copy(cr);if(cs>(this.radius*this.radius)){e.sub(this.center).normalize();e.multiplyScalar(this.radius).add(this.center)}return e},getBoundingBox:function(e){var cr=e||new aH.Box3();cr.set(this.center,this.center);cr.expandByScalar(this.radius);return cr},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&(e.radius===this.radius)},clone:function(){return new aH.Sphere().copy(this)}};aH.Frustum=function(cv,cu,ct,cs,cr,e){this.planes=[(cv!==undefined)?cv:new aH.Plane(),(cu!==undefined)?cu:new aH.Plane(),(ct!==undefined)?ct:new aH.Plane(),(cs!==undefined)?cs:new aH.Plane(),(cr!==undefined)?cr:new aH.Plane(),(e!==undefined)?e:new aH.Plane()]};aH.Frustum.prototype={constructor:aH.Frustum,set:function(cw,cv,cu,ct,cs,cr){var e=this.planes;e[0].copy(cw);e[1].copy(cv);e[2].copy(cu);e[3].copy(ct);e[4].copy(cs);e[5].copy(cr);return this},copy:function(cs){var e=this.planes;for(var cr=0;cr<6;cr++){e[cr].copy(cs.planes[cr])}return this},setFromMatrix:function(cD){var cx=this.planes;var cI=cD.elements;var cB=cI[0],cz=cI[1],cy=cI[2],cw=cI[3];var cv=cI[4],cu=cI[5],ct=cI[6],cs=cI[7];var cr=cI[8],e=cI[9],cH=cI[10],cG=cI[11];var cF=cI[12],cE=cI[13],cC=cI[14],cA=cI[15];cx[0].setComponents(cw-cB,cs-cv,cG-cr,cA-cF).normalize();cx[1].setComponents(cw+cB,cs+cv,cG+cr,cA+cF).normalize();cx[2].setComponents(cw+cz,cs+cu,cG+e,cA+cE).normalize();cx[3].setComponents(cw-cz,cs-cu,cG-e,cA-cE).normalize();cx[4].setComponents(cw-cy,cs-ct,cG-cH,cA-cC).normalize();cx[5].setComponents(cw+cy,cs+ct,cG+cH,cA+cC).normalize();return this},intersectsObject:function(){var e=new aH.Vector3();return function(cu){var cs=cu.matrixWorld;var ct=this.planes;var cr=-cu.geometry.boundingSphere.radius*cs.getMaxScaleOnAxis();e.getPositionFromMatrix(cs);for(var cv=0;cv<6;cv++){var cw=ct[cv].distanceToPoint(e);if(cw<cr){return false}}return true}}(),intersectsSphere:function(cs){var ct=this.planes;var e=cs.center;var cr=-cs.radius;for(var cu=0;cu<6;cu++){var cv=ct[cu].distanceToPoint(e);if(cv<cr){return false}}return true},containsPoint:function(e){var cr=this.planes;for(var cs=0;cs<6;cs++){if(cr[cs].distanceToPoint(e)<0){return false}}return true},clone:function(){return new aH.Frustum().copy(this)}};aH.Plane=function(cr,e){this.normal=(cr!==undefined)?cr:new aH.Vector3(1,0,0);this.constant=(e!==undefined)?e:0};aH.Plane.prototype={constructor:aH.Plane,set:function(cr,e){this.normal.copy(cr);this.constant=e;return this},setComponents:function(e,ct,cs,cr){this.normal.set(e,ct,cs);this.constant=cr;return this},setFromNormalAndCoplanarPoint:function(cr,e){this.normal.copy(cr);this.constant=-e.dot(this.normal);return this},setFromCoplanarPoints:function(){var cr=new aH.Vector3();var e=new aH.Vector3();return function(ct,cs,cv){var cu=cr.subVectors(cv,cs).cross(e.subVectors(ct,cs)).normalize();this.setFromNormalAndCoplanarPoint(cu,ct);return this}}(),copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,cr){return this.orthoPoint(e,cr).sub(e).negate()},orthoPoint:function(cr,ct){var cs=this.distanceToPoint(cr);var e=ct||new aH.Vector3();return e.copy(this.normal).multiplyScalar(cs)},isIntersectionLine:function(e){var cs=this.distanceToPoint(e.start);var cr=this.distanceToPoint(e.end);return(cs<0&&cr>0)||(cr<0&&cs>0)},intersectLine:function(){var e=new aH.Vector3();return function(cs,cu){var cr=cu||new aH.Vector3();var cv=cs.delta(e);var cw=this.normal.dot(cv);if(cw==0){if(this.distanceToPoint(cs.start)==0){return cr.copy(cs.start)}return undefined}var ct=-(cs.start.dot(this.normal)+this.constant)/cw;if(ct<0||ct>1){return undefined}return cr.copy(cv).multiplyScalar(ct).add(cs.start)}}(),coplanarPoint:function(cr){var e=cr||new aH.Vector3();return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var cr=new aH.Vector3();var e=new aH.Vector3();return function(ct,cu){cu=cu||new aH.Matrix3().getNormalMatrix(ct);var cv=cr.copy(this.normal).applyMatrix3(cu);var cs=this.coplanarPoint(e);cs.applyMatrix4(ct);this.setFromNormalAndCoplanarPoint(cv,cs);return this}}(),translate:function(e){this.constant=this.constant-e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&(e.constant==this.constant)},clone:function(){return new aH.Plane().copy(this)}};aH.Math={clamp:function(cr,cs,e){return(cr<cs)?cs:((cr>e)?e:cr)},clampBottom:function(e,cr){return e<cr?cr:e},mapLinear:function(cr,cs,e,cu,ct){return cu+(cr-cs)*(ct-cu)/(e-cs)},smoothstep:function(cr,cs,e){if(cr<=cs){return 0}if(cr>=e){return 1}cr=(cr-cs)/(e-cs);return cr*cr*(3-2*cr)},smootherstep:function(cr,cs,e){if(cr<=cs){return 0}if(cr>=e){return 1}cr=(cr-cs)/(e-cs);return cr*cr*cr*(cr*(cr*6-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,cr){return e+Math.floor(Math.random()*(cr-e+1))},randFloat:function(e,cr){return e+Math.random()*(cr-e)},randFloatSpread:function(e){return e*(0.5-Math.random())},sign:function(e){return(e<0)?-1:((e>0)?1:0)},degToRad:function(){var e=Math.PI/180;return function(cr){return cr*e}}(),radToDeg:function(){var e=180/Math.PI;return function(cr){return cr*e}}()};aH.Spline=function(cC){this.points=cC;var cw=[],cy={x:0,y:0,z:0},cB,e,ct,cs,cr,cA,cz,cx,cv;this.initFromArray=function(cD){this.points=[];for(var cE=0;cE<cD.length;cE++){this.points[cE]={x:cD[cE][0],y:cD[cE][1],z:cD[cE][2]}}};this.getPoint=function(cD){cB=(this.points.length-1)*cD;e=Math.floor(cB);ct=cB-e;cw[0]=e===0?e:e-1;cw[1]=e;cw[2]=e>this.points.length-2?this.points.length-1:e+1;cw[3]=e>this.points.length-3?this.points.length-1:e+2;cA=this.points[cw[0]];cz=this.points[cw[1]];cx=this.points[cw[2]];cv=this.points[cw[3]];cs=ct*ct;cr=ct*cs;cy.x=cu(cA.x,cz.x,cx.x,cv.x,ct,cs,cr);cy.y=cu(cA.y,cz.y,cx.y,cv.y,ct,cs,cr);cy.z=cu(cA.z,cz.z,cx.z,cv.z,ct,cs,cr);return cy};this.getControlPointsArray=function(){var cE,cG,cD=this.points.length,cF=[];for(cE=0;cE<cD;cE++){cG=this.points[cE];cF[cE]=[cG.x,cG.y,cG.z]}return cF};this.getLength=function(cF){var cH,cJ,cK,cI,cN=0,cD=0,cG=0,cM=new aH.Vector3(),cE=new aH.Vector3(),cL=[],cO=0;cL[0]=0;if(!cF){cF=100}cK=this.points.length*cF;cM.copy(this.points[0]);for(cH=1;cH<cK;cH++){cJ=cH/cK;cI=this.getPoint(cJ);cE.copy(cI);cO+=cE.distanceTo(cM);cM.copy(cI);cN=(this.points.length-1)*cJ;cD=Math.floor(cN);if(cD!=cG){cL[cD]=cO;cG=cD}}cL[cL.length]=cO;return{chunks:cL,total:cO}};this.reparametrizeByArcLength=function(cF){var cJ,cI,cM,cN,cG,cE,cO,cL,cK,cP=[],cD=new aH.Vector3(),cH=this.getLength();cP.push(cD.copy(this.points[0]).clone());for(cJ=1;cJ<this.points.length;cJ++){cO=cH.chunks[cJ]-cH.chunks[cJ-1];cL=Math.ceil(cF*cO/cH.total);cN=(cJ-1)/(this.points.length-1);cG=cJ/(this.points.length-1);for(cI=1;cI<cL-1;cI++){cM=cN+cI*(1/cL)*(cG-cN);cK=this.getPoint(cM);cP.push(cD.copy(cK).clone())}cP.push(cD.copy(this.points[cJ]).clone())}this.points=cP};function cu(cK,cJ,cH,cG,cL,cE,cD){var cI=(cH-cK)*0.5,cF=(cG-cJ)*0.5;return(2*(cJ-cH)+cI+cF)*cD+(-3*(cJ-cH)-2*cI-cF)*cE+cI*cL+cJ}};aH.Triangle=function(cr,e,cs){this.a=(cr!==undefined)?cr:new aH.Vector3();this.b=(e!==undefined)?e:new aH.Vector3();this.c=(cs!==undefined)?cs:new aH.Vector3()};aH.Triangle.normal=function(){var e=new aH.Vector3();return function(cu,cs,cw,cv){var cr=cv||new aH.Vector3();cr.subVectors(cw,cs);e.subVectors(cu,cs);cr.cross(e);var ct=cr.lengthSq();if(ct>0){return cr.multiplyScalar(1/Math.sqrt(ct))}return cr.set(0,0,0)}}();aH.Triangle.barycoordFromPoint=function(){var e=new aH.Vector3();var cs=new aH.Vector3();var cr=new aH.Vector3();return function(cD,cC,cA,cx,cH){e.subVectors(cx,cC);cs.subVectors(cA,cC);cr.subVectors(cD,cC);var cB=e.dot(e);var cz=e.dot(cs);var cy=e.dot(cr);var cv=cs.dot(cs);var ct=cs.dot(cr);var cw=(cB*cv-cz*cz);var cG=cH||new aH.Vector3();if(cw==0){return cG.set(-2,-1,-1)}var cu=1/cw;var cF=(cv*cy-cz*ct)*cu;var cE=(cB*ct-cz*cy)*cu;return cG.set(1-cF-cE,cE,cF)}}();aH.Triangle.containsPoint=function(){var e=new aH.Vector3();return function(ct,cu,cs,cv){var cr=aH.Triangle.barycoordFromPoint(ct,cu,cs,cv,e);return(cr.x>=0)&&(cr.y>=0)&&((cr.x+cr.y)<=1)}}();aH.Triangle.prototype={constructor:aH.Triangle,set:function(cr,e,cs){this.a.copy(cr);this.b.copy(e);this.c.copy(cs);return this},setFromPointsAndIndices:function(cr,ct,cs,e){this.a.copy(cr[ct]);this.b.copy(cr[cs]);this.c.copy(cr[e]);return this},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},area:function(){var e=new aH.Vector3();var cr=new aH.Vector3();return function(){e.subVectors(this.c,this.b);cr.subVectors(this.a,this.b);return e.cross(cr).length()*0.5}}(),midpoint:function(cr){var e=cr||new aH.Vector3();return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return aH.Triangle.normal(this.a,this.b,this.c,e)},plane:function(cr){var e=cr||new aH.Plane();return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,cr){return aH.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,cr)},containsPoint:function(e){return aH.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return new aH.Triangle().copy(this)}};aH.Vertex=function(e){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return e};aH.UV=function(cr,e){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new aH.Vector2(cr,e)};aH.EventDispatcher=function(){};aH.EventDispatcher.prototype={constructor:aH.EventDispatcher,addEventListener:function(cr,cs){if(this._listeners===undefined){this._listeners={}}var e=this._listeners;if(e[cr]===undefined){e[cr]=[]}if(e[cr].indexOf(cs)===-1){e[cr].push(cs)}},hasEventListener:function(cr,cs){if(this._listeners===undefined){return false}var e=this._listeners;if(e[cr]!==undefined&&e[cr].indexOf(cs)!==-1){return true}return false},removeEventListener:function(cs,ct){if(this._listeners===undefined){return}var cr=this._listeners;var e=cr[cs].indexOf(ct);if(e!==-1){cr[cs].splice(e,1)}},dispatchEvent:function(cu){if(this._listeners===undefined){return}var ct=this._listeners;var e=ct[cu.type];if(e!==undefined){cu.target=this;for(var cs=0,cr=e.length;cs<cr;cs++){e[cs].call(this,cu)}}}};(function(cv){cv.Raycaster=function(cB,cD,cC,cA){this.ray=new cv.Ray(cB,cD);if(this.ray.direction.lengthSq()>0){this.ray.direction.normalize()}this.near=cC||0;this.far=cA||Infinity};var cr=new cv.Sphere();var cs=new cv.Ray();var cw=new cv.Plane();var cy=new cv.Vector3();var cu=new cv.Vector3();var cx=new cv.Matrix4();var e=function(cB,cA){return cB.distance-cA.distance};var ct=function(cT,cK,cB){if(cT instanceof cv.Particle){cu.getPositionFromMatrix(cT.matrixWorld);var cE=cK.ray.distanceToPoint(cu);if(cE>cT.scale.x){return cB}cB.push({distance:cE,point:cT.position,face:null,object:cT})}else{if(cT instanceof cv.LOD){cu.getPositionFromMatrix(cT.matrixWorld);var cE=cK.ray.origin.distanceTo(cu);ct(cT.getObjectForDistance(cE),cK,cB)}else{if(cT instanceof cv.Mesh){cu.getPositionFromMatrix(cT.matrixWorld);cr.set(cu,cT.geometry.boundingSphere.radius*cT.matrixWorld.getMaxScaleOnAxis());if(!cK.ray.isIntersectionSphere(cr)){return cB}var cF=cT.geometry;var cG=cF.vertices;var cD=cT.material instanceof cv.MeshFaceMaterial;var cL=cD===true?cT.material.materials:null;var cC=cT.material.side;var cS,cQ,cP,cO;var cM=cK.precision;cx.getInverse(cT.matrixWorld);cs.copy(cK.ray).applyMatrix4(cx);for(var cN=0,cI=cF.faces.length;cN<cI;cN++){var cH=cF.faces[cN];var cJ=cD===true?cL[cH.materialIndex]:cT.material;if(cJ===undefined){continue}cw.setFromNormalAndCoplanarPoint(cH.normal,cG[cH.a]);var cR=cs.distanceToPlane(cw);if(Math.abs(cR)<cM){continue}if(cR<0){continue}cC=cJ.side;if(cC!==cv.DoubleSide){var cA=cs.direction.dot(cw.normal);if(!(cC===cv.FrontSide?cA<0:cA>0)){continue}}if(cR<cK.near||cR>cK.far){continue}cy=cs.at(cR,cy);if(cH instanceof cv.Face3){cS=cG[cH.a];cQ=cG[cH.b];cP=cG[cH.c];if(!cv.Triangle.containsPoint(cy,cS,cQ,cP)){continue}}else{if(cH instanceof cv.Face4){cS=cG[cH.a];cQ=cG[cH.b];cP=cG[cH.c];cO=cG[cH.d];if((!cv.Triangle.containsPoint(cy,cS,cQ,cO))&&(!cv.Triangle.containsPoint(cy,cQ,cP,cO))){continue}}else{throw Error("face type not supported")}}cB.push({distance:cR,point:cK.ray.at(cR),face:cH,faceIndex:cN,object:cT})}}}}};var cz=function(cC,cB,cE){var cF=cC.getDescendants();for(var cD=0,cA=cF.length;cD<cA;cD++){ct(cF[cD],cB,cE)}};cv.Raycaster.prototype.precision=0.0001;cv.Raycaster.prototype.set=function(cA,cB){this.ray.set(cA,cB);if(this.ray.direction.length()>0){this.ray.direction.normalize()}};cv.Raycaster.prototype.intersectObject=function(cB,cA){var cC=[];if(cA===true){cz(cB,this,cC)}ct(cB,this,cC);cC.sort(e);return cC};cv.Raycaster.prototype.intersectObjects=function(cE,cB){var cD=[];for(var cC=0,cA=cE.length;cC<cA;cC++){ct(cE[cC],this,cD);if(cB===true){cz(cE[cC],this,cD)}}cD.sort(e);return cD}}(aH));aH.Object3D=function(){this.id=aH.Object3DIdCount++;this.name="";this.parent=undefined;this.children=[];this.up=new aH.Vector3(0,1,0);this.position=new aH.Vector3();this.rotation=new aH.Vector3();this.eulerOrder=aH.Object3D.defaultEulerOrder;this.scale=new aH.Vector3(1,1,1);this.renderDepth=null;this.rotationAutoUpdate=true;this.matrix=new aH.Matrix4();this.matrixWorld=new aH.Matrix4();this.matrixAutoUpdate=true;this.matrixWorldNeedsUpdate=true;this.quaternion=new aH.Quaternion();this.useQuaternion=false;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.userData={}};aH.Object3D.prototype={constructor:aH.Object3D,applyMatrix:function(){var e=new aH.Matrix4();return function(cr){this.matrix.multiplyMatrices(cr,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);e.extractRotation(this.matrix);if(this.useQuaternion===true){this.quaternion.setFromRotationMatrix(e)}else{this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}}(),rotateOnAxis:function(){var e=new aH.Quaternion();var cr=new aH.Quaternion();return function(cs,ct){e.setFromAxisAngle(cs,ct);if(this.useQuaternion===true){this.quaternion.multiply(e)}else{cr.setFromEuler(this.rotation,this.eulerOrder);cr.multiply(e);this.rotation.setEulerFromQuaternion(cr,this.eulerOrder)}return this}}(),translateOnAxis:function(){var e=new aH.Vector3();return function(cr,cs){e.copy(cr);if(this.useQuaternion===true){e.applyQuaternion(this.quaternion)}else{e.applyEuler(this.rotation,this.eulerOrder)}this.position.add(e.multiplyScalar(cs));return this}}(),translate:function(cr,e){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(e,cr)},translateX:function(){var e=new aH.Vector3(1,0,0);return function(cr){return this.translateOnAxis(e,cr)}}(),translateY:function(){var e=new aH.Vector3(0,1,0);return function(cr){return this.translateOnAxis(e,cr)}}(),translateZ:function(){var e=new aH.Vector3(0,0,1);return function(cr){return this.translateOnAxis(e,cr)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new aH.Matrix4();return function(cr){return cr.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new aH.Matrix4();return function(cr){e.lookAt(cr,this.position,this.up);if(this.useQuaternion===true){this.quaternion.setFromRotationMatrix(e)}else{this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}}(),add:function(e){if(e===this){console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");return}if(e instanceof aH.Object3D){if(e.parent!==undefined){e.parent.remove(e)}e.parent=this;this.children.push(e);var cr=this;while(cr.parent!==undefined){cr=cr.parent}if(cr!==undefined&&cr instanceof aH.Scene){cr.__addObject(e)}}},remove:function(cr){var e=this.children.indexOf(cr);if(e!==-1){cr.parent=undefined;this.children.splice(e,1);var cs=this;while(cs.parent!==undefined){cs=cs.parent}if(cs!==undefined&&cs instanceof aH.Scene){cs.__removeObject(cr)}}},traverse:function(cs){cs(this);for(var cr=0,e=this.children.length;cr<e;cr++){this.children[cr].traverse(cs)}},getObjectById:function(cu,cr){for(var cs=0,e=this.children.length;cs<e;cs++){var ct=this.children[cs];if(ct.id===cu){return ct}if(cr===true){ct=ct.getObjectById(cu,cr);if(ct!==undefined){return ct}}}return undefined},getObjectByName:function(cs,cr){for(var ct=0,e=this.children.length;ct<e;ct++){var cu=this.children[ct];if(cu.name===cs){return cu}if(cr===true){cu=cu.getObjectByName(cs,cr);if(cu!==undefined){return cu}}}return undefined},getChildByName:function(cr,e){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(cr,e)},getDescendants:function(cs){if(cs===undefined){cs=[]}Array.prototype.push.apply(cs,this.children);for(var cr=0,e=this.children.length;cr<e;cr++){this.children[cr].getDescendants(cs)}return cs},updateMatrix:function(){if(this.useQuaternion===false){this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale)}else{this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale)}this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(cs){if(this.matrixAutoUpdate===true){this.updateMatrix()}if(this.matrixWorldNeedsUpdate===true||cs===true){if(this.parent===undefined){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}this.matrixWorldNeedsUpdate=false;cs=true}for(var cr=0,e=this.children.length;cr<e;cr++){this.children[cr].updateMatrixWorld(cs)}},clone:function(e){if(e===undefined){e=new aH.Object3D()}e.name=this.name;e.up.copy(this.up);e.position.copy(this.position);if(e.rotation instanceof aH.Vector3){e.rotation.copy(this.rotation)}e.eulerOrder=this.eulerOrder;e.scale.copy(this.scale);e.renderDepth=this.renderDepth;e.rotationAutoUpdate=this.rotationAutoUpdate;e.matrix.copy(this.matrix);e.matrixWorld.copy(this.matrixWorld);e.matrixAutoUpdate=this.matrixAutoUpdate;e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;e.quaternion.copy(this.quaternion);e.useQuaternion=this.useQuaternion;e.visible=this.visible;e.castShadow=this.castShadow;e.receiveShadow=this.receiveShadow;e.frustumCulled=this.frustumCulled;e.userData=JSON.parse(JSON.stringify(this.userData));for(var cr=0;cr<this.children.length;cr++){var cs=this.children[cr];e.add(cs.clone())}return e}};aH.Object3D.defaultEulerOrder="XYZ",aH.Object3DIdCount=0;aH.Projector=function(){var db,cV,c2=[],cD=0,cP,cs,cu=[],cr=0,cz,c4,c1=[],cy=0,cG,cK=[],cR=0,cx,c8,da=[],cN=0,c5,cF,cM=[],c0=0,cY={objects:[],sprites:[],lights:[],elements:[]},cZ=new aH.Vector3(),cX=new aH.Vector4(),cJ=new aH.Box3(new aH.Vector3(-1,-1,-1),new aH.Vector3(1,1,1)),dc=new aH.Box3(),c7=new Array(3),c6=new Array(4),e=new aH.Matrix4(),cv=new aH.Matrix4(),cS,cU=new aH.Matrix4(),cH=new aH.Matrix3(),cE=new aH.Matrix3(),ct=new aH.Vector3(),c9=new aH.Frustum(),cL=new aH.Vector4(),cw=new aH.Vector4();this.projectVector=function(dd,de){de.matrixWorldInverse.getInverse(de.matrixWorld);cv.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse);return dd.applyProjection(cv)};this.unprojectVector=function(dd,de){de.projectionMatrixInverse.getInverse(de.projectionMatrix);cv.multiplyMatrices(de.matrixWorld,de.projectionMatrixInverse);return dd.applyProjection(cv)};this.pickingRay=function(de,df){de.z=-1;var dd=new aH.Vector3(de.x,de.y,1);this.unprojectVector(de,df);this.unprojectVector(dd,df);dd.sub(de).normalize();return new aH.Raycaster(de,dd)};var c3=function(dd,de){cV=0;cY.objects.length=0;cY.sprites.length=0;cY.lights.length=0;var df=function(di){for(var dj=0,dg=di.children.length;dj<dg;dj++){var dh=di.children[dj];if(dh.visible===false){continue}if(dh instanceof aH.Light){cY.lights.push(dh)}else{if(dh instanceof aH.Mesh||dh instanceof aH.Line){if(dh.frustumCulled===false||c9.intersectsObject(dh)===true){db=cC();db.object=dh;if(dh.renderDepth!==null){db.z=dh.renderDepth}else{cZ.getPositionFromMatrix(dh.matrixWorld);cZ.applyProjection(cv);db.z=cZ.z}cY.objects.push(db)}}else{if(dh instanceof aH.Sprite||dh instanceof aH.Particle){db=cC();db.object=dh;if(dh.renderDepth!==null){db.z=dh.renderDepth}else{cZ.getPositionFromMatrix(dh.matrixWorld);cZ.applyProjection(cv);db.z=cZ.z}cY.sprites.push(db)}else{db=cC();db.object=dh;if(dh.renderDepth!==null){db.z=dh.renderDepth}else{cZ.getPositionFromMatrix(dh.matrixWorld);cZ.applyProjection(cv);db.z=cZ.z}cY.objects.push(db)}}}df(dh)}};df(dd);if(de===true){cY.objects.sort(cI)}return cY};this.projectScene=function(dq,dm,dt,de){var dp=false,dC,dv,dA,dk,dF,ds,dD,dK,dI,dr,dB,dw,dz,dj,dd,di,dh,df,dx,dy,dN,dL,dJ,dH,dg,dn;c4=0;cG=0;c8=0;cF=0;cY.elements.length=0;if(dq.autoUpdate===true){dq.updateMatrixWorld()}if(dm.parent===undefined){dm.updateMatrixWorld()}e.copy(dm.matrixWorldInverse.getInverse(dm.matrixWorld));cv.multiplyMatrices(dm.projectionMatrix,e);cE.getNormalMatrix(e);c9.setFromMatrix(cv);cY=c3(dq,dt);for(dC=0,dv=cY.objects.length;dC<dv;dC++){dz=cY.objects[dC].object;cS=dz.matrixWorld;cs=0;if(dz instanceof aH.Mesh){dj=dz.geometry;dd=dj.vertices;di=dj.faces;dx=dj.faceVertexUvs;cH.getNormalMatrix(cS);dg=dz.material instanceof aH.MeshFaceMaterial;dn=dg===true?dz.material:null;for(dA=0,dk=dd.length;dA<dk;dA++){cP=cO();cP.positionWorld.copy(dd[dA]).applyMatrix4(cS);cP.positionScreen.copy(cP.positionWorld).applyMatrix4(cv);cP.positionScreen.x/=cP.positionScreen.w;cP.positionScreen.y/=cP.positionScreen.w;cP.positionScreen.z/=cP.positionScreen.w;cP.visible=!(cP.positionScreen.x<-1||cP.positionScreen.x>1||cP.positionScreen.y<-1||cP.positionScreen.y>1||cP.positionScreen.z<-1||cP.positionScreen.z>1)}for(dF=0,ds=di.length;dF<ds;dF++){dh=di[dF];var dE=dg===true?dn.materials[dh.materialIndex]:dz.material;if(dE===undefined){continue}var dl=dE.side;if(dh instanceof aH.Face3){dN=cu[dh.a];dL=cu[dh.b];dJ=cu[dh.c];c7[0]=dN.positionScreen;c7[1]=dL.positionScreen;c7[2]=dJ.positionScreen;if(dN.visible===true||dL.visible===true||dJ.visible===true||cJ.isIntersectionBox(dc.setFromPoints(c7))){dp=((dJ.positionScreen.x-dN.positionScreen.x)*(dL.positionScreen.y-dN.positionScreen.y)-(dJ.positionScreen.y-dN.positionScreen.y)*(dL.positionScreen.x-dN.positionScreen.x))<0;if(dl===aH.DoubleSide||dp===(dl===aH.FrontSide)){cz=cB();cz.v1.copy(dN);cz.v2.copy(dL);cz.v3.copy(dJ)}else{continue}}else{continue}}else{if(dh instanceof aH.Face4){dN=cu[dh.a];dL=cu[dh.b];dJ=cu[dh.c];dH=cu[dh.d];c6[0]=dN.positionScreen;c6[1]=dL.positionScreen;c6[2]=dJ.positionScreen;c6[3]=dH.positionScreen;if(dN.visible===true||dL.visible===true||dJ.visible===true||dH.visible===true||cJ.isIntersectionBox(dc.setFromPoints(c6))){dp=(dH.positionScreen.x-dN.positionScreen.x)*(dL.positionScreen.y-dN.positionScreen.y)-(dH.positionScreen.y-dN.positionScreen.y)*(dL.positionScreen.x-dN.positionScreen.x)<0||(dL.positionScreen.x-dJ.positionScreen.x)*(dH.positionScreen.y-dJ.positionScreen.y)-(dL.positionScreen.y-dJ.positionScreen.y)*(dH.positionScreen.x-dJ.positionScreen.x)<0;if(dl===aH.DoubleSide||dp===(dl===aH.FrontSide)){cz=cA();cz.v1.copy(dN);cz.v2.copy(dL);cz.v3.copy(dJ);cz.v4.copy(dH)}else{continue}}else{continue}}}cz.normalModel.copy(dh.normal);if(dp===false&&(dl===aH.BackSide||dl===aH.DoubleSide)){cz.normalModel.negate()}cz.normalModel.applyMatrix3(cH).normalize();cz.normalModelView.copy(cz.normalModel).applyMatrix3(cE);cz.centroidModel.copy(dh.centroid).applyMatrix4(cS);df=dh.vertexNormals;for(dD=0,dK=df.length;dD<dK;dD++){var dM=cz.vertexNormalsModel[dD];dM.copy(df[dD]);if(dp===false&&(dl===aH.BackSide||dl===aH.DoubleSide)){dM.negate()}dM.applyMatrix3(cH).normalize();var dG=cz.vertexNormalsModelView[dD];dG.copy(dM).applyMatrix3(cE)}cz.vertexNormalsLength=df.length;for(dI=0,dr=dx.length;dI<dr;dI++){dy=dx[dI][dF];if(dy===undefined){continue}for(dB=0,dw=dy.length;dB<dw;dB++){cz.uvs[dI][dB]=dy[dB]}}cz.color=dh.color;cz.material=dE;ct.copy(cz.centroidModel).applyProjection(cv);cz.z=ct.z;cY.elements.push(cz)}}else{if(dz instanceof aH.Line){cU.multiplyMatrices(cv,cS);dd=dz.geometry.vertices;dN=cO();dN.positionScreen.copy(dd[0]).applyMatrix4(cU);var du=dz.type===aH.LinePieces?2:1;for(dA=1,dk=dd.length;dA<dk;dA++){dN=cO();dN.positionScreen.copy(dd[dA]).applyMatrix4(cU);if((dA+1)%du>0){continue}dL=cu[cs-2];cL.copy(dN.positionScreen);cw.copy(dL.positionScreen);if(cQ(cL,cw)===true){cL.multiplyScalar(1/cL.w);cw.multiplyScalar(1/cw.w);cx=cW();cx.v1.positionScreen.copy(cL);cx.v2.positionScreen.copy(cw);cx.z=Math.max(cL.z,cw.z);cx.material=dz.material;if(dz.material.vertexColors===aH.VertexColors){cx.vertexColors[0].copy(dz.geometry.colors[dA]);cx.vertexColors[1].copy(dz.geometry.colors[dA-1])}cY.elements.push(cx)}}}}}for(dC=0,dv=cY.sprites.length;dC<dv;dC++){dz=cY.sprites[dC].object;cS=dz.matrixWorld;if(dz instanceof aH.Particle){cX.set(cS.elements[12],cS.elements[13],cS.elements[14],1);cX.applyMatrix4(cv);cX.z/=cX.w;if(cX.z>0&&cX.z<1){c5=cT();c5.object=dz;c5.x=cX.x/cX.w;c5.y=cX.y/cX.w;c5.z=cX.z;c5.rotation=dz.rotation.z;c5.scale.x=dz.scale.x*Math.abs(c5.x-(cX.x+dm.projectionMatrix.elements[0])/(cX.w+dm.projectionMatrix.elements[12]));c5.scale.y=dz.scale.y*Math.abs(c5.y-(cX.y+dm.projectionMatrix.elements[5])/(cX.w+dm.projectionMatrix.elements[13]));c5.material=dz.material;cY.elements.push(c5)}}}if(de===true){cY.elements.sort(cI)}return cY};function cC(){if(cV===cD){var dd=new aH.RenderableObject();c2.push(dd);cD++;cV++;return dd}return c2[cV++]}function cO(){if(cs===cr){var dd=new aH.RenderableVertex();cu.push(dd);cr++;cs++;return dd}return cu[cs++]}function cB(){if(c4===cy){var dd=new aH.RenderableFace3();c1.push(dd);cy++;c4++;return dd}return c1[c4++]}function cA(){if(cG===cR){var dd=new aH.RenderableFace4();cK.push(dd);cR++;cG++;return dd}return cK[cG++]}function cW(){if(c8===cN){var dd=new aH.RenderableLine();da.push(dd);cN++;c8++;return dd}return da[c8++]}function cT(){if(cF===c0){var dd=new aH.RenderableParticle();cM.push(dd);c0++;cF++;return dd}return cM[cF++]}function cI(de,dd){return dd.z-de.z}function cQ(dh,dg){var df=0,dk=1,di=dh.z+dh.w,de=dg.z+dg.w,dd=-dh.z+dh.w,dj=-dg.z+dg.w;if(di>=0&&de>=0&&dd>=0&&dj>=0){return true}else{if((di<0&&de<0)||(dd<0&&dj<0)){return false}else{if(di<0){df=Math.max(df,di/(di-de))}else{if(de<0){dk=Math.min(dk,di/(di-de))}}if(dd<0){df=Math.max(df,dd/(dd-dj))}else{if(dj<0){dk=Math.min(dk,dd/(dd-dj))}}if(dk<df){return false}else{dh.lerp(dg,df);dg.lerp(dh,1-dk);return true}}}}};aH.Face3=function(cs,cr,cv,cu,ct,e){this.a=cs;this.b=cr;this.c=cv;this.normal=cu instanceof aH.Vector3?cu:new aH.Vector3();this.vertexNormals=cu instanceof Array?cu:[];this.color=ct instanceof aH.Color?ct:new aH.Color();this.vertexColors=ct instanceof Array?ct:[];this.vertexTangents=[];this.materialIndex=e!==undefined?e:0;this.centroid=new aH.Vector3()};aH.Face3.prototype={constructor:aH.Face3,clone:function(){var cs=new aH.Face3(this.a,this.b,this.c);cs.normal.copy(this.normal);cs.color.copy(this.color);cs.centroid.copy(this.centroid);cs.materialIndex=this.materialIndex;var cr,e;for(cr=0,e=this.vertexNormals.length;cr<e;cr++){cs.vertexNormals[cr]=this.vertexNormals[cr].clone()}for(cr=0,e=this.vertexColors.length;cr<e;cr++){cs.vertexColors[cr]=this.vertexColors[cr].clone()}for(cr=0,e=this.vertexTangents.length;cr<e;cr++){cs.vertexTangents[cr]=this.vertexTangents[cr].clone()}return cs}};aH.Face4=function(cs,cr,cw,cv,cu,ct,e){this.a=cs;this.b=cr;this.c=cw;this.d=cv;this.normal=cu instanceof aH.Vector3?cu:new aH.Vector3();this.vertexNormals=cu instanceof Array?cu:[];this.color=ct instanceof aH.Color?ct:new aH.Color();this.vertexColors=ct instanceof Array?ct:[];this.vertexTangents=[];this.materialIndex=e!==undefined?e:0;this.centroid=new aH.Vector3()};aH.Face4.prototype={constructor:aH.Face4,clone:function(){var cs=new aH.Face4(this.a,this.b,this.c,this.d);cs.normal.copy(this.normal);cs.color.copy(this.color);cs.centroid.copy(this.centroid);cs.materialIndex=this.materialIndex;var cr,e;for(cr=0,e=this.vertexNormals.length;cr<e;cr++){cs.vertexNormals[cr]=this.vertexNormals[cr].clone()}for(cr=0,e=this.vertexColors.length;cr<e;cr++){cs.vertexColors[cr]=this.vertexColors[cr].clone()}for(cr=0,e=this.vertexTangents.length;cr<e;cr++){cs.vertexTangents[cr]=this.vertexTangents[cr].clone()}return cs}};aH.Geometry=function(){this.id=aH.GeometryIdCount++;this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=false;this.dynamic=true;this.verticesNeedUpdate=false;this.elementsNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.tangentsNeedUpdate=false;this.colorsNeedUpdate=false;this.lineDistancesNeedUpdate=false;this.buffersNeedUpdate=false};aH.Geometry.prototype={constructor:aH.Geometry,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(cr){var cx=new aH.Matrix3().getNormalMatrix(cr);for(var cu=0,e=this.vertices.length;cu<e;cu++){var cw=this.vertices[cu];cw.applyMatrix4(cr)}for(var cu=0,e=this.faces.length;cu<e;cu++){var cv=this.faces[cu];cv.normal.applyMatrix3(cx).normalize();for(var cs=0,ct=cv.vertexNormals.length;cs<ct;cs++){cv.vertexNormals[cs].applyMatrix3(cx).normalize()}cv.centroid.applyMatrix4(cr)}},computeCentroids:function(){var cs,cr,e;for(cs=0,cr=this.faces.length;cs<cr;cs++){e=this.faces[cs];e.centroid.set(0,0,0);if(e instanceof aH.Face3){e.centroid.add(this.vertices[e.a]);e.centroid.add(this.vertices[e.b]);e.centroid.add(this.vertices[e.c]);e.centroid.divideScalar(3)}else{if(e instanceof aH.Face4){e.centroid.add(this.vertices[e.a]);e.centroid.add(this.vertices[e.b]);e.centroid.add(this.vertices[e.c]);e.centroid.add(this.vertices[e.d]);e.centroid.divideScalar(4)}}}},computeFaceNormals:function(){var e=new aH.Vector3(),cx=new aH.Vector3();for(var cw=0,cv=this.faces.length;cw<cv;cw++){var cu=this.faces[cw];var ct=this.vertices[cu.a];var cs=this.vertices[cu.b];var cr=this.vertices[cu.c];e.subVectors(cr,cs);cx.subVectors(ct,cs);e.cross(cx);e.normalize();cu.normal.copy(e)}},computeVertexNormals:function(cv){var cB,ct,cw,cA,cz,cy;if(this.__tmpVertices===undefined){this.__tmpVertices=new Array(this.vertices.length);cy=this.__tmpVertices;for(cB=0,ct=this.vertices.length;cB<ct;cB++){cy[cB]=new aH.Vector3()}for(cw=0,cA=this.faces.length;cw<cA;cw++){cz=this.faces[cw];if(cz instanceof aH.Face3){cz.vertexNormals=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3()]}else{if(cz instanceof aH.Face4){cz.vertexNormals=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3()]}}}}else{cy=this.__tmpVertices;for(cB=0,ct=this.vertices.length;cB<ct;cB++){cy[cB].set(0,0,0)}}if(cv){var cs,cr,e,cF;var cu=new aH.Vector3(),cE=new aH.Vector3(),cD=new aH.Vector3(),cC=new aH.Vector3(),cx=new aH.Vector3();for(cw=0,cA=this.faces.length;cw<cA;cw++){cz=this.faces[cw];if(cz instanceof aH.Face3){cs=this.vertices[cz.a];cr=this.vertices[cz.b];e=this.vertices[cz.c];cu.subVectors(e,cr);cE.subVectors(cs,cr);cu.cross(cE);cy[cz.a].add(cu);cy[cz.b].add(cu);cy[cz.c].add(cu)}else{if(cz instanceof aH.Face4){cs=this.vertices[cz.a];cr=this.vertices[cz.b];e=this.vertices[cz.c];cF=this.vertices[cz.d];cD.subVectors(cF,cr);cE.subVectors(cs,cr);cD.cross(cE);cy[cz.a].add(cD);cy[cz.b].add(cD);cy[cz.d].add(cD);cC.subVectors(cF,e);cx.subVectors(cr,e);cC.cross(cx);cy[cz.b].add(cC);cy[cz.c].add(cC);cy[cz.d].add(cC)}}}}else{for(cw=0,cA=this.faces.length;cw<cA;cw++){cz=this.faces[cw];if(cz instanceof aH.Face3){cy[cz.a].add(cz.normal);cy[cz.b].add(cz.normal);cy[cz.c].add(cz.normal)}else{if(cz instanceof aH.Face4){cy[cz.a].add(cz.normal);cy[cz.b].add(cz.normal);cy[cz.c].add(cz.normal);cy[cz.d].add(cz.normal)}}}}for(cB=0,ct=this.vertices.length;cB<ct;cB++){cy[cB].normalize()}for(cw=0,cA=this.faces.length;cw<cA;cw++){cz=this.faces[cw];if(cz instanceof aH.Face3){cz.vertexNormals[0].copy(cy[cz.a]);cz.vertexNormals[1].copy(cy[cz.b]);cz.vertexNormals[2].copy(cy[cz.c])}else{if(cz instanceof aH.Face4){cz.vertexNormals[0].copy(cy[cz.a]);cz.vertexNormals[1].copy(cy[cz.b]);cz.vertexNormals[2].copy(cy[cz.c]);cz.vertexNormals[3].copy(cy[cz.d])}}}},computeMorphNormals:function(){var cu,cz,cv,cA,cw;for(cv=0,cA=this.faces.length;cv<cA;cv++){cw=this.faces[cv];if(!cw.__originalFaceNormal){cw.__originalFaceNormal=cw.normal.clone()}else{cw.__originalFaceNormal.copy(cw.normal)}if(!cw.__originalVertexNormals){cw.__originalVertexNormals=[]}for(cu=0,cz=cw.vertexNormals.length;cu<cz;cu++){if(!cw.__originalVertexNormals[cu]){cw.__originalVertexNormals[cu]=cw.vertexNormals[cu].clone()}else{cw.__originalVertexNormals[cu].copy(cw.vertexNormals[cu])}}}var cs=new aH.Geometry();cs.faces=this.faces;for(cu=0,cz=this.morphTargets.length;cu<cz;cu++){if(!this.morphNormals[cu]){this.morphNormals[cu]={};this.morphNormals[cu].faceNormals=[];this.morphNormals[cu].vertexNormals=[];var ct=this.morphNormals[cu].faceNormals;var e=this.morphNormals[cu].vertexNormals;var cy,cr;for(cv=0,cA=this.faces.length;cv<cA;cv++){cw=this.faces[cv];cy=new aH.Vector3();if(cw instanceof aH.Face3){cr={a:new aH.Vector3(),b:new aH.Vector3(),c:new aH.Vector3()}}else{cr={a:new aH.Vector3(),b:new aH.Vector3(),c:new aH.Vector3(),d:new aH.Vector3()}}ct.push(cy);e.push(cr)}}var cx=this.morphNormals[cu];cs.vertices=this.morphTargets[cu].vertices;cs.computeFaceNormals();cs.computeVertexNormals();var cy,cr;for(cv=0,cA=this.faces.length;cv<cA;cv++){cw=this.faces[cv];cy=cx.faceNormals[cv];cr=cx.vertexNormals[cv];cy.copy(cw.normal);if(cw instanceof aH.Face3){cr.a.copy(cw.vertexNormals[0]);cr.b.copy(cw.vertexNormals[1]);cr.c.copy(cw.vertexNormals[2])}else{cr.a.copy(cw.vertexNormals[0]);cr.b.copy(cw.vertexNormals[1]);cr.c.copy(cw.vertexNormals[2]);cr.d.copy(cw.vertexNormals[3])}}}for(cv=0,cA=this.faces.length;cv<cA;cv++){cw=this.faces[cv];cw.normal=cw.__originalFaceNormal;cw.vertexNormals=cw.__originalVertexNormals}},computeTangents:function(){var cU,cA,cK,cy,cT,cC,cI,cv,cB,cQ,cN,cM,cu,ct,cs,cx,cw,c1,c0,cG,cF,cX,cW,cE,cD,cO,cL,cr,cZ=[],cY=[],e=new aH.Vector3(),cz=new aH.Vector3(),cR=new aH.Vector3(),cV=new aH.Vector3(),cS=new aH.Vector3(),cJ;for(cK=0,cy=this.vertices.length;cK<cy;cK++){cZ[cK]=new aH.Vector3();cY[cK]=new aH.Vector3()}function cH(c7,c3,c2,c8,c6,c5,c4){cQ=c7.vertices[c3];cN=c7.vertices[c2];cM=c7.vertices[c8];cu=cB[c6];ct=cB[c5];cs=cB[c4];cx=cN.x-cQ.x;cw=cM.x-cQ.x;c1=cN.y-cQ.y;c0=cM.y-cQ.y;cG=cN.z-cQ.z;cF=cM.z-cQ.z;cX=ct.x-cu.x;cW=cs.x-cu.x;cE=ct.y-cu.y;cD=cs.y-cu.y;cO=1/(cX*cD-cW*cE);e.set((cD*cx-cE*cw)*cO,(cD*c1-cE*c0)*cO,(cD*cG-cE*cF)*cO);cz.set((cX*cw-cW*cx)*cO,(cX*c0-cW*c1)*cO,(cX*cF-cW*cG)*cO);cZ[c3].add(e);cZ[c2].add(e);cZ[c8].add(e);cY[c3].add(cz);cY[c2].add(cz);cY[c8].add(cz)}for(cU=0,cA=this.faces.length;cU<cA;cU++){cv=this.faces[cU];cB=this.faceVertexUvs[0][cU];if(cv instanceof aH.Face3){cH(this,cv.a,cv.b,cv.c,0,1,2)}else{if(cv instanceof aH.Face4){cH(this,cv.a,cv.b,cv.d,0,1,3);cH(this,cv.b,cv.c,cv.d,1,2,3)}}}var cP=["a","b","c","d"];for(cU=0,cA=this.faces.length;cU<cA;cU++){cv=this.faces[cU];for(cT=0;cT<cv.vertexNormals.length;cT++){cS.copy(cv.vertexNormals[cT]);cI=cv[cP[cT]];cL=cZ[cI];cR.copy(cL);cR.sub(cS.multiplyScalar(cS.dot(cL))).normalize();cV.crossVectors(cv.vertexNormals[cT],cL);cr=cV.dot(cY[cI]);cJ=(cr<0)?-1:1;cv.vertexTangents[cT]=new aH.Vector4(cR.x,cR.y,cR.z,cJ)}}this.hasTangents=true},computeLineDistances:function(){var ct=0;var cr=this.vertices;for(var cs=0,e=cr.length;cs<e;cs++){if(cs>0){ct+=cr[cs].distanceTo(cr[cs-1])}this.lineDistances[cs]=ct}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new aH.Box3()}this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new aH.Sphere()}this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var cr={};var e=[],cI=[];var cv,cJ;var cx=4;var cG=Math.pow(10,cx);var cE,cu,ct;var cs,cC,cD,cF,cw;this.__tmpVertices=undefined;for(cE=0,cu=this.vertices.length;cE<cu;cE++){cv=this.vertices[cE];cJ=[Math.round(cv.x*cG),Math.round(cv.y*cG),Math.round(cv.z*cG)].join("_");if(cr[cJ]===undefined){cr[cJ]=cE;e.push(this.vertices[cE]);cI[cE]=e.length-1}else{cI[cE]=cI[cr[cJ]]}}var cz=[];for(cE=0,cu=this.faces.length;cE<cu;cE++){ct=this.faces[cE];if(ct instanceof aH.Face3){ct.a=cI[ct.a];ct.b=cI[ct.b];ct.c=cI[ct.c];cs=[ct.a,ct.b,ct.c];var cB=-1;for(var cA=0;cA<3;cA++){if(cs[cA]==cs[(cA+1)%3]){cB=cA;cz.push(cE);break}}}else{if(ct instanceof aH.Face4){ct.a=cI[ct.a];ct.b=cI[ct.b];ct.c=cI[ct.c];ct.d=cI[ct.d];cs=[ct.a,ct.b,ct.c,ct.d];var cB=-1;for(var cA=0;cA<4;cA++){if(cs[cA]==cs[(cA+1)%4]){if(cB>=0){cz.push(cE)}cB=cA}}if(cB>=0){cs.splice(cB,1);var cH=new aH.Face3(cs[0],cs[1],cs[2],ct.normal,ct.color,ct.materialIndex);for(cD=0,cF=this.faceVertexUvs.length;cD<cF;cD++){cw=this.faceVertexUvs[cD][cE];if(cw){cw.splice(cB,1)}}if(ct.vertexNormals&&ct.vertexNormals.length>0){cH.vertexNormals=ct.vertexNormals;cH.vertexNormals.splice(cB,1)}if(ct.vertexColors&&ct.vertexColors.length>0){cH.vertexColors=ct.vertexColors;cH.vertexColors.splice(cB,1)}this.faces[cE]=cH}}}}for(cE=cz.length-1;cE>=0;cE--){this.faces.splice(cE,1);for(cD=0,cF=this.faceVertexUvs.length;cD<cF;cD++){this.faceVertexUvs[cD].splice(cE,1)}}var cy=this.vertices.length-e.length;this.vertices=e;return cy},clone:function(){var cy=new aH.Geometry();var cx=this.vertices;for(var cw=0,cz=cx.length;cw<cz;cw++){cy.vertices.push(cx[cw].clone())}var cs=this.faces;for(var cw=0,cz=cs.length;cw<cz;cw++){cy.faces.push(cs[cw].clone())}var cu=this.faceVertexUvs[0];for(var cw=0,cz=cu.length;cw<cz;cw++){var cr=cu[cw],e=[];for(var ct=0,cv=cr.length;ct<cv;ct++){e.push(new aH.Vector2(cr[ct].x,cr[ct].y))}cy.faceVertexUvs[0].push(e)}return cy},dispose:function(){this.dispatchEvent({type:"dispose"})}};aH.GeometryIdCount=0;aH.BufferGeometry=function(){this.id=aH.GeometryIdCount++;this.attributes={};this.dynamic=false;this.offsets=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=false;this.morphTargets=[]};aH.BufferGeometry.prototype={constructor:aH.BufferGeometry,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(cr){var e;var cs;if(this.attributes.position){e=this.attributes.position.array}if(this.attributes.normal){cs=this.attributes.normal.array}if(e!==undefined){cr.multiplyVector3Array(e);this.verticesNeedUpdate=true}if(cs!==undefined){var ct=new aH.Matrix3().getNormalMatrix(cr);ct.multiplyVector3Array(cs);this.normalizeNormals();this.normalsNeedUpdate=true}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new aH.Box3()}var cr=this.attributes.position.array;if(cr){var cv=this.boundingBox;var e,cw,cu;if(cr.length>=3){cv.min.x=cv.max.x=cr[0];cv.min.y=cv.max.y=cr[1];cv.min.z=cv.max.z=cr[2]}for(var ct=3,cs=cr.length;ct<cs;ct+=3){e=cr[ct];cw=cr[ct+1];cu=cr[ct+2];if(e<cv.min.x){cv.min.x=e}else{if(e>cv.max.x){cv.max.x=e}}if(cw<cv.min.y){cv.min.y=cw}else{if(cw>cv.max.y){cv.max.y=cw}}if(cu<cv.min.z){cv.min.z=cu}else{if(cu>cv.max.z){cv.max.z=cu}}}}if(cr===undefined||cr.length===0){this.boundingBox.min.set(0,0,0);this.boundingBox.max.set(0,0,0)}},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new aH.Sphere()}var cs=this.attributes.position.array;if(cs){var cu,cr=0;var e,cx,cw;for(var cv=0,ct=cs.length;cv<ct;cv+=3){e=cs[cv];cx=cs[cv+1];cw=cs[cv+2];cu=e*e+cx*cx+cw*cw;if(cu>cr){cr=cu}}this.boundingSphere.radius=Math.sqrt(cr)}},computeVertexNormals:function(){if(this.attributes.position){var cH,cy;var cE,cJ;var cL=this.attributes.position.array.length;if(this.attributes.normal===undefined){this.attributes.normal={itemSize:3,array:new Float32Array(cL),numItems:cL}}else{for(cH=0,cy=this.attributes.normal.array.length;cH<cy;cH++){this.attributes.normal.array[cH]=0}}var cv=this.attributes.position.array;var cA=this.attributes.normal.array;var cK,cI,cG,cz,cx,cw,cF=new aH.Vector3(),cD=new aH.Vector3(),cC=new aH.Vector3(),cB=new aH.Vector3(),cM=new aH.Vector3();if(this.attributes.index){var cs=this.attributes.index.array;var cr=this.offsets;for(cE=0,cJ=cr.length;cE<cJ;++cE){var e=cr[cE].start;var cu=cr[cE].count;var ct=cr[cE].index;for(cH=e,cy=e+cu;cH<cy;cH+=3){cK=ct+cs[cH];cI=ct+cs[cH+1];cG=ct+cs[cH+2];cz=cv[cK*3];cx=cv[cK*3+1];cw=cv[cK*3+2];cF.set(cz,cx,cw);cz=cv[cI*3];cx=cv[cI*3+1];cw=cv[cI*3+2];cD.set(cz,cx,cw);cz=cv[cG*3];cx=cv[cG*3+1];cw=cv[cG*3+2];cC.set(cz,cx,cw);cB.subVectors(cC,cD);cM.subVectors(cF,cD);cB.cross(cM);cA[cK*3]+=cB.x;cA[cK*3+1]+=cB.y;cA[cK*3+2]+=cB.z;cA[cI*3]+=cB.x;cA[cI*3+1]+=cB.y;cA[cI*3+2]+=cB.z;cA[cG*3]+=cB.x;cA[cG*3+1]+=cB.y;cA[cG*3+2]+=cB.z}}}else{for(cH=0,cy=cv.length;cH<cy;cH+=9){cz=cv[cH];cx=cv[cH+1];cw=cv[cH+2];cF.set(cz,cx,cw);cz=cv[cH+3];cx=cv[cH+4];cw=cv[cH+5];cD.set(cz,cx,cw);cz=cv[cH+6];cx=cv[cH+7];cw=cv[cH+8];cC.set(cz,cx,cw);cB.subVectors(cC,cD);cM.subVectors(cF,cD);cB.cross(cM);cA[cH]=cB.x;cA[cH+1]=cB.y;cA[cH+2]=cB.z;cA[cH+3]=cB.x;cA[cH+4]=cB.y;cA[cH+5]=cB.z;cA[cH+6]=cB.x;cA[cH+7]=cB.y;cA[cH+8]=cB.z}}this.normalizeNormals();this.normalsNeedUpdate=true}},normalizeNormals:function(){var ct=this.attributes.normal.array;var e,cw,cu,cv;for(var cs=0,cr=ct.length;cs<cr;cs+=3){e=ct[cs];cw=ct[cs+1];cu=ct[cs+2];cv=1/Math.sqrt(e*e+cw*cw+cu*cu);ct[cs]*=cv;ct[cs+1]*=cv;ct[cs+2]*=cv}},computeTangents:function(){if(this.attributes.index===undefined||this.attributes.position===undefined||this.attributes.normal===undefined||this.attributes.uv===undefined){console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");return}var cv=this.attributes.index.array;var cD=this.attributes.position.array;var cH=this.attributes.normal.array;var cZ=this.attributes.uv.array;var cG=cD.length/3;if(this.attributes.tangent===undefined){var cI=4*cG;this.attributes.tangent={itemSize:4,array:new Float32Array(cI),numItems:cI}}var cP=this.attributes.tangent.array;var dj=[],di=[];for(var dc=0;dc<cG;dc++){dj[dc]=new aH.Vector3();di[dc]=new aH.Vector3()}var cz,da,cO,cy,c9,cN,cx,c7,cL,cw,c6,cu,c4,ct,c2,cF,cE,dl,dk,cX,cW,dh,dg,cV,cU,c3;var cA=new aH.Vector3(),cR=new aH.Vector3();function cY(dn,dm,dp){cz=cD[dn*3];da=cD[dn*3+1];cO=cD[dn*3+2];cy=cD[dm*3];c9=cD[dm*3+1];cN=cD[dm*3+2];cx=cD[dp*3];c7=cD[dp*3+1];cL=cD[dp*3+2];cw=cZ[dn*2];c6=cZ[dn*2+1];cu=cZ[dm*2];c4=cZ[dm*2+1];ct=cZ[dp*2];c2=cZ[dp*2+1];cF=cy-cz;cE=cx-cz;dl=c9-da;dk=c7-da;cX=cN-cO;cW=cL-cO;dh=cu-cw;dg=ct-cw;cV=c4-c6;cU=c2-c6;c3=1/(dh*cU-dg*cV);cA.set((cU*cF-cV*cE)*c3,(cU*dl-cV*dk)*c3,(cU*cX-cV*cW)*c3);cR.set((dh*cE-dg*cF)*c3,(dh*dk-dg*dl)*c3,(dh*cW-dg*cX)*c3);dj[dn].add(cA);dj[dm].add(cA);dj[dp].add(cA);di[dn].add(cR);di[dm].add(cR);di[dp].add(cR)}var de,cS;var dd,cC;var cs,cr,e;var cK=this.offsets;for(dd=0,cC=cK.length;dd<cC;++dd){var cM=cK[dd].start;var c5=cK[dd].count;var cT=cK[dd].index;for(de=cM,cS=cM+c5;de<cS;de+=3){cs=cT+cv[de];cr=cT+cv[de+1];e=cT+cv[de+2];cY(cs,cr,e)}}var c8=new aH.Vector3(),df=new aH.Vector3();var db=new aH.Vector3(),cQ=new aH.Vector3();var c0,c1,cB;function cJ(dm){db.x=cH[dm*3];db.y=cH[dm*3+1];db.z=cH[dm*3+2];cQ.copy(db);c1=dj[dm];c8.copy(c1);c8.sub(db.multiplyScalar(db.dot(c1))).normalize();df.crossVectors(cQ,c1);cB=df.dot(di[dm]);c0=(cB<0)?-1:1;cP[dm*4]=c8.x;cP[dm*4+1]=c8.y;cP[dm*4+2]=c8.z;cP[dm*4+3]=c0}for(dd=0,cC=cK.length;dd<cC;++dd){var cM=cK[dd].start;var c5=cK[dd].count;var cT=cK[dd].index;for(de=cM,cS=cM+c5;de<cS;de+=3){cs=cT+cv[de];cr=cT+cv[de+1];e=cT+cv[de+2];cJ(cs);cJ(cr);cJ(e)}}this.hasTangents=true;this.tangentsNeedUpdate=true},dispose:function(){this.dispatchEvent({type:"dispose"})}};aH.Camera=function(){aH.Object3D.call(this);this.matrixWorldInverse=new aH.Matrix4();this.projectionMatrix=new aH.Matrix4();this.projectionMatrixInverse=new aH.Matrix4()};aH.Camera.prototype=Object.create(aH.Object3D.prototype);aH.Camera.prototype.lookAt=function(){var e=new aH.Matrix4();return function(cr){e.lookAt(this.position,cr,this.up);if(this.useQuaternion===true){this.quaternion.setFromRotationMatrix(e)}else{this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}}();aH.OrthographicCamera=function(cv,cs,cu,cr,ct,e){aH.Camera.call(this);this.left=cv;this.right=cs;this.top=cu;this.bottom=cr;this.near=(ct!==undefined)?ct:0.1;this.far=(e!==undefined)?e:2000;this.updateProjectionMatrix()};aH.OrthographicCamera.prototype=Object.create(aH.Camera.prototype);aH.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};aH.PerspectiveCamera=function(cs,cr,ct,e){aH.Camera.call(this);this.fov=cs!==undefined?cs:50;this.aspect=cr!==undefined?cr:1;this.near=ct!==undefined?ct:0.1;this.far=e!==undefined?e:2000;this.updateProjectionMatrix()};aH.PerspectiveCamera.prototype=Object.create(aH.Camera.prototype);aH.PerspectiveCamera.prototype.setLens=function(cr,e){if(e===undefined){e=24}this.fov=2*aH.Math.radToDeg(Math.atan(e/(cr*2)));this.updateProjectionMatrix()};aH.PerspectiveCamera.prototype.setViewOffset=function(cu,cs,cr,cv,ct,e){this.fullWidth=cu;this.fullHeight=cs;this.x=cr;this.y=cv;this.width=ct;this.height=e;this.updateProjectionMatrix()};aH.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var cs=this.fullWidth/this.fullHeight;var cw=Math.tan(aH.Math.degToRad(this.fov*0.5))*this.near;var cr=-cw;var cv=cs*cr;var ct=cs*cw;var cu=Math.abs(ct-cv);var e=Math.abs(cw-cr);this.projectionMatrix.makeFrustum(cv+this.x*cu/this.fullWidth,cv+(this.x+this.width)*cu/this.fullWidth,cw-(this.y+this.height)*e/this.fullHeight,cw-this.y*e/this.fullHeight,this.near,this.far)}else{this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)}};aH.Light=function(e){aH.Object3D.call(this);this.color=new aH.Color(e)};aH.Light.prototype=Object.create(aH.Object3D.prototype);aH.Light.prototype.clone=function(e){if(e===undefined){e=new aH.Light()}aH.Object3D.prototype.clone.call(this,e);e.color.copy(this.color);return e};aH.AmbientLight=function(e){aH.Light.call(this,e)};aH.AmbientLight.prototype=Object.create(aH.Light.prototype);aH.AmbientLight.prototype.clone=function(){var e=new aH.AmbientLight();aH.Light.prototype.clone.call(this,e);return e};aH.AreaLight=function(cr,e){aH.Light.call(this,cr);this.normal=new aH.Vector3(0,-1,0);this.right=new aH.Vector3(1,0,0);this.intensity=(e!==undefined)?e:1;this.width=1;this.height=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};aH.AreaLight.prototype=Object.create(aH.Light.prototype);aH.DirectionalLight=function(cr,e){aH.Light.call(this,cr);this.position.set(0,1,0);this.target=new aH.Object3D();this.intensity=(e!==undefined)?e:1;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraLeft=-500;this.shadowCameraRight=500;this.shadowCameraTop=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowCascade=false;this.shadowCascadeOffset=new aH.Vector3(0,0,-1000);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};aH.DirectionalLight.prototype=Object.create(aH.Light.prototype);aH.DirectionalLight.prototype.clone=function(){var e=new aH.DirectionalLight();aH.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;return e};aH.HemisphereLight=function(cr,cs,e){aH.Light.call(this,cr);this.position.set(0,100,0);this.groundColor=new aH.Color(cs);this.intensity=(e!==undefined)?e:1};aH.HemisphereLight.prototype=Object.create(aH.Light.prototype);aH.HemisphereLight.prototype.clone=function(){var e=new aH.PointLight();aH.Light.prototype.clone.call(this,e);e.groundColor.copy(this.groundColor);e.intensity=this.intensity;return e};aH.PointLight=function(cr,e,cs){aH.Light.call(this,cr);this.intensity=(e!==undefined)?e:1;this.distance=(cs!==undefined)?cs:0};aH.PointLight.prototype=Object.create(aH.Light.prototype);aH.PointLight.prototype.clone=function(){var e=new aH.PointLight();aH.Light.prototype.clone.call(this,e);e.intensity=this.intensity;e.distance=this.distance;return e};aH.SpotLight=function(cr,e,cu,ct,cs){aH.Light.call(this,cr);this.position.set(0,1,0);this.target=new aH.Object3D();this.intensity=(e!==undefined)?e:1;this.distance=(cu!==undefined)?cu:0;this.angle=(ct!==undefined)?ct:Math.PI/3;this.exponent=(cs!==undefined)?cs:10;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};aH.SpotLight.prototype=Object.create(aH.Light.prototype);aH.SpotLight.prototype.clone=function(){var e=new aH.SpotLight();aH.Light.prototype.clone.call(this,e);e.target=this.target.clone();e.intensity=this.intensity;e.distance=this.distance;e.angle=this.angle;e.exponent=this.exponent;e.castShadow=this.castShadow;e.onlyShadow=this.onlyShadow;return e};aH.Loader=function(e){this.showStatus=e;this.statusDomElement=e?aH.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};aH.Loader.prototype={constructor:aH.Loader,crossOrigin:"anonymous",addStatusElement:function(){var cr=document.createElement("div");cr.style.position="absolute";cr.style.right="0px";cr.style.top="0px";cr.style.fontSize="0.8em";cr.style.textAlign="left";cr.style.background="rgba(0,0,0,0.25)";cr.style.color="#fff";cr.style.width="120px";cr.style.padding="0.5em 0.5em 0.5em 0.5em";cr.style.zIndex=1000;cr.innerHTML="Loading ...";return cr},updateProgress:function(e){var cr="Loaded ";if(e.total){cr+=(100*e.loaded/e.total).toFixed(0)+"%"}else{cr+=(e.loaded/1000).toFixed(2)+" KB"}this.statusDomElement.innerHTML=cr},extractUrlBase:function(e){var cr=e.split("/");cr.pop();return(cr.length<1?".":cr.join("/"))+"/"},initMaterials:function(e,cs){var ct=[];for(var cr=0;cr<e.length;++cr){ct[cr]=aH.Loader.prototype.createMaterial(e[cr],cs)}return ct},needsTangents:function(cr){for(var ct=0,cs=cr.length;ct<cs;ct++){var e=cr[ct];if(e instanceof aH.ShaderMaterial){return true}}return false},createMaterial:function(cv,cs){var cx=this;function cu(cG){var cF=Math.log(cG)/Math.LN2;return Math.floor(cF)==cF}function e(cG){var cF=Math.log(cG)/Math.LN2;return Math.pow(2,Math.round(cF))}function cC(cG,cF){var cH=new Image();cH.onload=function(){if(!cu(this.width)||!cu(this.height)){var cJ=e(this.width);var cI=e(this.height);cG.image.width=cJ;cG.image.height=cI;cG.image.getContext("2d").drawImage(this,0,0,cJ,cI)}else{cG.image=this}cG.needsUpdate=true};cH.crossOrigin=cx.crossOrigin;cH.src=cF}function cz(cN,cG,cL,cH,cM,cI,cF){var cK=/\.dds$/i.test(cL);var cJ=cs+"/"+cL;if(cK){var cO=aH.ImageUtils.loadCompressedTexture(cJ);cN[cG]=cO}else{var cO=document.createElement("canvas");cN[cG]=new aH.Texture(cO)}cN[cG].sourceFile=cL;if(cH){cN[cG].repeat.set(cH[0],cH[1]);if(cH[0]!==1){cN[cG].wrapS=aH.RepeatWrapping}if(cH[1]!==1){cN[cG].wrapT=aH.RepeatWrapping}}if(cM){cN[cG].offset.set(cM[0],cM[1])}if(cI){var cP={repeat:aH.RepeatWrapping,mirror:aH.MirroredRepeatWrapping};if(cP[cI[0]]!==undefined){cN[cG].wrapS=cP[cI[0]]}if(cP[cI[1]]!==undefined){cN[cG].wrapT=cP[cI[1]]}}if(cF){cN[cG].anisotropy=cF}if(!cK){cC(cN[cG],cJ)}}function cr(cF){return(cF[0]*255<<16)+(cF[1]*255<<8)+cF[2]*255}var ct="MeshLambertMaterial";var cB={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:false};if(cv.shading){var cA=cv.shading.toLowerCase();if(cA==="phong"){ct="MeshPhongMaterial"}else{if(cA==="basic"){ct="MeshBasicMaterial"}}}if(cv.blending!==undefined&&aH[cv.blending]!==undefined){cB.blending=aH[cv.blending]}if(cv.transparent!==undefined||cv.opacity<1){cB.transparent=cv.transparent}if(cv.depthTest!==undefined){cB.depthTest=cv.depthTest}if(cv.depthWrite!==undefined){cB.depthWrite=cv.depthWrite}if(cv.visible!==undefined){cB.visible=cv.visible}if(cv.flipSided!==undefined){cB.side=aH.BackSide}if(cv.doubleSided!==undefined){cB.side=aH.DoubleSide}if(cv.wireframe!==undefined){cB.wireframe=cv.wireframe}if(cv.vertexColors!==undefined){if(cv.vertexColors==="face"){cB.vertexColors=aH.FaceColors}else{if(cv.vertexColors){cB.vertexColors=aH.VertexColors}}}if(cv.colorDiffuse){cB.color=cr(cv.colorDiffuse)}else{if(cv.DbgColor){cB.color=cv.DbgColor}}if(cv.colorSpecular){cB.specular=cr(cv.colorSpecular)}if(cv.colorAmbient){cB.ambient=cr(cv.colorAmbient)}if(cv.transparency){cB.opacity=cv.transparency}if(cv.specularCoef){cB.shininess=cv.specularCoef}if(cv.mapDiffuse&&cs){cz(cB,"map",cv.mapDiffuse,cv.mapDiffuseRepeat,cv.mapDiffuseOffset,cv.mapDiffuseWrap,cv.mapDiffuseAnisotropy)}if(cv.mapLight&&cs){cz(cB,"lightMap",cv.mapLight,cv.mapLightRepeat,cv.mapLightOffset,cv.mapLightWrap,cv.mapLightAnisotropy)}if(cv.mapBump&&cs){cz(cB,"bumpMap",cv.mapBump,cv.mapBumpRepeat,cv.mapBumpOffset,cv.mapBumpWrap,cv.mapBumpAnisotropy)}if(cv.mapNormal&&cs){cz(cB,"normalMap",cv.mapNormal,cv.mapNormalRepeat,cv.mapNormalOffset,cv.mapNormalWrap,cv.mapNormalAnisotropy)}if(cv.mapSpecular&&cs){cz(cB,"specularMap",cv.mapSpecular,cv.mapSpecularRepeat,cv.mapSpecularOffset,cv.mapSpecularWrap,cv.mapSpecularAnisotropy)}if(cv.mapBumpScale){cB.bumpScale=cv.mapBumpScale}if(cv.mapNormal){var cw=aH.ShaderLib.normalmap;var cD=aH.UniformsUtils.clone(cw.uniforms);cD.tNormal.value=cB.normalMap;if(cv.mapNormalFactor){cD.uNormalScale.value.set(cv.mapNormalFactor,cv.mapNormalFactor)}if(cB.map){cD.tDiffuse.value=cB.map;cD.enableDiffuse.value=true}if(cB.specularMap){cD.tSpecular.value=cB.specularMap;cD.enableSpecular.value=true}if(cB.lightMap){cD.tAO.value=cB.lightMap;cD.enableAO.value=true}cD.uDiffuseColor.value.setHex(cB.color);cD.uSpecularColor.value.setHex(cB.specular);cD.uAmbientColor.value.setHex(cB.ambient);cD.uShininess.value=cB.shininess;if(cB.opacity!==undefined){cD.uOpacity.value=cB.opacity}var cE={fragmentShader:cw.fragmentShader,vertexShader:cw.vertexShader,uniforms:cD,lights:true,fog:true};var cy=new aH.ShaderMaterial(cE);if(cB.transparent){cy.transparent=true}}else{var cy=new aH[ct](cB)}if(cv.DbgName!==undefined){cy.name=cv.DbgName}return cy}};aH.ImageLoader=function(){this.crossOrigin=null};aH.ImageLoader.prototype={constructor:aH.ImageLoader,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,load:function(e,cs){var cr=this;if(cs===undefined){cs=new Image()}cs.addEventListener("load",function(){cr.dispatchEvent({type:"load",content:cs})},false);cs.addEventListener("error",function(){cr.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},false);if(cr.crossOrigin){cs.crossOrigin=cr.crossOrigin}cs.src=e}};aH.JSONLoader=function(e){aH.Loader.call(this,e);this.withCredentials=false};aH.JSONLoader.prototype=Object.create(aH.Loader.prototype);aH.JSONLoader.prototype.load=function(e,ct,cs){var cr=this;cs=cs&&(typeof cs==="string")?cs:this.extractUrlBase(e);this.onLoadStart();this.loadAjaxJSON(this,e,ct,cs)};aH.JSONLoader.prototype.loadAjaxJSON=function(cr,e,cw,cu,ct){var cv=new XMLHttpRequest();var cs=0;cv.onreadystatechange=function(){if(cv.readyState===cv.DONE){if(cv.status===200||cv.status===0){if(cv.responseText){var cy=JSON.parse(cv.responseText);var cx=cr.parse(cy,cu);cw(cx.geometry,cx.materials)}else{console.warn("THREE.JSONLoader: ["+e+"] seems to be unreachable or file there is empty")}cr.onLoadComplete()}else{console.error("THREE.JSONLoader: Couldn't load ["+e+"] ["+cv.status+"]")}}else{if(cv.readyState===cv.LOADING){if(ct){if(cs===0){cs=cv.getResponseHeader("Content-Length")}ct({total:cs,loaded:cv.responseText.length})}}else{if(cv.readyState===cv.HEADERS_RECEIVED){if(ct!==undefined){cs=cv.getResponseHeader("Content-Length")}}}}};cv.open("GET",e,true);cv.withCredentials=this.withCredentials;cv.send(null)};aH.JSONLoader.prototype.parse=function(cy,cs){var cx=this,cu=new aH.Geometry(),ct=(cy.scale!==undefined)?1/cy.scale:1;e(ct);cv();cr(ct);cu.computeCentroids();cu.computeFaceNormals();function e(c5){function cH(c8,c7){return c8&(1<<c7)}var cZ,cY,cN,cF,cE,cX,cD,c2,cQ,cI,cB,cO,cR,c3,cz,c1,cW,cU,cS,c0,cJ,cV,c4,cC,cL,cP,cM,cA=cy.faces,cG=cy.vertices,cT=cy.normals,cK=cy.colors,c6=0;for(cZ=0;cZ<cy.uvs.length;cZ++){if(cy.uvs[cZ].length){c6++}}for(cZ=0;cZ<c6;cZ++){cu.faceUvs[cZ]=[];cu.faceVertexUvs[cZ]=[]}cF=0;cE=cG.length;while(cF<cE){c0=new aH.Vector3();c0.x=cG[cF++]*c5;c0.y=cG[cF++]*c5;c0.z=cG[cF++]*c5;cu.vertices.push(c0)}cF=0;cE=cA.length;while(cF<cE){cB=cA[cF++];cO=cH(cB,0);cR=cH(cB,1);c3=cH(cB,2);cz=cH(cB,3);c1=cH(cB,4);cW=cH(cB,5);cU=cH(cB,6);cS=cH(cB,7);if(cO){cJ=new aH.Face4();cJ.a=cA[cF++];cJ.b=cA[cF++];cJ.c=cA[cF++];cJ.d=cA[cF++];cX=4}else{cJ=new aH.Face3();cJ.a=cA[cF++];cJ.b=cA[cF++];cJ.c=cA[cF++];cX=3}if(cR){cI=cA[cF++];cJ.materialIndex=cI}cN=cu.faces.length;if(c3){for(cZ=0;cZ<c6;cZ++){cC=cy.uvs[cZ];cQ=cA[cF++];cP=cC[cQ*2];cM=cC[cQ*2+1];cu.faceUvs[cZ][cN]=new aH.Vector2(cP,cM)}}if(cz){for(cZ=0;cZ<c6;cZ++){cC=cy.uvs[cZ];cL=[];for(cY=0;cY<cX;cY++){cQ=cA[cF++];cP=cC[cQ*2];cM=cC[cQ*2+1];cL[cY]=new aH.Vector2(cP,cM)}cu.faceVertexUvs[cZ][cN]=cL}}if(c1){c2=cA[cF++]*3;c4=new aH.Vector3();c4.x=cT[c2++];c4.y=cT[c2++];c4.z=cT[c2];cJ.normal=c4}if(cW){for(cZ=0;cZ<cX;cZ++){c2=cA[cF++]*3;c4=new aH.Vector3();c4.x=cT[c2++];c4.y=cT[c2++];c4.z=cT[c2];cJ.vertexNormals.push(c4)}}if(cU){cD=cA[cF++];cV=new aH.Color(cK[cD]);cJ.color=cV}if(cS){for(cZ=0;cZ<cX;cZ++){cD=cA[cF++];cV=new aH.Color(cK[cD]);cJ.vertexColors.push(cV)}}cu.faces.push(cJ)}}function cv(){var cA,cz,cH,cE,cD,cI,cG,cF,cC,cB;if(cy.skinWeights){for(cA=0,cz=cy.skinWeights.length;cA<cz;cA+=2){cH=cy.skinWeights[cA];cE=cy.skinWeights[cA+1];cD=0;cI=0;cu.skinWeights.push(new aH.Vector4(cH,cE,cD,cI))}}if(cy.skinIndices){for(cA=0,cz=cy.skinIndices.length;cA<cz;cA+=2){cG=cy.skinIndices[cA];cF=cy.skinIndices[cA+1];cC=0;cB=0;cu.skinIndices.push(new aH.Vector4(cG,cF,cC,cB))}}cu.bones=cy.bones;cu.animation=cy.animation}function cr(cB){if(cy.morphTargets!==undefined){var cE,cC,cK,cA,cG,cL;for(cE=0,cC=cy.morphTargets.length;cE<cC;cE++){cu.morphTargets[cE]={};cu.morphTargets[cE].name=cy.morphTargets[cE].name;cu.morphTargets[cE].vertices=[];cG=cu.morphTargets[cE].vertices;cL=cy.morphTargets[cE].vertices;for(cK=0,cA=cL.length;cK<cA;cK+=3){var cF=new aH.Vector3();cF.x=cL[cK]*cB;cF.y=cL[cK+1]*cB;cF.z=cL[cK+2]*cB;cG.push(cF)}}}if(cy.morphColors!==undefined){var cE,cC,cH,cJ,cI,cz,cD;for(cE=0,cC=cy.morphColors.length;cE<cC;cE++){cu.morphColors[cE]={};cu.morphColors[cE].name=cy.morphColors[cE].name;cu.morphColors[cE].colors=[];cI=cu.morphColors[cE].colors;cz=cy.morphColors[cE].colors;for(cH=0,cJ=cz.length;cH<cJ;cH+=3){cD=new aH.Color(16755200);cD.setRGB(cz[cH],cz[cH+1],cz[cH+2]);cI.push(cD)}}}}if(cy.materials===undefined){return{geometry:cu}}else{var cw=this.initMaterials(cy.materials,cs);if(this.needsTangents(cw)){cu.computeTangents()}return{geometry:cu,materials:cw}}};aH.LoadingMonitor=function(){var cs=this;var e=0;var ct=0;var cr=function(cu){e++;cs.dispatchEvent({type:"progress",loaded:e,total:ct});if(e===ct){cs.dispatchEvent({type:"load"})}};this.add=function(cu){ct++;cu.addEventListener("load",cr,false)}};aH.LoadingMonitor.prototype={constructor:aH.LoadingMonitor,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent};aH.GeometryLoader=function(){};aH.GeometryLoader.prototype={constructor:aH.GeometryLoader,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,load:function(e){var cr=this;var cs=new XMLHttpRequest();cs.addEventListener("load",function(cu){var ct=cr.parse(JSON.parse(cu.target.responseText));cr.dispatchEvent({type:"load",content:ct})},false);cs.addEventListener("progress",function(ct){cr.dispatchEvent({type:"progress",loaded:ct.loaded,total:ct.total})},false);cs.addEventListener("error",function(){cr.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},false);cs.open("GET",e,true);cs.send(null)},parse:function(e){}};aH.MaterialLoader=function(){};aH.MaterialLoader.prototype={constructor:aH.MaterialLoader,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,load:function(e){var cr=this;var cs=new XMLHttpRequest();cs.addEventListener("load",function(cu){var ct=cr.parse(JSON.parse(cu.target.responseText));cr.dispatchEvent({type:"load",content:ct})},false);cs.addEventListener("progress",function(ct){cr.dispatchEvent({type:"progress",loaded:ct.loaded,total:ct.total})},false);cs.addEventListener("error",function(){cr.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},false);cs.open("GET",e,true);cs.send(null)},parse:function(e){var cr;switch(e.type){case"MeshBasicMaterial":cr=new aH.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshLambertMaterial":cr=new aH.MeshLambertMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshPhongMaterial":cr=new aH.MeshPhongMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,specular:e.specular,shininess:e.shininess,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshNormalMaterial":cr=new aH.MeshNormalMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshDepthMaterial":cr=new aH.MeshDepthMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break}return cr}};aH.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlerMap={};this.hierarchyHandlerMap={};this.addGeometryHandler("ascii",aH.JSONLoader)};aH.SceneLoader.prototype.constructor=aH.SceneLoader;aH.SceneLoader.prototype.load=function(cr,e){var cs=this;var ct=new XMLHttpRequest();ct.onreadystatechange=function(){if(ct.readyState===4){if(ct.status===200||ct.status===0){var cu=JSON.parse(ct.responseText);cs.parse(cu,e,cr)}else{console.error("THREE.SceneLoader: Couldn't load ["+cr+"] ["+ct.status+"]")}}};ct.open("GET",cr,true);ct.send(null)};aH.SceneLoader.prototype.addGeometryHandler=function(e,cr){this.geometryHandlerMap[e]={loaderClass:cr}};aH.SceneLoader.prototype.addHierarchyHandler=function(e,cr){this.hierarchyHandlerMap[e]={loaderClass:cr}};aH.SceneLoader.prototype.parse=function(c8,e,cO){var dl=this;var ct=aH.Loader.prototype.extractUrlBase(cO);var dm,dB,dv,cL,dq,cD,cM,dj,dk,cv,cu,dx,cH,c1,dC;var df=[];var cJ=c8;for(var dw in this.geometryHandlerMap){var cw=this.geometryHandlerMap[dw]["loaderClass"];this.geometryHandlerMap[dw]["loaderObject"]=new cw()}for(var dw in this.hierarchyHandlerMap){var cw=this.hierarchyHandlerMap[dw]["loaderClass"];this.hierarchyHandlerMap[dw]["loaderObject"]=new cw()}cu=0;dx=0;dC={scene:new aH.Scene(),geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(cJ.transform){var dn=cJ.transform.position,cX=cJ.transform.rotation,dt=cJ.transform.scale;if(dn){dC.scene.position.set(dn[0],dn[1],dn[2])}if(cX){dC.scene.rotation.set(cX[0],cX[1],cX[2])}if(dt){dC.scene.scale.set(dt[0],dt[1],dt[2])}if(dn||cX||dt){dC.scene.updateMatrix();dC.scene.updateMatrixWorld()}}function cS(dE,dF){if(dF=="relativeToHTML"){return dE}else{return ct+"/"+dE}}function dz(){dh(dC.scene,cJ.objects)}function dh(dQ,dJ){var dU,dX,dL,dO,dE,dG;for(var dH in dJ){if(dC.objects[dH]===undefined){var dM=dJ[dH];var dV=null;if(dM.type&&(dM.type in dl.hierarchyHandlerMap)){if(dM.loading===undefined){var dI={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var dP={};for(var dN in dM){if(!(dN in dI)){dP[dN]=dM[dN]}}dB=dC.materials[dM.material];dM.loading=true;var dR=dl.hierarchyHandlerMap[dM.type]["loaderObject"];if(dR.options){dR.load(cS(dM.url,cJ.urlBaseType),c2(dH,dQ,dB,dM))}else{dR.load(cS(dM.url,cJ.urlBaseType),c2(dH,dQ,dB,dM),dP)}}}else{if(dM.geometry!==undefined){dm=dC.geometries[dM.geometry];if(dm){var dK=false;dB=dC.materials[dM.material];dK=dB instanceof aH.ShaderMaterial;dL=dM.position;dO=dM.rotation;dE=dM.scale;dU=dM.matrix;dG=dM.quaternion;if(!dM.material){dB=new aH.MeshFaceMaterial(dC.face_materials[dM.geometry])}if((dB instanceof aH.MeshFaceMaterial)&&dB.materials.length===0){dB=new aH.MeshFaceMaterial(dC.face_materials[dM.geometry])}if(dB instanceof aH.MeshFaceMaterial){for(var dT=0;dT<dB.materials.length;dT++){dK=dK||(dB.materials[dT] instanceof aH.ShaderMaterial)}}if(dK){dm.computeTangents()}if(dM.skin){dV=new aH.SkinnedMesh(dm,dB)}else{if(dM.morph){dV=new aH.MorphAnimMesh(dm,dB);if(dM.duration!==undefined){dV.duration=dM.duration}if(dM.time!==undefined){dV.time=dM.time}if(dM.mirroredLoop!==undefined){dV.mirroredLoop=dM.mirroredLoop}if(dB.morphNormals){dm.computeMorphNormals()}}else{dV=new aH.Mesh(dm,dB)}}dV.name=dH;if(dU){dV.matrixAutoUpdate=false;dV.matrix.set(dU[0],dU[1],dU[2],dU[3],dU[4],dU[5],dU[6],dU[7],dU[8],dU[9],dU[10],dU[11],dU[12],dU[13],dU[14],dU[15])}else{dV.position.set(dL[0],dL[1],dL[2]);if(dG){dV.quaternion.set(dG[0],dG[1],dG[2],dG[3]);dV.useQuaternion=true}else{dV.rotation.set(dO[0],dO[1],dO[2])}dV.scale.set(dE[0],dE[1],dE[2])}dV.visible=dM.visible;dV.castShadow=dM.castShadow;dV.receiveShadow=dM.receiveShadow;dQ.add(dV);dC.objects[dH]=dV}}else{if(dM.type==="DirectionalLight"||dM.type==="PointLight"||dM.type==="AmbientLight"){dk=(dM.color!==undefined)?dM.color:16777215;cv=(dM.intensity!==undefined)?dM.intensity:1;if(dM.type==="DirectionalLight"){dL=dM.direction;dj=new aH.DirectionalLight(dk,cv);dj.position.set(dL[0],dL[1],dL[2]);if(dM.target){df.push({object:dj,targetName:dM.target});dj.target=null}}else{if(dM.type==="PointLight"){dL=dM.position;dX=dM.distance;dj=new aH.PointLight(dk,cv,dX);dj.position.set(dL[0],dL[1],dL[2])}else{if(dM.type==="AmbientLight"){dj=new aH.AmbientLight(dk)}}}dQ.add(dj);dj.name=dH;dC.lights[dH]=dj;dC.objects[dH]=dj}else{if(dM.type==="PerspectiveCamera"||dM.type==="OrthographicCamera"){dL=dM.position;dO=dM.rotation;dG=dM.quaternion;if(dM.type==="PerspectiveCamera"){dv=new aH.PerspectiveCamera(dM.fov,dM.aspect,dM.near,dM.far)}else{if(dM.type==="OrthographicCamera"){dv=new aH.OrthographicCamera(dM.left,dM.right,dM.top,dM.bottom,dM.near,dM.far)}}dv.name=dH;dv.position.set(dL[0],dL[1],dL[2]);if(dG!==undefined){dv.quaternion.set(dG[0],dG[1],dG[2],dG[3]);dv.useQuaternion=true}else{if(dO!==undefined){dv.rotation.set(dO[0],dO[1],dO[2])}}dQ.add(dv);dC.cameras[dH]=dv;dC.objects[dH]=dv}else{dL=dM.position;dO=dM.rotation;dE=dM.scale;dG=dM.quaternion;dV=new aH.Object3D();dV.name=dH;dV.position.set(dL[0],dL[1],dL[2]);if(dG){dV.quaternion.set(dG[0],dG[1],dG[2],dG[3]);dV.useQuaternion=true}else{dV.rotation.set(dO[0],dO[1],dO[2])}dV.scale.set(dE[0],dE[1],dE[2]);dV.visible=(dM.visible!==undefined)?dM.visible:false;dQ.add(dV);dC.objects[dH]=dV;dC.empties[dH]=dV}}}}if(dV){if(dM.userData!==undefined){for(var dW in dM.userData){var dS=dM.userData[dW];dV.userData[dW]=dS}}if(dM.groups!==undefined){for(var dT=0;dT<dM.groups.length;dT++){var dF=dM.groups[dT];if(dC.groups[dF]===undefined){dC.groups[dF]=[]}dC.groups[dF].push(dH)}}if(dM.children!==undefined){dh(dV,dM.children)}}}}}function di(dF,dE,dG){dC.geometries[dG]=dF;dC.face_materials[dG]=dE;dz()}function dd(dJ,dG,dM,dL,dK){var dH=dK.position;var dE=dK.rotation;var dF=dK.quaternion;var dN=dK.scale;dJ.position.set(dH[0],dH[1],dH[2]);if(dF){dJ.quaternion.set(dF[0],dF[1],dF[2],dF[3]);dJ.useQuaternion=true}else{dJ.rotation.set(dE[0],dE[1],dE[2])}dJ.scale.set(dN[0],dN[1],dN[2]);if(dL){dJ.traverse(function(dO){dO.material=dL})}var dI=(dK.visible!==undefined)?dK.visible:true;dJ.traverse(function(dO){dO.visible=dI});dM.add(dJ);dJ.name=dG;dC.objects[dG]=dJ;dz()}function cz(dE){return function(dG,dF){dG.name=dE;di(dG,dF,dE);cu-=1;dl.onLoadComplete();c7()}}function c2(dH,dF,dE,dG){return function(dJ){var dI;if(dJ.content){dI=dJ.content}else{if(dJ.dae){dI=dJ.scene}else{dI=dJ}}dd(dI,dH,dF,dE,dG);cu-=1;dl.onLoadComplete();c7()}}function cR(dE){return function(dG,dF){dG.name=dE;dC.geometries[dE]=dG;dC.face_materials[dE]=dF}}function c7(){var dE={totalModels:cH,totalTextures:c1,loadedModels:cH-cu,loadedTextures:c1-dx};dl.callbackProgress(dE,dC);dl.onLoadProgress();if(cu===0&&dx===0){dD();e(dC)}}function dD(){for(var dF=0;dF<df.length;dF++){var dE=df[dF];var dG=dC.objects[dE.targetName];if(dG){dE.object.target=dG}else{dE.object.target=new aH.Object3D();dC.scene.add(dE.object.target)}dE.object.target.userData.targetInverse=dE.object}}var dg=function(dE){dx-=dE;c7();dl.onLoadComplete()};var cF=function(dE){return function(){dg(dE)}};var cN,du;for(cN in cJ.fogs){du=cJ.fogs[cN];if(du.type==="linear"){cL=new aH.Fog(0,du.near,du.far)}else{if(du.type==="exp2"){cL=new aH.FogExp2(0,du.density)}}cM=du.color;cL.color.setRGB(cM[0],cM[1],cM[2]);dC.fogs[cN]=cL}var c6,dc;for(c6 in cJ.geometries){dc=cJ.geometries[c6];if(dc.type in this.geometryHandlerMap){cu+=1;dl.onLoadStart()}}var cy,c9;for(cy in cJ.objects){c9=cJ.objects[cy];if(c9.type&&(c9.type in this.hierarchyHandlerMap)){cu+=1;dl.onLoadStart()}}cH=cu;for(c6 in cJ.geometries){dc=cJ.geometries[c6];if(dc.type==="cube"){dm=new aH.CubeGeometry(dc.width,dc.height,dc.depth,dc.widthSegments,dc.heightSegments,dc.depthSegments);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type==="plane"){dm=new aH.PlaneGeometry(dc.width,dc.height,dc.widthSegments,dc.heightSegments);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type==="sphere"){dm=new aH.SphereGeometry(dc.radius,dc.widthSegments,dc.heightSegments);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type==="cylinder"){dm=new aH.CylinderGeometry(dc.topRad,dc.botRad,dc.height,dc.radSegs,dc.heightSegs);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type==="torus"){dm=new aH.TorusGeometry(dc.radius,dc.tube,dc.segmentsR,dc.segmentsT);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type==="icosahedron"){dm=new aH.IcosahedronGeometry(dc.radius,dc.subdivisions);dm.name=c6;dC.geometries[c6]=dm}else{if(dc.type in this.geometryHandlerMap){var c4={};for(var cV in dc){if(cV!=="type"&&cV!=="url"){c4[cV]=dc[cV]}}var cT=this.geometryHandlerMap[dc.type]["loaderObject"];cT.load(cS(dc.url,cJ.urlBaseType),cz(c6),c4)}else{if(dc.type==="embedded"){var cB=cJ.embeds[dc.id],cr="";cB.metadata=cJ.metadata;if(cB){var cZ=this.geometryHandlerMap.ascii["loaderObject"];var cP=cZ.parse(cB,cr);cR(c6)(cP.geometry,cP.materials)}}}}}}}}}}var dp,db;for(dp in cJ.textures){db=cJ.textures[dp];if(db.url instanceof Array){dx+=db.url.length;for(var cY=0;cY<db.url.length;cY++){dl.onLoadStart()}}else{dx+=1;dl.onLoadStart()}}c1=dx;for(dp in cJ.textures){db=cJ.textures[dp];if(db.mapping!==undefined&&aH[db.mapping]!==undefined){db.mapping=new aH[db.mapping]()}if(db.url instanceof Array){var cx=db.url.length;var cW=[];for(var c0=0;c0<cx;c0++){cW[c0]=cS(db.url[c0],cJ.urlBaseType)}var cA=/\.dds$/i.test(cW[0]);if(cA){dq=aH.ImageUtils.loadCompressedTextureCube(cW,db.mapping,cF(cx))}else{dq=aH.ImageUtils.loadTextureCube(cW,db.mapping,cF(cx))}}else{var cA=/\.dds$/i.test(db.url);var ds=cS(db.url,cJ.urlBaseType);var dA=cF(1);if(cA){dq=aH.ImageUtils.loadCompressedTexture(ds,db.mapping,dA)}else{dq=aH.ImageUtils.loadTexture(ds,db.mapping,dA)}if(aH[db.minFilter]!==undefined){dq.minFilter=aH[db.minFilter]}if(aH[db.magFilter]!==undefined){dq.magFilter=aH[db.magFilter]}if(db.anisotropy){dq.anisotropy=db.anisotropy}if(db.repeat){dq.repeat.set(db.repeat[0],db.repeat[1]);if(db.repeat[0]!==1){dq.wrapS=aH.RepeatWrapping}if(db.repeat[1]!==1){dq.wrapT=aH.RepeatWrapping}}if(db.offset){dq.offset.set(db.offset[0],db.offset[1])}if(db.wrap){var c3={repeat:aH.RepeatWrapping,mirror:aH.MirroredRepeatWrapping};if(c3[db.wrap[0]]!==undefined){dq.wrapS=c3[db.wrap[0]]}if(c3[db.wrap[1]]!==undefined){dq.wrapT=c3[db.wrap[1]]}}}dC.textures[dp]=dq}var cG,dy;var de;for(cG in cJ.materials){dy=cJ.materials[cG];for(de in dy.parameters){if(de==="envMap"||de==="map"||de==="lightMap"||de==="bumpMap"){dy.parameters[de]=dC.textures[dy.parameters[de]]}else{if(de==="shading"){dy.parameters[de]=(dy.parameters[de]==="flat")?aH.FlatShading:aH.SmoothShading}else{if(de==="side"){if(dy.parameters[de]=="double"){dy.parameters[de]=aH.DoubleSide}else{if(dy.parameters[de]=="back"){dy.parameters[de]=aH.BackSide}else{dy.parameters[de]=aH.FrontSide}}}else{if(de==="blending"){dy.parameters[de]=dy.parameters[de] in aH?aH[dy.parameters[de]]:aH.NormalBlending}else{if(de==="combine"){dy.parameters[de]=dy.parameters[de] in aH?aH[dy.parameters[de]]:aH.MultiplyOperation}else{if(de==="vertexColors"){if(dy.parameters[de]=="face"){dy.parameters[de]=aH.FaceColors}else{if(dy.parameters[de]){dy.parameters[de]=aH.VertexColors}}}else{if(de==="wrapRGB"){var da=dy.parameters[de];dy.parameters[de]=new aH.Vector3(da[0],da[1],da[2])}}}}}}}}if(dy.parameters.opacity!==undefined&&dy.parameters.opacity<1){dy.parameters.transparent=true}if(dy.parameters.normalMap){var dr=aH.ShaderLib.normalmap;var cI=aH.UniformsUtils.clone(dr.uniforms);var cC=dy.parameters.color;var cs=dy.parameters.specular;var cU=dy.parameters.ambient;var c5=dy.parameters.shininess;cI.tNormal.value=dC.textures[dy.parameters.normalMap];if(dy.parameters.normalScale){cI.uNormalScale.value.set(dy.parameters.normalScale[0],dy.parameters.normalScale[1])}if(dy.parameters.map){cI.tDiffuse.value=dy.parameters.map;cI.enableDiffuse.value=true}if(dy.parameters.envMap){cI.tCube.value=dy.parameters.envMap;cI.enableReflection.value=true;cI.uReflectivity.value=dy.parameters.reflectivity}if(dy.parameters.lightMap){cI.tAO.value=dy.parameters.lightMap;cI.enableAO.value=true}if(dy.parameters.specularMap){cI.tSpecular.value=dC.textures[dy.parameters.specularMap];cI.enableSpecular.value=true}if(dy.parameters.displacementMap){cI.tDisplacement.value=dC.textures[dy.parameters.displacementMap];cI.enableDisplacement.value=true;cI.uDisplacementBias.value=dy.parameters.displacementBias;cI.uDisplacementScale.value=dy.parameters.displacementScale}cI.uDiffuseColor.value.setHex(cC);cI.uSpecularColor.value.setHex(cs);cI.uAmbientColor.value.setHex(cU);cI.uShininess.value=c5;if(dy.parameters.opacity){cI.uOpacity.value=dy.parameters.opacity}var cQ={fragmentShader:dr.fragmentShader,vertexShader:dr.vertexShader,uniforms:cI,lights:true,fog:true};dB=new aH.ShaderMaterial(cQ)}else{dB=new aH[dy.type](dy.parameters)}dB.name=cG;dC.materials[cG]=dB}for(cG in cJ.materials){dy=cJ.materials[cG];if(dy.parameters.materials){var cK=[];for(var c0=0;c0<dy.parameters.materials.length;c0++){var cE=dy.parameters.materials[c0];cK.push(dC.materials[cE])}dC.materials[cG].materials=cK}}dz();if(dC.cameras&&cJ.defaults.camera){dC.currentCamera=dC.cameras[cJ.defaults.camera]}if(dC.fogs&&cJ.defaults.fog){dC.scene.fog=dC.fogs[cJ.defaults.fog]}dl.callbackSync(dC);c7()};aH.TextureLoader=function(){this.crossOrigin=null};aH.TextureLoader.prototype={constructor:aH.TextureLoader,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,load:function(e){var cr=this;var cs=new Image();cs.addEventListener("load",function(){var ct=new aH.Texture(cs);ct.needsUpdate=true;cr.dispatchEvent({type:"load",content:ct})},false);cs.addEventListener("error",function(){cr.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},false);if(cr.crossOrigin){cs.crossOrigin=cr.crossOrigin}cs.src=e}};aH.Material=function(){this.id=aH.MaterialIdCount++;this.name="";this.side=aH.FrontSide;this.opacity=1;this.transparent=false;this.blending=aH.NormalBlending;this.blendSrc=aH.SrcAlphaFactor;this.blendDst=aH.OneMinusSrcAlphaFactor;this.blendEquation=aH.AddEquation;this.depthTest=true;this.depthWrite=true;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.alphaTest=0;this.overdraw=false;this.visible=true;this.needsUpdate=true};aH.Material.prototype={constructor:aH.Material,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,setValues:function(e){if(e===undefined){return}for(var cr in e){var ct=e[cr];if(ct===undefined){console.warn("THREE.Material: '"+cr+"' parameter is undefined.");continue}if(cr in this){var cs=this[cr];if(cs instanceof aH.Color){cs.set(ct)}else{if(cs instanceof aH.Vector3&&ct instanceof aH.Vector3){cs.copy(ct)}else{this[cr]=ct}}}}},clone:function(e){if(e===undefined){e=new aH.Material()}e.name=this.name;e.side=this.side;e.opacity=this.opacity;e.transparent=this.transparent;e.blending=this.blending;e.blendSrc=this.blendSrc;e.blendDst=this.blendDst;e.blendEquation=this.blendEquation;e.depthTest=this.depthTest;e.depthWrite=this.depthWrite;e.polygonOffset=this.polygonOffset;e.polygonOffsetFactor=this.polygonOffsetFactor;e.polygonOffsetUnits=this.polygonOffsetUnits;e.alphaTest=this.alphaTest;e.overdraw=this.overdraw;e.visible=this.visible;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};aH.MaterialIdCount=0;aH.LineBasicMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.vertexColors=false;this.fog=true;this.setValues(e)};aH.LineBasicMaterial.prototype=Object.create(aH.Material.prototype);aH.LineBasicMaterial.prototype.clone=function(){var e=new aH.LineBasicMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.linecap=this.linecap;e.linejoin=this.linejoin;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};aH.LineDashedMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.linewidth=1;this.scale=1;this.dashSize=3;this.gapSize=1;this.vertexColors=false;this.fog=true;this.setValues(e)};aH.LineDashedMaterial.prototype=Object.create(aH.Material.prototype);aH.LineDashedMaterial.prototype.clone=function(){var e=new aH.LineDashedMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.linewidth=this.linewidth;e.scale=this.scale;e.dashSize=this.dashSize;e.gapSize=this.gapSize;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};aH.MeshBasicMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=aH.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=aH.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=aH.NoColors;this.skinning=false;this.morphTargets=false;this.setValues(e)};aH.MeshBasicMaterial.prototype=Object.create(aH.Material.prototype);aH.MeshBasicMaterial.prototype.clone=function(){var e=new aH.MeshBasicMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;return e};aH.MeshLambertMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.ambient=new aH.Color(16777215);this.emissive=new aH.Color(0);this.wrapAround=false;this.wrapRGB=new aH.Vector3(1,1,1);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=aH.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=aH.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=aH.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)};aH.MeshLambertMaterial.prototype=Object.create(aH.Material.prototype);aH.MeshLambertMaterial.prototype.clone=function(){var e=new aH.MeshLambertMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};aH.MeshPhongMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.ambient=new aH.Color(16777215);this.emissive=new aH.Color(0);this.specular=new aH.Color(1118481);this.shininess=30;this.metal=false;this.perPixel=true;this.wrapAround=false;this.wrapRGB=new aH.Vector3(1,1,1);this.map=null;this.lightMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new aH.Vector2(1,1);this.specularMap=null;this.envMap=null;this.combine=aH.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=aH.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=aH.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)};aH.MeshPhongMaterial.prototype=Object.create(aH.Material.prototype);aH.MeshPhongMaterial.prototype.clone=function(){var e=new aH.MeshPhongMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.ambient.copy(this.ambient);e.emissive.copy(this.emissive);e.specular.copy(this.specular);e.shininess=this.shininess;e.metal=this.metal;e.perPixel=this.perPixel;e.wrapAround=this.wrapAround;e.wrapRGB.copy(this.wrapRGB);e.map=this.map;e.lightMap=this.lightMap;e.bumpMap=this.bumpMap;e.bumpScale=this.bumpScale;e.normalMap=this.normalMap;e.normalScale.copy(this.normalScale);e.specularMap=this.specularMap;e.envMap=this.envMap;e.combine=this.combine;e.reflectivity=this.reflectivity;e.refractionRatio=this.refractionRatio;e.fog=this.fog;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.wireframeLinecap=this.wireframeLinecap;e.wireframeLinejoin=this.wireframeLinejoin;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};aH.MeshDepthMaterial=function(e){aH.Material.call(this);this.wireframe=false;this.wireframeLinewidth=1;this.setValues(e)};aH.MeshDepthMaterial.prototype=Object.create(aH.Material.prototype);aH.MeshDepthMaterial.prototype.clone=function(){var e=new aH.MeshDepthMaterial();aH.Material.prototype.clone.call(this,e);e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};aH.MeshNormalMaterial=function(e){aH.Material.call(this,e);this.shading=aH.FlatShading;this.wireframe=false;this.wireframeLinewidth=1;this.morphTargets=false;this.setValues(e)};aH.MeshNormalMaterial.prototype=Object.create(aH.Material.prototype);aH.MeshNormalMaterial.prototype.clone=function(){var e=new aH.MeshNormalMaterial();aH.Material.prototype.clone.call(this,e);e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;return e};aH.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]};aH.MeshFaceMaterial.prototype.clone=function(){return new aH.MeshFaceMaterial(this.materials.slice(0))};aH.ParticleBasicMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.vertexColors=false;this.fog=true;this.setValues(e)};aH.ParticleBasicMaterial.prototype=Object.create(aH.Material.prototype);aH.ParticleBasicMaterial.prototype.clone=function(){var e=new aH.ParticleBasicMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.size=this.size;e.sizeAttenuation=this.sizeAttenuation;e.vertexColors=this.vertexColors;e.fog=this.fog;return e};aH.ParticleCanvasMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.program=function(cs,cr){};this.setValues(e)};aH.ParticleCanvasMaterial.prototype=Object.create(aH.Material.prototype);aH.ParticleCanvasMaterial.prototype.clone=function(){var e=new aH.ParticleCanvasMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.program=this.program;return e};aH.ShaderMaterial=function(e){aH.Material.call(this);this.fragmentShader="void main() {}";this.vertexShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=aH.SmoothShading;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.vertexColors=aH.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)};aH.ShaderMaterial.prototype=Object.create(aH.Material.prototype);aH.ShaderMaterial.prototype.clone=function(){var e=new aH.ShaderMaterial();aH.Material.prototype.clone.call(this,e);e.fragmentShader=this.fragmentShader;e.vertexShader=this.vertexShader;e.uniforms=aH.UniformsUtils.clone(this.uniforms);e.attributes=this.attributes;e.defines=this.defines;e.shading=this.shading;e.wireframe=this.wireframe;e.wireframeLinewidth=this.wireframeLinewidth;e.fog=this.fog;e.lights=this.lights;e.vertexColors=this.vertexColors;e.skinning=this.skinning;e.morphTargets=this.morphTargets;e.morphNormals=this.morphNormals;return e};aH.SpriteMaterial=function(e){aH.Material.call(this);this.color=new aH.Color(16777215);this.map=new aH.Texture();this.useScreenCoordinates=true;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=aH.SpriteAlignment.center.clone();this.fog=false;this.uvOffset=new aH.Vector2(0,0);this.uvScale=new aH.Vector2(1,1);this.setValues(e);e=e||{};if(e.depthTest===undefined){this.depthTest=!this.useScreenCoordinates}if(e.sizeAttenuation===undefined){this.sizeAttenuation=!this.useScreenCoordinates}if(e.scaleByViewport===undefined){this.scaleByViewport=!this.sizeAttenuation}};aH.SpriteMaterial.prototype=Object.create(aH.Material.prototype);aH.SpriteMaterial.prototype.clone=function(){var e=new aH.SpriteMaterial();aH.Material.prototype.clone.call(this,e);e.color.copy(this.color);e.map=this.map;e.useScreenCoordinates=this.useScreenCoordinates;e.sizeAttenuation=this.sizeAttenuation;e.scaleByViewport=this.scaleByViewport;e.alignment.copy(this.alignment);e.uvOffset.copy(this.uvOffset);e.uvScale.copy(this.uvScale);e.fog=this.fog;return e};aH.SpriteAlignment={};aH.SpriteAlignment.topLeft=new aH.Vector2(1,-1);aH.SpriteAlignment.topCenter=new aH.Vector2(0,-1);aH.SpriteAlignment.topRight=new aH.Vector2(-1,-1);aH.SpriteAlignment.centerLeft=new aH.Vector2(1,0);aH.SpriteAlignment.center=new aH.Vector2(0,0);aH.SpriteAlignment.centerRight=new aH.Vector2(-1,0);aH.SpriteAlignment.bottomLeft=new aH.Vector2(1,1);aH.SpriteAlignment.bottomCenter=new aH.Vector2(0,1);aH.SpriteAlignment.bottomRight=new aH.Vector2(-1,1);aH.Texture=function(ct,cr,cv,cu,cy,cs,cx,cw,e){this.id=aH.TextureIdCount++;this.name="";this.image=ct;this.mipmaps=[];this.mapping=cr!==undefined?cr:new aH.UVMapping();this.wrapS=cv!==undefined?cv:aH.ClampToEdgeWrapping;this.wrapT=cu!==undefined?cu:aH.ClampToEdgeWrapping;this.magFilter=cy!==undefined?cy:aH.LinearFilter;this.minFilter=cs!==undefined?cs:aH.LinearMipMapLinearFilter;this.anisotropy=e!==undefined?e:1;this.format=cx!==undefined?cx:aH.RGBAFormat;this.type=cw!==undefined?cw:aH.UnsignedByteType;this.offset=new aH.Vector2(0,0);this.repeat=new aH.Vector2(1,1);this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.needsUpdate=false;this.onUpdate=null};aH.Texture.prototype={constructor:aH.Texture,addEventListener:aH.EventDispatcher.prototype.addEventListener,hasEventListener:aH.EventDispatcher.prototype.hasEventListener,removeEventListener:aH.EventDispatcher.prototype.removeEventListener,dispatchEvent:aH.EventDispatcher.prototype.dispatchEvent,clone:function(e){if(e===undefined){e=new aH.Texture()}e.image=this.image;e.mipmaps=this.mipmaps.slice(0);e.mapping=this.mapping;e.wrapS=this.wrapS;e.wrapT=this.wrapT;e.magFilter=this.magFilter;e.minFilter=this.minFilter;e.anisotropy=this.anisotropy;e.format=this.format;e.type=this.type;e.offset.copy(this.offset);e.repeat.copy(this.repeat);e.generateMipmaps=this.generateMipmaps;e.premultiplyAlpha=this.premultiplyAlpha;e.flipY=this.flipY;e.unpackAlignment=this.unpackAlignment;return e},dispose:function(){this.dispatchEvent({type:"dispose"})}};aH.TextureIdCount=0;aH.CompressedTexture=function(cu,ct,cA,cy,cx,cr,cw,cv,cz,cs,e){aH.Texture.call(this,null,cr,cw,cv,cz,cs,cy,cx,e);this.image={width:ct,height:cA};this.mipmaps=cu;this.generateMipmaps=false};aH.CompressedTexture.prototype=Object.create(aH.Texture.prototype);aH.CompressedTexture.prototype.clone=function(){var e=new aH.CompressedTexture();aH.Texture.prototype.clone.call(this,e);return e};aH.DataTexture=function(cv,ct,cA,cy,cx,cr,cw,cu,cz,cs,e){aH.Texture.call(this,null,cr,cw,cu,cz,cs,cy,cx,e);this.image={data:cv,width:ct,height:cA}};aH.DataTexture.prototype=Object.create(aH.Texture.prototype);aH.DataTexture.prototype.clone=function(){var e=new aH.DataTexture();aH.Texture.prototype.clone.call(this,e);return e};aH.Particle=function(e){aH.Object3D.call(this);this.material=e};aH.Particle.prototype=Object.create(aH.Object3D.prototype);aH.Particle.prototype.clone=function(e){if(e===undefined){e=new aH.Particle(this.material)}aH.Object3D.prototype.clone.call(this,e);return e};aH.ParticleSystem=function(cr,e){aH.Object3D.call(this);this.geometry=cr;this.material=(e!==undefined)?e:new aH.ParticleBasicMaterial({color:Math.random()*16777215});this.sortParticles=false;if(this.geometry){if(this.geometry.boundingSphere===null){this.geometry.computeBoundingSphere()}}this.frustumCulled=false};aH.ParticleSystem.prototype=Object.create(aH.Object3D.prototype);aH.ParticleSystem.prototype.clone=function(e){if(e===undefined){e=new aH.ParticleSystem(this.geometry,this.material)}e.sortParticles=this.sortParticles;aH.Object3D.prototype.clone.call(this,e);return e};aH.Line=function(cs,cr,e){aH.Object3D.call(this);this.geometry=cs;this.material=(cr!==undefined)?cr:new aH.LineBasicMaterial({color:Math.random()*16777215});this.type=(e!==undefined)?e:aH.LineStrip;if(this.geometry){if(!this.geometry.boundingSphere){this.geometry.computeBoundingSphere()}}};aH.LineStrip=0;aH.LinePieces=1;aH.Line.prototype=Object.create(aH.Object3D.prototype);aH.Line.prototype.clone=function(e){if(e===undefined){e=new aH.Line(this.geometry,this.material,this.type)}aH.Object3D.prototype.clone.call(this,e);return e};aH.Mesh=function(cr,e){aH.Object3D.call(this);this.geometry=null;this.material=null;this.setGeometry(cr);this.setMaterial(e)};aH.Mesh.prototype=Object.create(aH.Object3D.prototype);aH.Mesh.prototype.setGeometry=function(e){if(e!==undefined){this.geometry=e;if(this.geometry.boundingSphere===null){this.geometry.computeBoundingSphere()}this.updateMorphTargets()}};aH.Mesh.prototype.setMaterial=function(e){if(e!==undefined){this.material=e}else{this.material=new aH.MeshBasicMaterial({color:Math.random()*16777215,wireframe:true})}};aH.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var e=0,cr=this.geometry.morphTargets.length;e<cr;e++){this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}}};aH.Mesh.prototype.getMorphTargetIndexByName=function(e){if(this.morphTargetDictionary[e]!==undefined){return this.morphTargetDictionary[e]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0.");return 0};aH.Mesh.prototype.clone=function(e){if(e===undefined){e=new aH.Mesh(this.geometry,this.material)}aH.Object3D.prototype.clone.call(this,e);return e};aH.Bone=function(e){aH.Object3D.call(this);this.skin=e;this.skinMatrix=new aH.Matrix4()};aH.Bone.prototype=Object.create(aH.Object3D.prototype);aH.Bone.prototype.update=function(ct,cr){if(this.matrixAutoUpdate){cr|=this.updateMatrix()}if(cr||this.matrixWorldNeedsUpdate){if(ct){this.skinMatrix.multiplyMatrices(ct,this.matrix)}else{this.skinMatrix.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;cr=true}var cu,cs,e=this.children.length;for(cs=0;cs<e;cs++){this.children[cs].update(this.skinMatrix,cr)}};aH.SkinnedMesh=function(cu,ct,cs){aH.Mesh.call(this,cu,ct);this.useVertexTexture=cs!==undefined?cs:true;this.identityMatrix=new aH.Matrix4();this.bones=[];this.boneMatrices=[];var cv,cx,cy,cr,e,cA;if(this.geometry&&this.geometry.bones!==undefined){for(cv=0;cv<this.geometry.bones.length;cv++){cy=this.geometry.bones[cv];cr=cy.pos;e=cy.rotq;cA=cy.scl;cx=this.addBone();cx.name=cy.name;cx.position.set(cr[0],cr[1],cr[2]);cx.quaternion.set(e[0],e[1],e[2],e[3]);cx.useQuaternion=true;if(cA!==undefined){cx.scale.set(cA[0],cA[1],cA[2])}else{cx.scale.set(1,1,1)}}for(cv=0;cv<this.bones.length;cv++){cy=this.geometry.bones[cv];cx=this.bones[cv];if(cy.parent===-1){this.add(cx)}else{this.bones[cy.parent].add(cx)}}var cw=this.bones.length;if(this.useVertexTexture){var cz;if(cw>256){cz=64}else{if(cw>64){cz=32}else{if(cw>16){cz=16}else{cz=8}}}this.boneTextureWidth=cz;this.boneTextureHeight=cz;this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4);this.boneTexture=new aH.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,aH.RGBAFormat,aH.FloatType);this.boneTexture.minFilter=aH.NearestFilter;this.boneTexture.magFilter=aH.NearestFilter;this.boneTexture.generateMipmaps=false;this.boneTexture.flipY=false}else{this.boneMatrices=new Float32Array(16*cw)}this.pose()}};aH.SkinnedMesh.prototype=Object.create(aH.Mesh.prototype);aH.SkinnedMesh.prototype.addBone=function(e){if(e===undefined){e=new aH.Bone(this)}this.bones.push(e);return e};aH.SkinnedMesh.prototype.updateMatrixWorld=function(cu){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||cu){if(this.parent){this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}else{this.matrixWorld.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;cu=true}for(var ct=0,cs=this.children.length;ct<cs;ct++){var cw=this.children[ct];if(cw instanceof aH.Bone){cw.update(this.identityMatrix,false)}else{cw.updateMatrixWorld(true)}}if(this.boneInverses==undefined){this.boneInverses=[];for(var e=0,cv=this.bones.length;e<cv;e++){var cr=new aH.Matrix4();cr.getInverse(this.bones[e].skinMatrix);this.boneInverses.push(cr)}}for(var e=0,cv=this.bones.length;e<cv;e++){aH.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[e].skinMatrix,this.boneInverses[e]);aH.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,e*16)}if(this.useVertexTexture){this.boneTexture.needsUpdate=true}};aH.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(true);for(var cr=0;cr<this.geometry.skinIndices.length;cr++){var e=this.geometry.skinWeights[cr];var cs=1/e.lengthManhattan();if(cs!==Infinity){e.multiplyScalar(cs)}else{e.set(1)}}};aH.SkinnedMesh.prototype.clone=function(e){if(e===undefined){e=new aH.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)}aH.Mesh.prototype.clone.call(this,e);return e};aH.SkinnedMesh.offsetMatrix=new aH.Matrix4();aH.MorphAnimMesh=function(cr,e){aH.Mesh.call(this,cr,e);this.duration=1000;this.mirroredLoop=false;this.time=0;this.lastKeyframe=0;this.currentKeyframe=0;this.direction=1;this.directionBackwards=false;this.setFrameRange(0,this.geometry.morphTargets.length-1)};aH.MorphAnimMesh.prototype=Object.create(aH.Mesh.prototype);aH.MorphAnimMesh.prototype.setFrameRange=function(cr,e){this.startKeyframe=cr;this.endKeyframe=e;this.length=this.endKeyframe-this.startKeyframe+1};aH.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=false};aH.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=true};aH.MorphAnimMesh.prototype.parseAnimations=function(){var cw=this.geometry;if(!cw.animations){cw.animations={}}var e,cA=cw.animations;var cv=/([a-z]+)(\d+)/;for(var ct=0,cy=cw.morphTargets.length;ct<cy;ct++){var cz=cw.morphTargets[ct];var cs=cz.name.match(cv);if(cs&&cs.length>1){var cx=cs[1];var cu=cs[2];if(!cA[cx]){cA[cx]={start:Infinity,end:-Infinity}}var cr=cA[cx];if(ct<cr.start){cr.start=ct}if(ct>cr.end){cr.end=ct}if(!e){e=cx}}}cw.firstAnimation=e};aH.MorphAnimMesh.prototype.setAnimationLabel=function(cr,cs,e){if(!this.geometry.animations){this.geometry.animations={}}this.geometry.animations[cr]={start:cs,end:e}};aH.MorphAnimMesh.prototype.playAnimation=function(e,cs){var cr=this.geometry.animations[e];if(cr){this.setFrameRange(cr.start,cr.end);this.duration=1000*((cr.end-cr.start)/cs);this.time=0}else{console.warn("animation["+e+"] undefined")}};aH.MorphAnimMesh.prototype.updateAnimation=function(ct){var cs=this.duration/this.length;this.time+=this.direction*ct;if(this.mirroredLoop){if(this.time>this.duration||this.time<0){this.direction*=-1;if(this.time>this.duration){this.time=this.duration;this.directionBackwards=true}if(this.time<0){this.time=0;this.directionBackwards=false}}}else{this.time=this.time%this.duration;if(this.time<0){this.time+=this.duration}}var e=this.startKeyframe+aH.Math.clamp(Math.floor(this.time/cs),0,this.length-1);if(e!==this.currentKeyframe){this.morphTargetInfluences[this.lastKeyframe]=0;this.morphTargetInfluences[this.currentKeyframe]=1;this.morphTargetInfluences[e]=0;this.lastKeyframe=this.currentKeyframe;this.currentKeyframe=e}var cr=(this.time%cs)/cs;if(this.directionBackwards){cr=1-cr}this.morphTargetInfluences[this.currentKeyframe]=cr;this.morphTargetInfluences[this.lastKeyframe]=1-cr};aH.MorphAnimMesh.prototype.clone=function(e){if(e===undefined){e=new aH.MorphAnimMesh(this.geometry,this.material)}e.duration=this.duration;e.mirroredLoop=this.mirroredLoop;e.time=this.time;e.lastKeyframe=this.lastKeyframe;e.currentKeyframe=this.currentKeyframe;e.direction=this.direction;e.directionBackwards=this.directionBackwards;aH.Mesh.prototype.clone.call(this,e);return e};aH.Ribbon=function(cr,e){aH.Object3D.call(this);this.geometry=cr;this.material=e};aH.Ribbon.prototype=Object.create(aH.Object3D.prototype);aH.Ribbon.prototype.clone=function(e){if(e===undefined){e=new aH.Ribbon(this.geometry,this.material)}aH.Object3D.prototype.clone.call(this,e);return e};aH.LOD=function(){aH.Object3D.call(this);this.objects=[]};aH.LOD.prototype=Object.create(aH.Object3D.prototype);aH.LOD.prototype.addLevel=function(cr,cs){if(cs===undefined){cs=0}cs=Math.abs(cs);for(var e=0;e<this.objects.length;e++){if(cs<this.objects[e].distance){break}}this.objects.splice(e,0,{distance:cs,object:cr});this.add(cr)};aH.LOD.prototype.getObjectForDistance=function(cs){for(var cr=1,e=this.objects.length;cr<e;cr++){if(cs<this.objects[cr].distance){break}}return this.objects[cr-1].object};aH.LOD.prototype.update=function(){var cr=new aH.Vector3();var e=new aH.Vector3();return function(cu){if(this.objects.length>1){cr.getPositionFromMatrix(cu.matrixWorld);e.getPositionFromMatrix(this.matrixWorld);var cv=cr.distanceTo(e);this.objects[0].object.visible=true;for(var ct=1,cs=this.objects.length;ct<cs;ct++){if(cv>=this.objects[ct].distance){this.objects[ct-1].object.visible=false;this.objects[ct].object.visible=true}else{break}}for(;ct<cs;ct++){this.objects[ct].object.visible=false}}}}();aH.LOD.prototype.clone=function(){};aH.Sprite=function(e){aH.Object3D.call(this);this.material=(e!==undefined)?e:new aH.SpriteMaterial();this.rotation3d=this.rotation;this.rotation=0};aH.Sprite.prototype=Object.create(aH.Object3D.prototype);aH.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation);this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder);this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true};aH.Sprite.prototype.clone=function(e){if(e===undefined){e=new aH.Sprite(this.material)}aH.Object3D.prototype.clone.call(this,e);return e};aH.Scene=function(){aH.Object3D.call(this);this.fog=null;this.overrideMaterial=null;this.autoUpdate=true;this.matrixAutoUpdate=false;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};aH.Scene.prototype=Object.create(aH.Object3D.prototype);aH.Scene.prototype.__addObject=function(e){if(e instanceof aH.Light){if(this.__lights.indexOf(e)===-1){this.__lights.push(e)}if(e.target&&e.target.parent===undefined){this.add(e.target)}}else{if(!(e instanceof aH.Camera||e instanceof aH.Bone)){if(this.__objects.indexOf(e)===-1){this.__objects.push(e);this.__objectsAdded.push(e);var cr=this.__objectsRemoved.indexOf(e);if(cr!==-1){this.__objectsRemoved.splice(cr,1)}}}}for(var cs=0;cs<e.children.length;cs++){this.__addObject(e.children[cs])}};aH.Scene.prototype.__removeObject=function(cr){if(cr instanceof aH.Light){var cs=this.__lights.indexOf(cr);if(cs!==-1){this.__lights.splice(cs,1)}}else{if(!(cr instanceof aH.Camera)){var cs=this.__objects.indexOf(cr);if(cs!==-1){this.__objects.splice(cs,1);this.__objectsRemoved.push(cr);var e=this.__objectsAdded.indexOf(cr);if(e!==-1){this.__objectsAdded.splice(e,1)}}}}for(var ct=0;ct<cr.children.length;ct++){this.__removeObject(cr.children[ct])}};aH.CanvasRenderer=function(cQ){var dB=aH.Math.smoothstep;cQ=cQ||{};var cJ=this,cN,cR,cA,e=new aH.Projector(),cv=cQ.canvas!==undefined?cQ.canvas:document.createElement("canvas"),cL,dA,dl,cU,ct=cv.getContext("2d"),cS=new aH.Color(0),dw=0,dC=1,dy=0,cK=null,dx=null,cX=null,cy=null,dt=null,cV=null,dp=0,dk,di,dg,df,de=new aH.RenderableVertex(),dc=new aH.RenderableVertex(),cI,cH,cs,cr,dJ,dG,dv,du,c8,c6,c0,cZ,cu=new aH.Color(),cE=new aH.Color(),cD=new aH.Color(),cC=new aH.Color(),cB=new aH.Color(),da=new aH.Color(),cF=new aH.Color(),dr=new aH.Color(),cT={},c4={},c3,dM,db,cx,dI,dE,ds,dq,c7,c5,dL=new aH.Box2(),cG=new aH.Box2(),cM=new aH.Box2(),dD=new aH.Color(),cP=new aH.Color(),dh=new aH.Color(),cz=new aH.Vector3(),dH,cw,dK,c2,cY,c1,dj=16;dH=document.createElement("canvas");dH.width=dH.height=2;cw=dH.getContext("2d");cw.fillStyle="rgba(0,0,0,1)";cw.fillRect(0,0,2,2);dK=cw.getImageData(0,0,2,2);c2=dK.data;cY=document.createElement("canvas");cY.width=cY.height=dj;c1=cY.getContext("2d");c1.translate(-dj/2,-dj/2);c1.scale(dj,dj);dj--;if(ct.setLineDash===undefined){if(ct.mozDash!==undefined){ct.setLineDash=function(dN){ct.mozDash=dN[0]!==null?dN:null}}else{ct.setLineDash=function(){}}}this.domElement=cv;this.devicePixelRatio=cQ.devicePixelRatio!==undefined?cQ.devicePixelRatio:window.devicePixelRatio!==undefined?window.devicePixelRatio:1;this.autoClear=true;this.sortObjects=true;this.sortElements=true;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(dO,dN,dP){cL=dO*this.devicePixelRatio;dA=dN*this.devicePixelRatio;dl=Math.floor(cL/2);cU=Math.floor(dA/2);cv.width=cL;cv.height=dA;if(this.devicePixelRatio!==1&&dP!==false){cv.style.width=dO+"px";cv.style.height=dN+"px"}dL.set(new aH.Vector2(-dl,-cU),new aH.Vector2(dl,cU));cG.set(new aH.Vector2(-dl,-cU),new aH.Vector2(dl,cU));dC=1;dy=0;cK=null;dx=null;cX=null;cy=null;dt=null};this.setClearColor=function(dN,dO){cS.set(dN);dw=dO!==undefined?dO:1;cG.set(new aH.Vector2(-dl,-cU),new aH.Vector2(dl,cU))};this.setClearColorHex=function(dN,dO){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(dN,dO)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){ct.setTransform(1,0,0,-1,dl,cU);if(cG.empty()===false){cG.intersect(dL);cG.expandByScalar(2);if(dw<1){ct.clearRect(cG.min.x|0,cG.min.y|0,(cG.max.x-cG.min.x)|0,(cG.max.y-cG.min.y)|0)}if(dw>0){dn(aH.NormalBlending);cO(1);dm("rgba("+Math.floor(cS.r*255)+","+Math.floor(cS.g*255)+","+Math.floor(cS.b*255)+","+dw+")");ct.fillRect(cG.min.x|0,cG.min.y|0,(cG.max.x-cG.min.x)|0,(cG.max.y-cG.min.y)|0)}cG.makeEmpty()}};this.render=function(d3,d0){if(d0 instanceof aH.Camera===false){console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");return}if(this.autoClear===true){this.clear()}ct.setTransform(1,0,0,-1,dl,cU);cJ.info.render.vertices=0;cJ.info.render.faces=0;cN=e.projectScene(d3,d0,this.sortObjects,this.sortElements);cR=cN.elements;cA=cN.lights;dT();for(var d2=0,dQ=cR.length;d2<dQ;d2++){var dR=cR[d2];var dW=dR.material;if(dW===undefined||dW.visible===false){continue}cM.makeEmpty();if(dR instanceof aH.RenderableParticle){dk=dR;dk.x*=dl;dk.y*=cU;dV(dk,dR,dW)}else{if(dR instanceof aH.RenderableLine){dk=dR.v1;di=dR.v2;dk.positionScreen.x*=dl;dk.positionScreen.y*=cU;di.positionScreen.x*=dl;di.positionScreen.y*=cU;cM.setFromPoints([dk.positionScreen,di.positionScreen]);if(dL.isIntersectionBox(cM)===true){dP(dk,di,dR,dW)}}else{if(dR instanceof aH.RenderableFace3){dk=dR.v1;di=dR.v2;dg=dR.v3;if(dk.positionScreen.z<-1||dk.positionScreen.z>1){continue}if(di.positionScreen.z<-1||di.positionScreen.z>1){continue}if(dg.positionScreen.z<-1||dg.positionScreen.z>1){continue}dk.positionScreen.x*=dl;dk.positionScreen.y*=cU;di.positionScreen.x*=dl;di.positionScreen.y*=cU;dg.positionScreen.x*=dl;dg.positionScreen.y*=cU;if(dW.overdraw===true){dN(dk.positionScreen,di.positionScreen);dN(di.positionScreen,dg.positionScreen);dN(dg.positionScreen,dk.positionScreen)}cM.setFromPoints([dk.positionScreen,di.positionScreen,dg.positionScreen]);if(dL.isIntersectionBox(cM)===true){dU(dk,di,dg,0,1,2,dR,dW)}}else{if(dR instanceof aH.RenderableFace4){dk=dR.v1;di=dR.v2;dg=dR.v3;df=dR.v4;if(dk.positionScreen.z<-1||dk.positionScreen.z>1){continue}if(di.positionScreen.z<-1||di.positionScreen.z>1){continue}if(dg.positionScreen.z<-1||dg.positionScreen.z>1){continue}if(df.positionScreen.z<-1||df.positionScreen.z>1){continue}dk.positionScreen.x*=dl;dk.positionScreen.y*=cU;di.positionScreen.x*=dl;di.positionScreen.y*=cU;dg.positionScreen.x*=dl;dg.positionScreen.y*=cU;df.positionScreen.x*=dl;df.positionScreen.y*=cU;de.positionScreen.copy(di.positionScreen);dc.positionScreen.copy(df.positionScreen);if(dW.overdraw===true){dN(dk.positionScreen,di.positionScreen);dN(di.positionScreen,df.positionScreen);dN(df.positionScreen,dk.positionScreen);dN(dg.positionScreen,de.positionScreen);dN(dg.positionScreen,dc.positionScreen)}cM.setFromPoints([dk.positionScreen,di.positionScreen,dg.positionScreen,df.positionScreen]);if(dL.isIntersectionBox(cM)===true){dS(dk,di,dg,df,de,dc,dR,dW)}}}}}cG.union(cM)}ct.setTransform(1,0,0,1,0,0);function dT(){dD.setRGB(0,0,0);cP.setRGB(0,0,0);dh.setRGB(0,0,0);for(var d9=0,ea=cA.length;d9<ea;d9++){var d8=cA[d9];var d7=d8.color;if(d8 instanceof aH.AmbientLight){dD.add(d7)}else{if(d8 instanceof aH.DirectionalLight){cP.add(d7)}else{if(d8 instanceof aH.PointLight){dh.add(d7)}}}}}function dY(d7,ee,eb){for(var ea=0,ed=cA.length;ea<ed;ea++){var d9=cA[ea];dr.copy(d9.color);if(d9 instanceof aH.DirectionalLight){var d8=cz.getPositionFromMatrix(d9.matrixWorld).normalize();var ec=ee.dot(d8);if(ec<=0){continue}ec*=d9.intensity;eb.add(dr.multiplyScalar(ec))}else{if(d9 instanceof aH.PointLight){var d8=cz.getPositionFromMatrix(d9.matrixWorld);var ec=ee.dot(cz.subVectors(d8,d7).normalize());if(ec<=0){continue}ec*=d9.distance==0?1:1-Math.min(d7.distanceTo(d8)/d9.distance,1);if(ec==0){continue}ec*=d9.intensity;eb.add(dr.multiplyScalar(ec))}}}}function dV(ec,d9,ea){cO(ea.opacity);dn(ea.blending);var d7,eg,ee,ed,eb,ef,d8;if(ea instanceof aH.ParticleBasicMaterial){if(ea.map===null){ee=d9.object.scale.x;ed=d9.object.scale.y;ee*=d9.scale.x*dl;ed*=d9.scale.y*cU;cM.min.set(ec.x-ee,ec.y-ed);cM.max.set(ec.x+ee,ec.y+ed);if(dL.isIntersectionBox(cM)===false){cM.makeEmpty();return}dm(ea.color.getStyle());ct.save();ct.translate(ec.x,ec.y);ct.rotate(-d9.rotation);ct.scale(ee,ed);ct.fillRect(-1,-1,2,2);ct.restore()}else{eb=ea.map.image;ef=eb.width>>1;d8=eb.height>>1;ee=d9.scale.x*dl;ed=d9.scale.y*cU;d7=ee*ef;eg=ed*d8;cM.min.set(ec.x-d7,ec.y-eg);cM.max.set(ec.x+d7,ec.y+eg);if(dL.isIntersectionBox(cM)===false){cM.makeEmpty();return}ct.save();ct.translate(ec.x,ec.y);ct.rotate(-d9.rotation);ct.scale(ee,-ed);ct.translate(-ef,-d8);ct.drawImage(eb,0,0);ct.restore()}}else{if(ea instanceof aH.ParticleCanvasMaterial){d7=d9.scale.x*dl;eg=d9.scale.y*cU;cM.min.set(ec.x-d7,ec.y-eg);cM.max.set(ec.x+d7,ec.y+eg);if(dL.isIntersectionBox(cM)===false){cM.makeEmpty();return}dz(ea.color.getStyle());dm(ea.color.getStyle());ct.save();ct.translate(ec.x,ec.y);ct.rotate(-d9.rotation);ct.scale(d7,eg);ea.program(ct);ct.restore()}}}function dP(ee,ec,ea,eb){cO(eb.opacity);dn(eb.blending);ct.beginPath();ct.moveTo(ee.positionScreen.x,ee.positionScreen.y);ct.lineTo(ec.positionScreen.x,ec.positionScreen.y);if(eb instanceof aH.LineBasicMaterial){cW(eb.linewidth);dd(eb.linecap);dF(eb.linejoin);if(eb.vertexColors!==aH.VertexColors){dz(eb.color.getStyle())}else{var d9=ea.vertexColors[0].getStyle();var d7=ea.vertexColors[1].getStyle();if(d9===d7){dz(d9)}else{try{var ed=ct.createLinearGradient(ee.positionScreen.x,ee.positionScreen.y,ec.positionScreen.x,ec.positionScreen.y);ed.addColorStop(0,d9);ed.addColorStop(1,d7)}catch(d8){ed=d9}dz(ed)}}ct.stroke();cM.expandByScalar(eb.linewidth*2)}else{if(eb instanceof aH.LineDashedMaterial){cW(eb.linewidth);dd(eb.linecap);dF(eb.linejoin);dz(eb.color.getStyle());c9(eb.dashSize,eb.gapSize);ct.stroke();cM.expandByScalar(eb.linewidth*2);c9(null,null)}}}function dU(ef,ee,ed,d9,d8,d7,ea,ec){cJ.info.render.vertices+=3;cJ.info.render.faces++;cO(ec.opacity);dn(ec.blending);cI=ef.positionScreen.x;cH=ef.positionScreen.y;cs=ee.positionScreen.x;cr=ee.positionScreen.y;dJ=ed.positionScreen.x;dG=ed.positionScreen.y;dZ(cI,cH,cs,cr,dJ,dG);if((ec instanceof aH.MeshLambertMaterial||ec instanceof aH.MeshPhongMaterial)&&ec.map===null){da.copy(ec.color);cF.copy(ec.emissive);if(ec.vertexColors===aH.FaceColors){da.multiply(ea.color)}if(ec.wireframe===false&&ec.shading==aH.SmoothShading&&ea.vertexNormalsLength==3){cE.copy(dD);cD.copy(dD);cC.copy(dD);dY(ea.v1.positionWorld,ea.vertexNormalsModel[0],cE);dY(ea.v2.positionWorld,ea.vertexNormalsModel[1],cD);dY(ea.v3.positionWorld,ea.vertexNormalsModel[2],cC);cE.multiply(da).add(cF);cD.multiply(da).add(cF);cC.multiply(da).add(cF);cB.addColors(cD,cC).multiplyScalar(0.5);db=d6(cE,cD,cC,cB);d1(cI,cH,cs,cr,dJ,dG,0,0,1,0,0,1,db)}else{cu.copy(dD);dY(ea.centroidModel,ea.normalModel,cu);cu.multiply(da).add(cF);ec.wireframe===true?d5(cu,ec.wireframeLinewidth,ec.wireframeLinecap,ec.wireframeLinejoin):d4(cu)}}else{if(ec instanceof aH.MeshBasicMaterial||ec instanceof aH.MeshLambertMaterial||ec instanceof aH.MeshPhongMaterial){if(ec.map!==null){if(ec.map.mapping instanceof aH.UVMapping){cx=ea.uvs[0];dO(cI,cH,cs,cr,dJ,dG,cx[d9].x,cx[d9].y,cx[d8].x,cx[d8].y,cx[d7].x,cx[d7].y,ec.map)}}else{if(ec.envMap!==null){if(ec.envMap.mapping instanceof aH.SphericalReflectionMapping){cz.copy(ea.vertexNormalsModelView[d9]);dI=0.5*cz.x+0.5;dE=0.5*cz.y+0.5;cz.copy(ea.vertexNormalsModelView[d8]);ds=0.5*cz.x+0.5;dq=0.5*cz.y+0.5;cz.copy(ea.vertexNormalsModelView[d7]);c7=0.5*cz.x+0.5;c5=0.5*cz.y+0.5;dO(cI,cH,cs,cr,dJ,dG,dI,dE,ds,dq,c7,c5,ec.envMap)}}else{cu.copy(ec.color);if(ec.vertexColors===aH.FaceColors){cu.multiply(ea.color)}ec.wireframe===true?d5(cu,ec.wireframeLinewidth,ec.wireframeLinecap,ec.wireframeLinejoin):d4(cu)}}}else{if(ec instanceof aH.MeshDepthMaterial){c3=d0.near;dM=d0.far;cE.r=cE.g=cE.b=1-dB(ef.positionScreen.z*ef.positionScreen.w,c3,dM);cD.r=cD.g=cD.b=1-dB(ee.positionScreen.z*ee.positionScreen.w,c3,dM);cC.r=cC.g=cC.b=1-dB(ed.positionScreen.z*ed.positionScreen.w,c3,dM);cB.addColors(cD,cC).multiplyScalar(0.5);db=d6(cE,cD,cC,cB);d1(cI,cH,cs,cr,dJ,dG,0,0,1,0,0,1,db)}else{if(ec instanceof aH.MeshNormalMaterial){var eb;if(ec.shading==aH.FlatShading){eb=ea.normalModelView;cu.setRGB(eb.x,eb.y,eb.z).multiplyScalar(0.5).addScalar(0.5);ec.wireframe===true?d5(cu,ec.wireframeLinewidth,ec.wireframeLinecap,ec.wireframeLinejoin):d4(cu)}else{if(ec.shading==aH.SmoothShading){eb=ea.vertexNormalsModelView[d9];cE.setRGB(eb.x,eb.y,eb.z).multiplyScalar(0.5).addScalar(0.5);eb=ea.vertexNormalsModelView[d8];cD.setRGB(eb.x,eb.y,eb.z).multiplyScalar(0.5).addScalar(0.5);eb=ea.vertexNormalsModelView[d7];cC.setRGB(eb.x,eb.y,eb.z).multiplyScalar(0.5).addScalar(0.5);cB.addColors(cD,cC).multiplyScalar(0.5);db=d6(cE,cD,cC,cB);d1(cI,cH,cs,cr,dJ,dG,0,0,1,0,0,1,db)}}}}}}}function dS(ef,ee,ed,ec,eb,d9,d7,ea){cJ.info.render.vertices+=4;cJ.info.render.faces++;cO(ea.opacity);dn(ea.blending);if((ea.map!==undefined&&ea.map!==null)||(ea.envMap!==undefined&&ea.envMap!==null)){dU(ef,ee,ec,0,1,3,d7,ea);dU(eb,ed,d9,1,2,3,d7,ea);return}cI=ef.positionScreen.x;cH=ef.positionScreen.y;cs=ee.positionScreen.x;cr=ee.positionScreen.y;dJ=ed.positionScreen.x;dG=ed.positionScreen.y;dv=ec.positionScreen.x;du=ec.positionScreen.y;c8=eb.positionScreen.x;c6=eb.positionScreen.y;c0=d9.positionScreen.x;cZ=d9.positionScreen.y;if(ea instanceof aH.MeshLambertMaterial||ea instanceof aH.MeshPhongMaterial){da.copy(ea.color);cF.copy(ea.emissive);if(ea.vertexColors===aH.FaceColors){da.multiply(d7.color)}if(ea.wireframe===false&&ea.shading==aH.SmoothShading&&d7.vertexNormalsLength==4){cE.copy(dD);cD.copy(dD);cC.copy(dD);cB.copy(dD);dY(d7.v1.positionWorld,d7.vertexNormalsModel[0],cE);dY(d7.v2.positionWorld,d7.vertexNormalsModel[1],cD);dY(d7.v4.positionWorld,d7.vertexNormalsModel[3],cC);dY(d7.v3.positionWorld,d7.vertexNormalsModel[2],cB);cE.multiply(da).add(cF);cD.multiply(da).add(cF);cC.multiply(da).add(cF);cB.multiply(da).add(cF);db=d6(cE,cD,cC,cB);dZ(cI,cH,cs,cr,dv,du);d1(cI,cH,cs,cr,dv,du,0,0,1,0,0,1,db);dZ(c8,c6,dJ,dG,c0,cZ);d1(c8,c6,dJ,dG,c0,cZ,1,0,1,1,0,1,db)}else{cu.copy(dD);dY(d7.centroidModel,d7.normalModel,cu);cu.multiply(da).add(cF);dX(cI,cH,cs,cr,dJ,dG,dv,du);ea.wireframe===true?d5(cu,ea.wireframeLinewidth,ea.wireframeLinecap,ea.wireframeLinejoin):d4(cu)}}else{if(ea instanceof aH.MeshBasicMaterial){cu.copy(ea.color);if(ea.vertexColors===aH.FaceColors){cu.multiply(d7.color)}dX(cI,cH,cs,cr,dJ,dG,dv,du);ea.wireframe===true?d5(cu,ea.wireframeLinewidth,ea.wireframeLinecap,ea.wireframeLinejoin):d4(cu)}else{if(ea instanceof aH.MeshNormalMaterial){var d8;if(ea.shading==aH.FlatShading){d8=d7.normalModelView;cu.setRGB(d8.x,d8.y,d8.z).multiplyScalar(0.5).addScalar(0.5);dX(cI,cH,cs,cr,dJ,dG,dv,du);ea.wireframe===true?d5(cu,ea.wireframeLinewidth,ea.wireframeLinecap,ea.wireframeLinejoin):d4(cu)}else{if(ea.shading==aH.SmoothShading){d8=d7.vertexNormalsModelView[0];cE.setRGB(d8.x,d8.y,d8.z).multiplyScalar(0.5).addScalar(0.5);d8=d7.vertexNormalsModelView[1];cD.setRGB(d8.x,d8.y,d8.z).multiplyScalar(0.5).addScalar(0.5);d8=d7.vertexNormalsModelView[3];cC.setRGB(d8.x,d8.y,d8.z).multiplyScalar(0.5).addScalar(0.5);d8=d7.vertexNormalsModelView[2];cB.setRGB(d8.x,d8.y,d8.z).multiplyScalar(0.5).addScalar(0.5);db=d6(cE,cD,cC,cB);dZ(cI,cH,cs,cr,dv,du);d1(cI,cH,cs,cr,dv,du,0,0,1,0,0,1,db);dZ(c8,c6,dJ,dG,c0,cZ);d1(c8,c6,dJ,dG,c0,cZ,1,0,1,1,0,1,db)}}}else{if(ea instanceof aH.MeshDepthMaterial){c3=d0.near;dM=d0.far;cE.r=cE.g=cE.b=1-dB(ef.positionScreen.z*ef.positionScreen.w,c3,dM);cD.r=cD.g=cD.b=1-dB(ee.positionScreen.z*ee.positionScreen.w,c3,dM);cC.r=cC.g=cC.b=1-dB(ec.positionScreen.z*ec.positionScreen.w,c3,dM);cB.r=cB.g=cB.b=1-dB(ed.positionScreen.z*ed.positionScreen.w,c3,dM);db=d6(cE,cD,cC,cB);dZ(cI,cH,cs,cr,dv,du);d1(cI,cH,cs,cr,dv,du,0,0,1,0,0,1,db);dZ(c8,c6,dJ,dG,c0,cZ);d1(c8,c6,dJ,dG,c0,cZ,1,0,1,1,0,1,db)}}}}}function dZ(ea,ec,d8,eb,d7,d9){ct.beginPath();ct.moveTo(ea,ec);ct.lineTo(d8,eb);ct.lineTo(d7,d9);ct.closePath()}function dX(ec,ee,ea,ed,d8,eb,d7,d9){ct.beginPath();ct.moveTo(ec,ee);ct.lineTo(ea,ed);ct.lineTo(d8,eb);ct.lineTo(d7,d9);ct.closePath()}function d5(d7,ea,d9,d8){cW(ea);dd(d9);dF(d8);dz(d7.getStyle());ct.stroke();cM.expandByScalar(ea*2)}function d4(d7){dm(d7.getStyle());ct.fill()}function dO(er,ee,eo,ec,em,ea,en,eb,el,d9,ek,d7,eh){if(eh instanceof aH.DataTexture||eh.image===undefined||eh.image.width==0){return}if(eh.needsUpdate===true){var ez=eh.wrapS==aH.RepeatWrapping;var ex=eh.wrapT==aH.RepeatWrapping;cT[eh.id]=ct.createPattern(eh.image,ez===true&&ex===true?"repeat":ez===true&&ex===false?"repeat-x":ez===false&&ex===true?"repeat-y":"no-repeat");eh.needsUpdate=false}cT[eh.id]===undefined?dm("rgba(0,0,0,1)"):dm(cT[eh.id]);var eA,ey,ew,ev,et,eq,ef,eu,es=eh.offset.x/eh.repeat.x,ep=eh.offset.y/eh.repeat.y,ej=eh.image.width*eh.repeat.x,ei=eh.image.height*eh.repeat.y;en=(en+es)*ej;eb=(1-eb+ep)*ei;el=(el+es)*ej;d9=(1-d9+ep)*ei;ek=(ek+es)*ej;d7=(1-d7+ep)*ei;eo-=er;ec-=ee;em-=er;ea-=ee;el-=en;d9-=eb;ek-=en;d7-=eb;ef=el*d7-ek*d9;if(ef===0){if(c4[eh.id]===undefined){var ed=document.createElement("canvas");ed.width=eh.image.width;ed.height=eh.image.height;var d8=ed.getContext("2d");d8.drawImage(eh.image,0,0);c4[eh.id]=d8.getImageData(0,0,eh.image.width,eh.image.height).data}var eB=c4[eh.id];var eg=(Math.floor(en)+Math.floor(eb)*eh.image.width)*4;cu.setRGB(eB[eg]/255,eB[eg+1]/255,eB[eg+2]/255);d4(cu);return}eu=1/ef;eA=(d7*eo-d9*em)*eu;ey=(d7*ec-d9*ea)*eu;ew=(el*em-ek*eo)*eu;ev=(el*ea-ek*ec)*eu;et=er-eA*en-ew*eb;eq=ee-ey*en-ev*eb;ct.save();ct.transform(eA,ey,ew,ev,et,eq);ct.fill();ct.restore()}function d1(en,ec,el,eb,ej,d9,ek,ea,ei,d8,eh,d7,ef){var et,es,er,eq,eo,em,ed,ep,eg=ef.width-1,ee=ef.height-1;ek*=eg;ea*=ee;ei*=eg;d8*=ee;eh*=eg;d7*=ee;el-=en;eb-=ec;ej-=en;d9-=ec;ei-=ek;d8-=ea;eh-=ek;d7-=ea;ed=ei*d7-eh*d8;ep=1/ed;et=(d7*el-d8*ej)*ep;es=(d7*eb-d8*d9)*ep;er=(ei*ej-eh*el)*ep;eq=(ei*d9-eh*eb)*ep;eo=en-et*ek-er*ea;em=ec-es*ek-eq*ea;ct.save();ct.transform(et,es,er,eq,eo,em);ct.clip();ct.drawImage(ef,0,0);ct.restore()}function d6(d8,d7,ea,d9){c2[0]=(d8.r*255)|0;c2[1]=(d8.g*255)|0;c2[2]=(d8.b*255)|0;c2[4]=(d7.r*255)|0;c2[5]=(d7.g*255)|0;c2[6]=(d7.b*255)|0;c2[8]=(ea.r*255)|0;c2[9]=(ea.g*255)|0;c2[10]=(ea.b*255)|0;c2[12]=(d9.r*255)|0;c2[13]=(d9.g*255)|0;c2[14]=(d9.b*255)|0;cw.putImageData(dK,0,0);c1.drawImage(dH,0,0);return cY}function dN(ec,ea){var d7=ea.x-ec.x,eb=ea.y-ec.y,d8=d7*d7+eb*eb,d9;if(d8===0){return}d9=1/Math.sqrt(d8);d7*=d9;eb*=d9;ea.x+=d7;ea.y+=eb;ec.x-=d7;ec.y-=eb}};function cO(dN){if(dC!==dN){ct.globalAlpha=dN;dC=dN}}function dn(dN){if(dy!==dN){if(dN===aH.NormalBlending){ct.globalCompositeOperation="source-over"}else{if(dN===aH.AdditiveBlending){ct.globalCompositeOperation="lighter"}else{if(dN===aH.SubtractiveBlending){ct.globalCompositeOperation="darker"}}}dy=dN}}function cW(dN){if(cX!==dN){ct.lineWidth=dN;cX=dN}}function dd(dN){if(cy!==dN){ct.lineCap=dN;cy=dN}}function dF(dN){if(dt!==dN){ct.lineJoin=dN;dt=dN}}function dz(dN){if(cK!==dN){ct.strokeStyle=dN;cK=dN}}function dm(dN){if(dx!==dN){ct.fillStyle=dN;dx=dN}}function c9(dN,dO){if(cV!==dN||dp!==dO){ct.setLineDash([dN,dO]);cV=dN;dp=dO}}};aH.RenderableVertex=function(){this.positionWorld=new aH.Vector3();this.positionScreen=new aH.Vector4();this.visible=true};aH.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld);this.positionScreen.copy(e.positionScreen)};aH.RenderableFace3=function(){this.v1=new aH.RenderableVertex();this.v2=new aH.RenderableVertex();this.v3=new aH.RenderableVertex();this.centroidModel=new aH.Vector3();this.normalModel=new aH.Vector3();this.normalModelView=new aH.Vector3();this.vertexNormalsLength=0;this.vertexNormalsModel=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3()];this.vertexNormalsModelView=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3()];this.color=null;this.material=null;this.uvs=[[]];this.z=null};aH.RenderableFace4=function(){this.v1=new aH.RenderableVertex();this.v2=new aH.RenderableVertex();this.v3=new aH.RenderableVertex();this.v4=new aH.RenderableVertex();this.centroidModel=new aH.Vector3();this.normalModel=new aH.Vector3();this.normalModelView=new aH.Vector3();this.vertexNormalsLength=0;this.vertexNormalsModel=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3()];this.vertexNormalsModelView=[new aH.Vector3(),new aH.Vector3(),new aH.Vector3(),new aH.Vector3()];this.color=null;this.material=null;this.uvs=[[]];this.z=null};aH.RenderableObject=function(){this.object=null;this.z=null};aH.RenderableParticle=function(){this.object=null;this.x=null;this.y=null;this.z=null;this.rotation=null;this.scale=new aH.Vector2();this.material=null};aH.RenderableLine=function(){this.z=null;this.v1=new aH.RenderableVertex();this.v2=new aH.RenderableVertex();this.vertexColors=[new aH.Color(),new aH.Color()];this.material=null};aH.CubeGeometry=function(e,cy,cu,cr,cx,ct){aH.Geometry.call(this);var cA=this;this.width=e;this.height=cy;this.depth=cu;this.widthSegments=cr||1;this.heightSegments=cx||1;this.depthSegments=ct||1;var cz=this.width/2;var cw=this.height/2;var cs=this.depth/2;cv("z","y",-1,-1,this.depth,this.height,cz,0);cv("z","y",1,-1,this.depth,this.height,-cz,1);cv("x","z",1,1,this.width,this.depth,cw,2);cv("x","z",1,-1,this.width,this.depth,-cw,3);cv("x","y",1,-1,this.width,this.height,cs,4);cv("x","y",-1,-1,this.width,this.height,-cs,5);function cv(cO,cN,cB,cI,cQ,cP,c1,cK){var cM,cG,cF,cS=cA.widthSegments,cR=cA.heightSegments,cH=cQ/2,cE=cP/2,cJ=cA.vertices.length;if((cO==="x"&&cN==="y")||(cO==="y"&&cN==="x")){cM="z"}else{if((cO==="x"&&cN==="z")||(cO==="z"&&cN==="x")){cM="y";cR=cA.depthSegments}else{if((cO==="z"&&cN==="y")||(cO==="y"&&cN==="z")){cM="x";cS=cA.depthSegments}}}var cT=cS+1,cD=cR+1,c0=cQ/cS,cV=cP/cR,cZ=new aH.Vector3();cZ[cM]=c1>0?1:-1;for(cF=0;cF<cD;cF++){for(cG=0;cG<cT;cG++){var cC=new aH.Vector3();cC[cO]=(cG*c0-cH)*cB;cC[cN]=(cF*cV-cE)*cI;cC[cM]=c1;cA.vertices.push(cC)}}for(cF=0;cF<cR;cF++){for(cG=0;cG<cS;cG++){var cY=cG+cT*cF;var cX=cG+cT*(cF+1);var cW=(cG+1)+cT*(cF+1);var cU=(cG+1)+cT*cF;var cL=new aH.Face4(cY+cJ,cX+cJ,cW+cJ,cU+cJ);cL.normal.copy(cZ);cL.vertexNormals.push(cZ.clone(),cZ.clone(),cZ.clone(),cZ.clone());cL.materialIndex=cK;cA.faces.push(cL);cA.faceVertexUvs[0].push([new aH.Vector2(cG/cS,1-cF/cR),new aH.Vector2(cG/cS,1-(cF+1)/cR),new aH.Vector2((cG+1)/cS,1-(cF+1)/cR),new aH.Vector2((cG+1)/cS,1-cF/cR)])}}}this.computeCentroids();this.mergeVertices()};aH.CubeGeometry.prototype=Object.create(aH.Geometry.prototype);aH.CircleGeometry=function(cz,cw,ct,cr){aH.Geometry.call(this);cz=cz||50;ct=ct!==undefined?ct:0;cr=cr!==undefined?cr:Math.PI*2;cw=cw!==undefined?Math.max(3,cw):8;var cv,cu=[],e=new aH.Vector3(),cC=new aH.Vector2(0.5,0.5);this.vertices.push(e);cu.push(cC);for(cv=0;cv<=cw;cv++){var cy=new aH.Vector3();var cx=ct+cv/cw*cr;cy.x=cz*Math.cos(cx);cy.y=cz*Math.sin(cx);this.vertices.push(cy);cu.push(new aH.Vector2((cy.x/cz+1)/2,(cy.y/cz+1)/2))}var cs=new aH.Vector3(0,0,1);for(cv=1;cv<=cw;cv++){var cD=cv;var cB=cv+1;var cA=0;this.faces.push(new aH.Face3(cD,cB,cA,[cs,cs,cs]));this.faceVertexUvs[0].push([cu[cv],cu[cv+1],cC])}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new aH.Sphere(new aH.Vector3(),cz)};aH.CircleGeometry.prototype=Object.create(aH.Geometry.prototype);aH.PlaneGeometry=function(cB,cA,e,cz){aH.Geometry.call(this);this.width=cB;this.height=cA;this.widthSegments=e||1;this.heightSegments=cz||1;var ct,cr;var cu=cB/2;var cs=cA/2;var cD=this.widthSegments;var cC=this.heightSegments;var cE=cD+1;var cy=cC+1;var cL=this.width/cD;var cG=this.height/cC;var cK=new aH.Vector3(0,0,1);for(cr=0;cr<cy;cr++){for(ct=0;ct<cE;ct++){var cx=ct*cL-cu;var cw=cr*cG-cs;this.vertices.push(new aH.Vector3(cx,-cw,0))}}for(cr=0;cr<cC;cr++){for(ct=0;ct<cD;ct++){var cJ=ct+cE*cr;var cI=ct+cE*(cr+1);var cH=(ct+1)+cE*(cr+1);var cF=(ct+1)+cE*cr;var cv=new aH.Face4(cJ,cI,cH,cF);cv.normal.copy(cK);cv.vertexNormals.push(cK.clone(),cK.clone(),cK.clone(),cK.clone());this.faces.push(cv);this.faceVertexUvs[0].push([new aH.Vector2(ct/cD,1-cr/cC),new aH.Vector2(ct/cD,1-(cr+1)/cC),new aH.Vector2((ct+1)/cD,1-(cr+1)/cC),new aH.Vector2((ct+1)/cD,1-cr/cC)])}}this.computeCentroids()};aH.PlaneGeometry.prototype=Object.create(aH.Geometry.prototype);aH.RingGeometry=function(cz,cE,cw,cF,cx,cC){aH.Geometry.call(this);cz=cz||0;cE=cE||50;cx=cx!==undefined?cx:0;cC=cC!==undefined?cC:Math.PI*2;cw=cw!==undefined?Math.max(3,cw):8;cF=cF!==undefined?Math.max(3,cF):8;var cG,cB,cA=[],cv=cz,cy=((cE-cz)/cF);for(cG=0;cG<=cF;cG++){for(cB=0;cB<=cw;cB++){var cH=new aH.Vector3();var cs=cx+cB/cw*cC;cH.x=cv*Math.cos(cs);cH.y=cv*Math.sin(cs);this.vertices.push(cH);cA.push(new aH.Vector2((cH.x/cv+1)/2,-(cH.y/cv+1)/2+1))}cv+=cy}var cD=new aH.Vector3(0,0,1);for(cG=0;cG<cF;cG++){var e=cG*cw;for(cB=0;cB<=cw;cB++){var cs=cB+e;var cu=cs+cG;var ct=cs+cw+cG;var cr=cs+cw+1+cG;this.faces.push(new aH.Face3(cu,ct,cr,[cD,cD,cD]));this.faceVertexUvs[0].push([cA[cu],cA[ct],cA[cr]]);cu=cs+cG;ct=cs+cw+1+cG;cr=cs+1+cG;this.faces.push(new aH.Face3(cu,ct,cr,[cD,cD,cD]));this.faceVertexUvs[0].push([cA[cu],cA[ct],cA[cr]])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new aH.Sphere(new aH.Vector3(),cv)};aH.RingGeometry.prototype=Object.create(aH.Geometry.prototype);var P={};P.HGRAPH_VERSION="0.01";var ay={};ay.HGRAPH_WIDTH=960;ay.HGRAPH_HEIGHT=720;ay.HGRAPH_RANGE_MINIMUM=60;ay.HGRAPH_RANGE_MAXIMUM=240;ay.HGRAPH_POINT_RADIUS=10;ay.HGRAPH_SUBPOINT_RADIUS=8;ay.HGRAPH_CANVAS_TEXTALIGN="center";ay.HGRAPH_CANVAS_TEXT="10px Arial";ay.HGRAPH_POINT_COLOR_HEALTHY="#616363";ay.HGRAPH_POINT_COLOR_UNHEALTHY="#e1604f";ay.HGRAPH_APP_BOOTSTRAPS=["[data-hgraph-app]","[hgraph-app]"];ay.HGRAPH_GRAPH_BOOTSTRAPS=["[data-hgraph-graph]","[hgraph-graph]"];ay.HGRAPH_PAYLOAD_TRIGGERS=["[data-hgraph-payload]","[hgraph-payload]"];ay.HGRAPH_RING_FILL_COLOR="#97be8c";var aa=Math.ceil;var bY=Math.floor;var aE=Math.abs;var cj=function(e){return parseInt(e,10)};var cp=function(e){return parseFloat(e)};var aY=function(e){return e*(Math.PI/180)};var V=[].slice;var x=[].push;var bx=[].splice;var T={}.hasOwnProperty;var aG={}.toString;var N=(function(){var cr=["",true,12,/^$/,[],function(){},{},null],cs,e={};while(cr.length>0){cs=aG.call(cr.pop());e[cs]=cs.replace(/^\[object\s(.*)\]$/,"$1").toLowerCase()}return(function(ct){return e[aG.call(ct)]})})();var br=function(e){return N(e)==="array"};var b4=function(e){return N(e)==="object"};var aB=function(e){return N(e)==="string"};var Z=function(e){return N(e)==="function"};var Y=function(e){return N(e)!==undefined};var bT=function(e){return !Y(e)};var l=(function(){var e=0;return(function(){return"uid-"+(++e)})})();var ah=function(cs,ct,e){if(!br(ct)||!Z(cs)){return function(){}}var cr=e?e:{};return function(){if(arguments.length>0){return cs.apply(cr,ct.concat(V.call(arguments,0)))}cs.apply(cr,ct)}};var aR=function(ct,cs,cr){var e;if(ct){if(Z(ct)){for(e in ct){if(e!="prototype"&&e!="length"&&e!="name"&&ct.hasOwnProperty(e)){cs.call(cr,ct[e],e)}}}else{if(ct.forEach&&ct.forEach!==aR){ct.forEach(cs,cr)}else{if(br(ct)){for(e=0;e<ct.length;e++){cs.call(cr,ct[e],e)}}else{for(e in ct){if(ct.hasOwnProperty(e)){cs.call(cr,ct[e],e)}}}}}}return ct};var bz=function(e){if(!b4(e)||arguments.length<2){return e}aR(bx.call(arguments,1),function(cr){aR(cr,function(ct,cs){e[cs]=ct})})};bE.Error=function(e){return new Error(e)};var c={};c.string=function(cr){var cs;try{cs=JSON.parse(cr)}catch(ct){throw bE.Erorr("unable to parse the data string")}return c.object(cs)};c.object=function(e){e.formatted=true;return e};bE.Data=function(){};bE.Data.Parse=function(e){var cr=false;if(aB(e)){cr=c.string(e)}else{if(b4(e)){cr=c.object(e)}else{return false}}return cr};bE.Graph=(function(cu){var cr={},cC={},cD={},e=null;function ct(){aR(cD,function(cE){if(Z(cE)){cE()}});if(ct.looping){}else{}}ct.looping=false;ct.Begin=function(){ct.looping=true;return ct()};ct.Stop=function(){ct.looping=false;cancelAnimationFrame(e)};function cy(cF){var cH=[],cG=ay.HGRAPH_PAYLOAD_TRIGGERS.join(",");function cE(){if(this.value){cH.push(bE.Data.Parse(this.value))}}bJ.select(cF).selectAll(cG).each(cE);return cH.length>0?cH[0]:{}}function cB(cG,cE){var cF=cE.GetObject();if(br(cF)){aR(cF,function(cH){cG.add(cH)})}else{if(b4(cF)){cG.add(cF)}else{return false}}}function cw(){var cH=cr[this.uid],cE=cH.camera,cG=cH.scene,cF=cH.renderer;cF.render(cG,cE)}function cz(){var cG=cr[this.uid],cF=cG.components;for(var cE=0;cE<cF.length;cE++){cF[cE].Update()}cC[this.uid].Render()}function cv(){var cJ=cr[this.uid],cI=cJ.scene,cG=cJ.components,cH=cJ.payload,cF=br(cH.points)?cH.points:[];cG.push(new bE.Graph.Ring());for(var cE=0;cE<cF.length;cE++){cG.push(new bE.Graph.Point(cF[cE]))}for(var cE=0;cE<cG.length;cE++){cB(cI,cG[cE])}return cC[this.uid].Resize()}function cx(){var cJ=cr[this.uid],cF=cJ.canvas,cG=cJ.camera,cI=cJ.renderer,cH=cJ.dimensions;cH.x=window.innerWidth;cH.y=window.innerHeight;var cK=cH.x*0.5,cE=cH.y*0.5;cG.left=-cK;cG.right=cK;cG.top=cE;cG.bottom=-cE;cG.updateProjectionMatrix();cI.setSize(cH.x,cH.y);if(!cD[this.uid]){cD[this.uid]=cC[this.uid].Update}}function cs(){var cE;while(cE=this.invokeQueue.pop()){if(Z(cE)){cE()}}}function cA(cG){this.ready=false;if(!cG){throw new bE.Error("Graphs must be created with a configuration parameter")}var cH={},cF=document.createElement("canvas");this.uid=aB(cG.uid)?cG.uid:l();cH.container=cG.container||document.createElement("div");cH.payload=cy(cH.container);cH.renderer=new aH.CanvasRenderer({canvas:cF});cH.dimensions=new aH.Vector2(window.innerWidth,window.innerHeight);var cJ=cH.dimensions.x*0.5,cE=cH.dimensions.y*0.5;cH.camera=new aH.OrthographicCamera(-cJ,cJ,cE,-cE,-50,1000);cH.camera.position.z=200;try{cH.container.innerHTML="";cH.container.appendChild(cH.renderer.domElement)}catch(cI){throw new bE.Error("Attempted to use an invalid container for graph: "+cH.uid)}cH.scene=new aH.Scene();cH.components=[];cr[this.uid]=cH;cC[this.uid]={Update:ah(cz,[],this),Render:ah(cw,[],this),Resize:ah(cx,[],this)};t.push(cC[this.uid].Resize);this.ready=true;this.invokeQueue=[ah(cv,[],this)]}cA.prototype={constructor:cA,version:P.GRAPH_VERSION,Initialize:function(){if(this.uid&&this.ready){cs.call(this)}if(!ct.looping){ct.Begin()}}};return cA;window.ShutDown=ct.Stop})();function b0(e){var cr={};e(cr);var cs=(function(ct){return function(){ct.apply(this,bx.call(arguments,0))}})(T.call(e,"constructor")?e.constructor:function(){});cs.prototype={GetObject:function(){return this.object},Initialize:function(){},Update:function(){}};bz(cs.prototype,cr);return cs}bE.Graph.Ring=(function(){function e(cr){cr.Update=function(){}}e.constructor=function(){this.uid=l();this.geometry=new aH.RingGeometry(150,200,400,400);this.material=new aH.MeshBasicMaterial({color:9944716});this.object=new aH.Mesh(this.geometry,this.material)};return b0(e)})();bE.Graph.Point=(function(){function e(cr){cr.Update=function(){}}e.constructor=function(){this.uid=l();this.geometry=new aH.CircleGeometry(15,100);this.material=new aH.MeshBasicMaterial({color:3355443});this.object=new aH.Mesh(this.geometry,this.material)};return b0(e)})();function aS(){aR(t,function(e){return Z(e)&&e()})}function af(e){var cr=l();n[cr]=new bE.Graph({uid:cr,container:e})}function D(){bJ.select(ay.HGRAPH_GRAPH_BOOTSTRAPS.join(",")).each(function(){af(this)});for(var e in n){n[e].Initialize()}}function a2(){var e=[];bJ.select(ay.HGRAPH_APP_BOOTSTRAPS.join(",")).each(function(){e.push(this)});if(e.length>1){throw new bE.Error("Too many root elements found on the page")}bU=e[0];if(bU){return D()}}bJ.select(document).on("DOMContentLoaded",a2);bJ.select(window).on("resize",aS);v.hGraph=bE})(window);